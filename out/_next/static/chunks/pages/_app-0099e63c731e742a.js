(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{4444:function(t,e,n){"use strict";n.d(e,{$s:function(){return K},BH:function(){return g},DV:function(){return L},GJ:function(){return O},L:function(){return h},LL:function(){return N},Mn:function(){return E},Pz:function(){return D},UI:function(){return j},US:function(){return u},Yr:function(){return C},ZR:function(){return k},b$:function(){return _},cI:function(){return x},d:function(){return w},dS:function(){return z},eu:function(){return I},g5:function(){return a},gK:function(){return $},gQ:function(){return B},h$:function(){return l},hl:function(){return T},hu:function(){return o},m9:function(){return W},p$:function(){return f},r3:function(){return M},ru:function(){return v},uI:function(){return y},ug:function(){return H},vZ:function(){return V},w1:function(){return b},w9:function(){return R},xO:function(){return q},xb:function(){return F},zI:function(){return S}});const i=!1,r=!1,s="${JSCORE_VERSION}",o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+s+") INTERNAL ASSERT FAILED: "+t)},c=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):55296===(64512&r)&&i+1<t.length&&56320===(64512&t.charCodeAt(i+1))?(r=65536+((1023&r)<<10)+(1023&t.charCodeAt(++i)),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<t.length;r+=3){const e=t[r],s=r+1<t.length,o=s?t[r+1]:0,a=r+2<t.length,c=a?t[r+2]:0,u=e>>2,l=(3&e)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),i.push(n[u],n[l],n[h],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(c(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const r=t[n++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=t[n++];e[i++]=String.fromCharCode((31&r)<<6|63&s)}else if(r>239&&r<365){const s=((7&r)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(s>>10)),e[i++]=String.fromCharCode(56320+(1023&s))}else{const s=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&r)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<t.length;){const e=n[t.charAt(r++)],s=r<t.length?n[t.charAt(r)]:0;++r;const o=r<t.length?n[t.charAt(r)]:64;++r;const a=r<t.length?n[t.charAt(r)]:64;if(++r,null==e||null==s||null==o||null==a)throw Error();const c=e<<2|s>>4;if(i.push(c),64!==o){const t=s<<4&240|o>>2;if(i.push(t),64!==a){const t=o<<6&192|a;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},l=function(t){const e=c(t);return u.encodeByteArray(e,!0)},h=function(t){return l(t).replace(/\./g,"")},d=function(t){try{return u.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function f(t){return p(void 0,t)}function p(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=p(t[n],e[n]));return t}class g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"===typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function m(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function y(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(m())}function v(){const t="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof t&&void 0!==t.id}function _(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function w(){return m().indexOf("Electron/")>=0}function b(){const t=m();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function E(){return m().indexOf("MSAppHost/")>=0}function C(){return!0===i||!0===r}function T(){return"object"===typeof indexedDB}function I(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var t;e((null===(t=r.error)||void 0===t?void 0:t.message)||"")}}catch(n){e(n)}}))}function S(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)}class k extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,k.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,N.prototype.create)}}class N{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,r=this.errors[t],s=r?function(t,e){return t.replace(A,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(r,n):"Error",o=`${this.serviceName}: ${s} (${i}).`;return new k(i,o,n)}}const A=/\{\$([^}]+)}/g;function x(t){return JSON.parse(t)}function D(t){return JSON.stringify(t)}const P=function(t){let e={},n={},i={},r="";try{const s=t.split(".");e=x(d(s[0])||""),n=x(d(s[1])||""),r=s[2],i=n.d||{},delete n.d}catch(s){}return{header:e,claims:n,data:i,signature:r}},R=function(t){const e=P(t).claims;return!!e&&"object"===typeof e&&e.hasOwnProperty("iat")},O=function(t){const e=P(t).claims;return"object"===typeof e&&!0===e.admin};function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function L(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function F(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function j(t,e,n){const i={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=e.call(n,t[r],r,t));return i}function V(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const r of n){if(!i.includes(r))return!1;const n=t[r],s=e[r];if(U(n)&&U(s)){if(!V(n,s))return!1}else if(n!==s)return!1}for(const r of i)if(!n.includes(r))return!1;return!0}function U(t){return null!==t&&"object"===typeof t}function q(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}class B{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const n=this.W_;if("string"===typeof t)for(let l=0;l<16;l++)n[l]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let l=0;l<16;l++)n[l]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let l=16;l<80;l++){const t=n[l-3]^n[l-8]^n[l-14]^n[l-16];n[l]=4294967295&(t<<1|t>>>31)}let i,r,s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],c=this.chain_[3],u=this.chain_[4];for(let l=0;l<80;l++){l<40?l<20?(i=c^o&(a^c),r=1518500249):(i=o^a^c,r=1859775393):l<60?(i=o&a|c&(o|a),r=2400959708):(i=o^a^c,r=3395469782);const t=(s<<5|s>>>27)+i+u+r+n[l]&4294967295;u=c,c=a,a=4294967295&(o<<30|o>>>2),o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const n=e-this.blockSize;let i=0;const r=this.buf_;let s=this.inbuf_;for(;i<e;){if(0===s)for(;i<=n;)this.compress_(t,i),i+=this.blockSize;if("string"===typeof t){for(;i<e;)if(r[s]=t.charCodeAt(i),++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}else for(;i<e;)if(r[s]=t[i],++s,++i,s===this.blockSize){this.compress_(r),s=0;break}}this.inbuf_=s,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&e,e/=256;this.compress_(this.buf_);let n=0;for(let i=0;i<5;i++)for(let e=24;e>=0;e-=8)t[n]=this.chain_[i]>>e&255,++n;return t}}function $(t,e){return`${t} failed: ${e} argument `}const z=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);if(r>=55296&&r<=56319){const e=r-55296;i++,o(i<t.length,"Surrogate pair missing trail surrogate.");r=65536+(e<<10)+(t.charCodeAt(i)-56320)}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=63&r|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=63&r|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=63&r|128)}return e},H=function(t){let e=0;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e};function K(t,e=1e3,n=2){const i=e*Math.pow(n,t),r=Math.round(.5*i*(Math.random()-.5)*2);return Math.min(144e5,i+r)}function W(t){return t&&t._delegate?t._delegate:t}},5861:function(t,e,n){t.exports={default:n(8339),__esModule:!0}},2242:function(t,e,n){t.exports={default:n(4003),__esModule:!0}},5105:function(t,e,n){t.exports={default:n(5175),__esModule:!0}},2662:function(t,e,n){t.exports={default:n(2912),__esModule:!0}},3516:function(t,e,n){t.exports={default:n(9583),__esModule:!0}},4275:function(t,e,n){t.exports={default:n(3276),__esModule:!0}},9663:function(t,e){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},2600:function(t,e,n){"use strict";e.__esModule=!0;var i,r=n(2242),s=(i=r)&&i.__esModule?i:{default:i};e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,s.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()},3196:function(t,e,n){"use strict";e.__esModule=!0;var i=o(n(2662)),r=o(n(5861)),s=o(n(2444));function o(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+("undefined"===typeof e?"undefined":(0,s.default)(e)));t.prototype=(0,r.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(i.default?(0,i.default)(t,e):t.__proto__=e)}},9135:function(t,e,n){"use strict";e.__esModule=!0;var i,r=n(2444),s=(i=r)&&i.__esModule?i:{default:i};e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==("undefined"===typeof e?"undefined":(0,s.default)(e))&&"function"!==typeof e?t:e}},2444:function(t,e,n){"use strict";e.__esModule=!0;var i=o(n(4275)),r=o(n(3516)),s="function"===typeof r.default&&"symbol"===typeof i.default?function(t){return typeof t}:function(t){return t&&"function"===typeof r.default&&t.constructor===r.default&&t!==r.default.prototype?"symbol":typeof t};function o(t){return t&&t.__esModule?t:{default:t}}e.default="function"===typeof r.default&&"symbol"===s(i.default)?function(t){return"undefined"===typeof t?"undefined":s(t)}:function(t){return t&&"function"===typeof r.default&&t.constructor===r.default&&t!==r.default.prototype?"symbol":"undefined"===typeof t?"undefined":s(t)}},8339:function(t,e,n){n(6924);var i=n(4731).Object;t.exports=function(t,e){return i.create(t,e)}},4003:function(t,e,n){n(1001);var i=n(4731).Object;t.exports=function(t,e,n){return i.defineProperty(t,e,n)}},5175:function(t,e,n){n(1500),t.exports=n(4731).Object.getPrototypeOf},2912:function(t,e,n){n(845),t.exports=n(4731).Object.setPrototypeOf},9583:function(t,e,n){n(3835),n(464),n(4427),n(9089),t.exports=n(4731).Symbol},3276:function(t,e,n){n(3036),n(6740),t.exports=n(7613).f("iterator")},1449:function(t){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},5345:function(t){t.exports=function(){}},6504:function(t,e,n){var i=n(9151);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},4389:function(t,e,n){var i=n(4874),r=n(8317),s=n(9838);t.exports=function(t){return function(e,n,o){var a,c=i(e),u=r(c.length),l=s(o,u);if(t&&n!=n){for(;u>l;)if((a=c[l++])!=a)return!0}else for(;u>l;l++)if((t||l in c)&&c[l]===n)return t||l||0;return!t&&-1}}},4499:function(t){var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},4731:function(t){var e=t.exports={version:"2.6.12"};"number"==typeof __e&&(__e=e)},1821:function(t,e,n){var i=n(1449);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},1605:function(t){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},5810:function(t,e,n){t.exports=!n(3777)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},2571:function(t,e,n){var i=n(9151),r=n(9362).document,s=i(r)&&i(r.createElement);t.exports=function(t){return s?r.createElement(t):{}}},5568:function(t){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},2052:function(t,e,n){var i=n(9656),r=n(2614),s=n(3416);t.exports=function(t){var e=i(t),n=r.f;if(n)for(var o,a=n(t),c=s.f,u=0;a.length>u;)c.call(t,o=a[u++])&&e.push(o);return e}},9901:function(t,e,n){var i=n(9362),r=n(4731),s=n(1821),o=n(6519),a=n(3571),c=function(t,e,n){var u,l,h,d=t&c.F,f=t&c.G,p=t&c.S,g=t&c.P,m=t&c.B,y=t&c.W,v=f?r:r[e]||(r[e]={}),_=v.prototype,w=f?i:p?i[e]:(i[e]||{}).prototype;for(u in f&&(n=e),n)(l=!d&&w&&void 0!==w[u])&&a(v,u)||(h=l?w[u]:n[u],v[u]=f&&"function"!=typeof w[u]?n[u]:m&&l?s(h,i):y&&w[u]==h?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(h):g&&"function"==typeof h?s(Function.call,h):h,g&&((v.virtual||(v.virtual={}))[u]=h,t&c.R&&_&&!_[u]&&o(_,u,h)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},3777:function(t){t.exports=function(t){try{return!!t()}catch(e){return!0}}},9362:function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)},3571:function(t){var e={}.hasOwnProperty;t.exports=function(t,n){return e.call(t,n)}},6519:function(t,e,n){var i=n(1738),r=n(8051);t.exports=n(5810)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},203:function(t,e,n){var i=n(9362).document;t.exports=i&&i.documentElement},3254:function(t,e,n){t.exports=!n(5810)&&!n(3777)((function(){return 7!=Object.defineProperty(n(2571)("div"),"a",{get:function(){return 7}}).a}))},2312:function(t,e,n){var i=n(4499);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},7539:function(t,e,n){var i=n(4499);t.exports=Array.isArray||function(t){return"Array"==i(t)}},9151:function(t){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},9163:function(t,e,n){"use strict";var i=n(4055),r=n(8051),s=n(420),o={};n(6519)(o,n(5346)("iterator"),(function(){return this})),t.exports=function(t,e,n){t.prototype=i(o,{next:r(1,n)}),s(t,e+" Iterator")}},4346:function(t,e,n){"use strict";var i=n(7346),r=n(9901),s=n(1865),o=n(6519),a=n(3135),c=n(9163),u=n(420),l=n(1146),h=n(5346)("iterator"),d=!([].keys&&"next"in[].keys()),f="keys",p="values",g=function(){return this};t.exports=function(t,e,n,m,y,v,_){c(n,e,m);var w,b,E,C=function(t){if(!d&&t in k)return k[t];switch(t){case f:case p:return function(){return new n(this,t)}}return function(){return new n(this,t)}},T=e+" Iterator",I=y==p,S=!1,k=t.prototype,N=k[h]||k["@@iterator"]||y&&k[y],A=N||C(y),x=y?I?C("entries"):A:void 0,D="Array"==e&&k.entries||N;if(D&&(E=l(D.call(new t)))!==Object.prototype&&E.next&&(u(E,T,!0),i||"function"==typeof E[h]||o(E,h,g)),I&&N&&N.name!==p&&(S=!0,A=function(){return N.call(this)}),i&&!_||!d&&!S&&k[h]||o(k,h,A),a[e]=A,a[T]=g,y)if(w={values:I?A:C(p),keys:v?A:C(f),entries:x},_)for(b in w)b in k||s(k,b,w[b]);else r(r.P+r.F*(d||S),e,w);return w}},4098:function(t){t.exports=function(t,e){return{value:e,done:!!t}}},3135:function(t){t.exports={}},7346:function(t){t.exports=!0},5965:function(t,e,n){var i=n(3535)("meta"),r=n(9151),s=n(3571),o=n(1738).f,a=0,c=Object.isExtensible||function(){return!0},u=!n(3777)((function(){return c(Object.preventExtensions({}))})),l=function(t){o(t,i,{value:{i:"O"+ ++a,w:{}}})},h=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!r(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!s(t,i)){if(!c(t))return"F";if(!e)return"E";l(t)}return t[i].i},getWeak:function(t,e){if(!s(t,i)){if(!c(t))return!0;if(!e)return!1;l(t)}return t[i].w},onFreeze:function(t){return u&&h.NEED&&c(t)&&!s(t,i)&&l(t),t}}},4055:function(t,e,n){var i=n(6504),r=n(121),s=n(5568),o=n(6210)("IE_PROTO"),a=function(){},c=function(){var t,e=n(2571)("iframe"),i=s.length;for(e.style.display="none",n(203).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),c=t.F;i--;)delete c.prototype[s[i]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(a.prototype=i(t),n=new a,a.prototype=null,n[o]=t):n=c(),void 0===e?n:r(n,e)}},1738:function(t,e,n){var i=n(6504),r=n(3254),s=n(5408),o=Object.defineProperty;e.f=n(5810)?Object.defineProperty:function(t,e,n){if(i(t),e=s(e,!0),i(n),r)try{return o(t,e,n)}catch(a){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},121:function(t,e,n){var i=n(1738),r=n(6504),s=n(9656);t.exports=n(5810)?Object.defineProperties:function(t,e){r(t);for(var n,o=s(e),a=o.length,c=0;a>c;)i.f(t,n=o[c++],e[n]);return t}},8437:function(t,e,n){var i=n(3416),r=n(8051),s=n(4874),o=n(5408),a=n(3571),c=n(3254),u=Object.getOwnPropertyDescriptor;e.f=n(5810)?u:function(t,e){if(t=s(t),e=o(e,!0),c)try{return u(t,e)}catch(n){}if(a(t,e))return r(!i.f.call(t,e),t[e])}},2029:function(t,e,n){var i=n(4874),r=n(1471).f,s={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return o&&"[object Window]"==s.call(t)?function(t){try{return r(t)}catch(e){return o.slice()}}(t):r(i(t))}},1471:function(t,e,n){var i=n(6152),r=n(5568).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,r)}},2614:function(t,e){e.f=Object.getOwnPropertySymbols},1146:function(t,e,n){var i=n(3571),r=n(9411),s=n(6210)("IE_PROTO"),o=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=r(t),i(t,s)?t[s]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},6152:function(t,e,n){var i=n(3571),r=n(4874),s=n(4389)(!1),o=n(6210)("IE_PROTO");t.exports=function(t,e){var n,a=r(t),c=0,u=[];for(n in a)n!=o&&i(a,n)&&u.push(n);for(;e.length>c;)i(a,n=e[c++])&&(~s(u,n)||u.push(n));return u}},9656:function(t,e,n){var i=n(6152),r=n(5568);t.exports=Object.keys||function(t){return i(t,r)}},3416:function(t,e){e.f={}.propertyIsEnumerable},5762:function(t,e,n){var i=n(9901),r=n(4731),s=n(3777);t.exports=function(t,e){var n=(r.Object||{})[t]||Object[t],o={};o[t]=e(n),i(i.S+i.F*s((function(){n(1)})),"Object",o)}},8051:function(t){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},1865:function(t,e,n){t.exports=n(6519)},9300:function(t,e,n){var i=n(9151),r=n(6504),s=function(t,e){if(r(t),!i(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=n(1821)(Function.call,n(8437).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(r){e=!0}return function(t,n){return s(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:s}},420:function(t,e,n){var i=n(1738).f,r=n(3571),s=n(5346)("toStringTag");t.exports=function(t,e,n){t&&!r(t=n?t:t.prototype,s)&&i(t,s,{configurable:!0,value:e})}},6210:function(t,e,n){var i=n(7571)("keys"),r=n(3535);t.exports=function(t){return i[t]||(i[t]=r(t))}},7571:function(t,e,n){var i=n(4731),r=n(9362),s="__core-js_shared__",o=r[s]||(r[s]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:i.version,mode:n(7346)?"pure":"global",copyright:"\xa9 2020 Denis Pushkarev (zloirock.ru)"})},2222:function(t,e,n){var i=n(1485),r=n(1605);t.exports=function(t){return function(e,n){var s,o,a=String(r(e)),c=i(n),u=a.length;return c<0||c>=u?t?"":void 0:(s=a.charCodeAt(c))<55296||s>56319||c+1===u||(o=a.charCodeAt(c+1))<56320||o>57343?t?a.charAt(c):s:t?a.slice(c,c+2):o-56320+(s-55296<<10)+65536}}},9838:function(t,e,n){var i=n(1485),r=Math.max,s=Math.min;t.exports=function(t,e){return(t=i(t))<0?r(t+e,0):s(t,e)}},1485:function(t){var e=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:e)(t)}},4874:function(t,e,n){var i=n(2312),r=n(1605);t.exports=function(t){return i(r(t))}},8317:function(t,e,n){var i=n(1485),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},9411:function(t,e,n){var i=n(1605);t.exports=function(t){return Object(i(t))}},5408:function(t,e,n){var i=n(9151);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},3535:function(t){var e=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++e+n).toString(36))}},1875:function(t,e,n){var i=n(9362),r=n(4731),s=n(7346),o=n(7613),a=n(1738).f;t.exports=function(t){var e=r.Symbol||(r.Symbol=s?{}:i.Symbol||{});"_"==t.charAt(0)||t in e||a(e,t,{value:o.f(t)})}},7613:function(t,e,n){e.f=n(5346)},5346:function(t,e,n){var i=n(7571)("wks"),r=n(3535),s=n(9362).Symbol,o="function"==typeof s;(t.exports=function(t){return i[t]||(i[t]=o&&s[t]||(o?s:r)("Symbol."+t))}).store=i},1092:function(t,e,n){"use strict";var i=n(5345),r=n(4098),s=n(3135),o=n(4874);t.exports=n(4346)(Array,"Array",(function(t,e){this._t=o(t),this._i=0,this._k=e}),(function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,r(1)):r(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])}),"values"),s.Arguments=s.Array,i("keys"),i("values"),i("entries")},6924:function(t,e,n){var i=n(9901);i(i.S,"Object",{create:n(4055)})},1001:function(t,e,n){var i=n(9901);i(i.S+i.F*!n(5810),"Object",{defineProperty:n(1738).f})},1500:function(t,e,n){var i=n(9411),r=n(1146);n(5762)("getPrototypeOf",(function(){return function(t){return r(i(t))}}))},845:function(t,e,n){var i=n(9901);i(i.S,"Object",{setPrototypeOf:n(9300).set})},464:function(){},3036:function(t,e,n){"use strict";var i=n(2222)(!0);n(4346)(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=i(e,n),this._i+=t.length,{value:t,done:!1})}))},3835:function(t,e,n){"use strict";var i=n(9362),r=n(3571),s=n(5810),o=n(9901),a=n(1865),c=n(5965).KEY,u=n(3777),l=n(7571),h=n(420),d=n(3535),f=n(5346),p=n(7613),g=n(1875),m=n(2052),y=n(7539),v=n(6504),_=n(9151),w=n(9411),b=n(4874),E=n(5408),C=n(8051),T=n(4055),I=n(2029),S=n(8437),k=n(2614),N=n(1738),A=n(9656),x=S.f,D=N.f,P=I.f,R=i.Symbol,O=i.JSON,M=O&&O.stringify,L=f("_hidden"),F=f("toPrimitive"),j={}.propertyIsEnumerable,V=l("symbol-registry"),U=l("symbols"),q=l("op-symbols"),B=Object.prototype,$="function"==typeof R&&!!k.f,z=i.QObject,H=!z||!z.prototype||!z.prototype.findChild,K=s&&u((function(){return 7!=T(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a}))?function(t,e,n){var i=x(B,e);i&&delete B[e],D(t,e,n),i&&t!==B&&D(B,e,i)}:D,W=function(t){var e=U[t]=T(R.prototype);return e._k=t,e},G=$&&"symbol"==typeof R.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof R},Y=function(t,e,n){return t===B&&Y(q,e,n),v(t),e=E(e,!0),v(n),r(U,e)?(n.enumerable?(r(t,L)&&t[L][e]&&(t[L][e]=!1),n=T(n,{enumerable:C(0,!1)})):(r(t,L)||D(t,L,C(1,{})),t[L][e]=!0),K(t,e,n)):D(t,e,n)},Q=function(t,e){v(t);for(var n,i=m(e=b(e)),r=0,s=i.length;s>r;)Y(t,n=i[r++],e[n]);return t},X=function(t){var e=j.call(this,t=E(t,!0));return!(this===B&&r(U,t)&&!r(q,t))&&(!(e||!r(this,t)||!r(U,t)||r(this,L)&&this[L][t])||e)},J=function(t,e){if(t=b(t),e=E(e,!0),t!==B||!r(U,e)||r(q,e)){var n=x(t,e);return!n||!r(U,e)||r(t,L)&&t[L][e]||(n.enumerable=!0),n}},Z=function(t){for(var e,n=P(b(t)),i=[],s=0;n.length>s;)r(U,e=n[s++])||e==L||e==c||i.push(e);return i},tt=function(t){for(var e,n=t===B,i=P(n?q:b(t)),s=[],o=0;i.length>o;)!r(U,e=i[o++])||n&&!r(B,e)||s.push(U[e]);return s};$||(R=function(){if(this instanceof R)throw TypeError("Symbol is not a constructor!");var t=d(arguments.length>0?arguments[0]:void 0),e=function(n){this===B&&e.call(q,n),r(this,L)&&r(this[L],t)&&(this[L][t]=!1),K(this,t,C(1,n))};return s&&H&&K(B,t,{configurable:!0,set:e}),W(t)},a(R.prototype,"toString",(function(){return this._k})),S.f=J,N.f=Y,n(1471).f=I.f=Z,n(3416).f=X,k.f=tt,s&&!n(7346)&&a(B,"propertyIsEnumerable",X,!0),p.f=function(t){return W(f(t))}),o(o.G+o.W+o.F*!$,{Symbol:R});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)f(et[nt++]);for(var it=A(f.store),rt=0;it.length>rt;)g(it[rt++]);o(o.S+o.F*!$,"Symbol",{for:function(t){return r(V,t+="")?V[t]:V[t]=R(t)},keyFor:function(t){if(!G(t))throw TypeError(t+" is not a symbol!");for(var e in V)if(V[e]===t)return e},useSetter:function(){H=!0},useSimple:function(){H=!1}}),o(o.S+o.F*!$,"Object",{create:function(t,e){return void 0===e?T(t):Q(T(t),e)},defineProperty:Y,defineProperties:Q,getOwnPropertyDescriptor:J,getOwnPropertyNames:Z,getOwnPropertySymbols:tt});var st=u((function(){k.f(1)}));o(o.S+o.F*st,"Object",{getOwnPropertySymbols:function(t){return k.f(w(t))}}),O&&o(o.S+o.F*(!$||u((function(){var t=R();return"[null]"!=M([t])||"{}"!=M({a:t})||"{}"!=M(Object(t))}))),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=e=i[1],(_(e)||void 0!==t)&&!G(t))return y(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!G(e))return e}),i[1]=e,M.apply(O,i)}}),R.prototype[F]||n(6519)(R.prototype,F,R.prototype.valueOf),h(R,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},4427:function(t,e,n){n(1875)("asyncIterator")},9089:function(t,e,n){n(1875)("observable")},6740:function(t,e,n){n(1092);for(var i=n(9362),r=n(6519),s=n(3135),o=n(5346)("toStringTag"),a="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),c=0;c<a.length;c++){var u=a[c],l=i[u],h=l&&l.prototype;h&&!h[o]&&r(h,o,u),s[u]=s.Array}},6511:function(t,e,n){"use strict";var i=n(6086),r={};function s(t,e,n,i,r,s,o,a){if(!t){var c;if(void 0===e)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,i,r,s,o,a],l=0;(c=new Error(e.replace(/%s/g,(function(){return u[l++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}var o="mixins";t.exports=function(t,e,n){var a=[],c={mixins:"DEFINE_MANY",statics:"DEFINE_MANY",propTypes:"DEFINE_MANY",contextTypes:"DEFINE_MANY",childContextTypes:"DEFINE_MANY",getDefaultProps:"DEFINE_MANY_MERGED",getInitialState:"DEFINE_MANY_MERGED",getChildContext:"DEFINE_MANY_MERGED",render:"DEFINE_ONCE",componentWillMount:"DEFINE_MANY",componentDidMount:"DEFINE_MANY",componentWillReceiveProps:"DEFINE_MANY",shouldComponentUpdate:"DEFINE_ONCE",componentWillUpdate:"DEFINE_MANY",componentDidUpdate:"DEFINE_MANY",componentWillUnmount:"DEFINE_MANY",UNSAFE_componentWillMount:"DEFINE_MANY",UNSAFE_componentWillReceiveProps:"DEFINE_MANY",UNSAFE_componentWillUpdate:"DEFINE_MANY",updateComponent:"OVERRIDE_BASE"},u={getDerivedStateFromProps:"DEFINE_MANY_MERGED"},l={displayName:function(t,e){t.displayName=e},mixins:function(t,e){if(e)for(var n=0;n<e.length;n++)d(t,e[n])},childContextTypes:function(t,e){t.childContextTypes=i({},t.childContextTypes,e)},contextTypes:function(t,e){t.contextTypes=i({},t.contextTypes,e)},getDefaultProps:function(t,e){t.getDefaultProps?t.getDefaultProps=p(t.getDefaultProps,e):t.getDefaultProps=e},propTypes:function(t,e){t.propTypes=i({},t.propTypes,e)},statics:function(t,e){!function(t,e){if(!e)return;for(var n in e){var i=e[n];if(e.hasOwnProperty(n)){if(s(!(n in l),'ReactClass: You are attempting to define a reserved property, `%s`, that shouldn\'t be on the "statics" key. Define it as an instance property instead; it will still be accessible on the constructor.',n),n in t)return s("DEFINE_MANY_MERGED"===(u.hasOwnProperty(n)?u[n]:null),"ReactClass: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",n),void(t[n]=p(t[n],i));t[n]=i}}}(t,e)},autobind:function(){}};function h(t,e){var n=c.hasOwnProperty(e)?c[e]:null;_.hasOwnProperty(e)&&s("OVERRIDE_BASE"===n,"ReactClassInterface: You are attempting to override `%s` from your class specification. Ensure that your method names do not overlap with React methods.",e),t&&s("DEFINE_MANY"===n||"DEFINE_MANY_MERGED"===n,"ReactClassInterface: You are attempting to define `%s` on your component more than once. This conflict may be due to a mixin.",e)}function d(t,n){if(n){s("function"!==typeof n,"ReactClass: You're attempting to use a component class or function as a mixin. Instead, just use a regular object."),s(!e(n),"ReactClass: You're attempting to use a component as a mixin. Instead, just use a regular object.");var i=t.prototype,r=i.__reactAutoBindPairs;for(var a in n.hasOwnProperty(o)&&l.mixins(t,n.mixins),n)if(n.hasOwnProperty(a)&&a!==o){var u=n[a],d=i.hasOwnProperty(a);if(h(d,a),l.hasOwnProperty(a))l[a](t,u);else{var f=c.hasOwnProperty(a);if("function"===typeof u&&!f&&!d&&!1!==n.autobind)r.push(a,u),i[a]=u;else if(d){var m=c[a];s(f&&("DEFINE_MANY_MERGED"===m||"DEFINE_MANY"===m),"ReactClass: Unexpected spec policy %s for key %s when mixing in component specs.",m,a),"DEFINE_MANY_MERGED"===m?i[a]=p(i[a],u):"DEFINE_MANY"===m&&(i[a]=g(i[a],u))}else i[a]=u}}}else;}function f(t,e){for(var n in s(t&&e&&"object"===typeof t&&"object"===typeof e,"mergeIntoWithNoDuplicateKeys(): Cannot merge non-objects."),e)e.hasOwnProperty(n)&&(s(void 0===t[n],"mergeIntoWithNoDuplicateKeys(): Tried to merge two objects with the same key: `%s`. This conflict may be due to a mixin; in particular, this may be caused by two getInitialState() or getDefaultProps() methods returning objects with clashing keys.",n),t[n]=e[n]);return t}function p(t,e){return function(){var n=t.apply(this,arguments),i=e.apply(this,arguments);if(null==n)return i;if(null==i)return n;var r={};return f(r,n),f(r,i),r}}function g(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function m(t,e){return e.bind(t)}var y={componentDidMount:function(){this.__isMounted=!0}},v={componentWillUnmount:function(){this.__isMounted=!1}},_={replaceState:function(t,e){this.updater.enqueueReplaceState(this,t,e)},isMounted:function(){return!!this.__isMounted}},w=function(){};return i(w.prototype,t.prototype,_),function(t){var e=function(t,i,o){this.__reactAutoBindPairs.length&&function(t){for(var e=t.__reactAutoBindPairs,n=0;n<e.length;n+=2){var i=e[n],r=e[n+1];t[i]=m(t,r)}}(this),this.props=t,this.context=i,this.refs=r,this.updater=o||n,this.state=null;var a=this.getInitialState?this.getInitialState():null;s("object"===typeof a&&!Array.isArray(a),"%s.getInitialState(): must return an object or null",e.displayName||"ReactCompositeComponent"),this.state=a};for(var i in e.prototype=new w,e.prototype.constructor=e,e.prototype.__reactAutoBindPairs=[],a.forEach(d.bind(null,e)),d(e,y),d(e,t),d(e,v),e.getDefaultProps&&(e.defaultProps=e.getDefaultProps()),s(e.prototype.render,"createClass(...): Class specification must implement a `render` method."),c)e.prototype[i]||(e.prototype[i]=null);return e}}},2498:function(t){"use strict";function e(t){return function(){return t}}var n=function(){};n.thatReturns=e,n.thatReturnsFalse=e(!1),n.thatReturnsTrue=e(!0),n.thatReturnsNull=e(null),n.thatReturnsThis=function(){return this},n.thatReturnsArgument=function(t){return t},t.exports=n},3677:function(t){"use strict";t.exports={}},3759:function(t){"use strict";t.exports=function(t,e,n,i,r,s,o,a){if(!t){var c;if(void 0===e)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,i,r,s,o,a],l=0;(c=new Error(e.replace(/%s/g,(function(){return u[l++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},3620:function(t,e,n){"use strict";var i=n(2498);t.exports=i},5321:function(t,e,n){"use strict";n.d(e,{hJ:function(){return fu},ad:function(){return yu},cf:function(){return ju},IO:function(){return Mu}});var i,r=n(2238),s=n(8463),o=n(3333),a=n(4444),c="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},u={},l=l||{},h=c||self;function d(){}function f(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var g="closure_uid_"+(1e9*Math.random()>>>0),m=0;function y(t,e,n){return t.call.apply(t.bind,arguments)}function v(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function _(t,e,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?y:v).apply(null,arguments)}function w(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function b(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,i){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[n].apply(t,r)}}function E(){this.s=this.s,this.o=this.o}var C={};E.prototype.s=!1,E.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,g)&&t[g]||(t[g]=++m)}(this);delete C[t]}},E.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const T=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"===typeof t)return"string"!==typeof e||1!=e.length?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},I=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const i=t.length,r="string"===typeof t?t.split(""):t;for(let s=0;s<i;s++)s in r&&e.call(n,r[s],s,t)};function S(t){return Array.prototype.concat.apply([],arguments)}function k(t){const e=t.length;if(0<e){const n=Array(e);for(let i=0;i<e;i++)n[i]=t[i];return n}return[]}function N(t){return/^[\s\xa0]*$/.test(t)}var A,x=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function D(t,e){return-1!=t.indexOf(e)}function P(t,e){return t<e?-1:t>e?1:0}t:{var R=h.navigator;if(R){var O=R.userAgent;if(O){A=O;break t}}A=""}function M(t,e,n){for(const i in t)e.call(n,t[i],i,t)}function L(t){const e={};for(const n in t)e[n]=t[n];return e}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(t,e){let n,i;for(let r=1;r<arguments.length;r++){for(n in i=arguments[r],i)t[n]=i[n];for(let e=0;e<F.length;e++)n=F[e],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function V(t){return V[" "](t),t}V[" "]=d;var U,q=D(A,"Opera"),B=D(A,"Trident")||D(A,"MSIE"),$=D(A,"Edge"),z=$||B,H=D(A,"Gecko")&&!(D(A.toLowerCase(),"webkit")&&!D(A,"Edge"))&&!(D(A,"Trident")||D(A,"MSIE"))&&!D(A,"Edge"),K=D(A.toLowerCase(),"webkit")&&!D(A,"Edge");function W(){var t=h.document;return t?t.documentMode:void 0}t:{var G="",Y=function(){var t=A;return H?/rv:([^\);]+)(\)|;)/.exec(t):$?/Edge\/([\d\.]+)/.exec(t):B?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):K?/WebKit\/(\S+)/.exec(t):q?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Y&&(G=Y?Y[1]:""),B){var Q=W();if(null!=Q&&Q>parseFloat(G)){U=String(Q);break t}}U=G}var X,J={};function Z(){return function(t){var e=J;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){let t=0;const e=x(String(U)).split("."),n=x("9").split("."),i=Math.max(e.length,n.length);for(let o=0;0==t&&o<i;o++){var r=e[o]||"",s=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==r[0].length&&0==s[0].length)break;t=P(0==r[1].length?0:parseInt(r[1],10),0==s[1].length?0:parseInt(s[1],10))||P(0==r[2].length,0==s[2].length)||P(r[2],s[2]),r=r[3],s=s[3]}while(0==t)}return 0<=t}))}if(h.document&&B){var tt=W();X=tt||(parseInt(U,10)||void 0)}else X=void 0;var et=X,nt=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{h.addEventListener("test",d,e),h.removeEventListener("test",d,e)}catch(n){}return t}();function it(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function rt(t,e){if(it.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(H){t:{try{V(e.nodeName);var r=!0;break t}catch(s){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"===typeof t.pointerType?t.pointerType:st[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&rt.Z.h.call(this)}}it.prototype.h=function(){this.defaultPrevented=!0},b(rt,it);var st={2:"touch",3:"pen",4:"mouse"};rt.prototype.h=function(){rt.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var ot="closure_listenable_"+(1e6*Math.random()|0),at=0;function ct(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.ia=r,this.key=++at,this.ca=this.fa=!1}function ut(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function lt(t){this.src=t,this.g={},this.h=0}function ht(t,e){var n=e.type;if(n in t.g){var i,r=t.g[n],s=T(r,e);(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(ut(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function dt(t,e,n,i){for(var r=0;r<t.length;++r){var s=t[r];if(!s.ca&&s.listener==e&&s.capture==!!n&&s.ia==i)return r}return-1}lt.prototype.add=function(t,e,n,i,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=dt(t,e,i,r);return-1<o?(e=t[o],n||(e.fa=!1)):((e=new ct(e,this.src,s,!!i,r)).fa=n,t.push(e)),e};var ft="closure_lm_"+(1e6*Math.random()|0),pt={};function gt(t,e,n,i,r){if(i&&i.once)return yt(t,e,n,i,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)gt(t,e[s],n,i,r);return null}return n=Tt(n),t&&t[ot]?t.N(e,n,p(i)?!!i.capture:!!i,r):mt(t,e,n,!1,i,r)}function mt(t,e,n,i,r,s){if(!e)throw Error("Invalid event type");var o=p(r)?!!r.capture:!!r,a=Et(t);if(a||(t[ft]=a=new lt(t)),(n=a.add(e,n,i,o,s)).proxy)return n;if(i=function(){function t(n){return e.call(t.src,t.listener,n)}var e=bt;return t}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)nt||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(wt(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}return n}function yt(t,e,n,i,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)yt(t,e[s],n,i,r);return null}return n=Tt(n),t&&t[ot]?t.O(e,n,p(i)?!!i.capture:!!i,r):mt(t,e,n,!0,i,r)}function vt(t,e,n,i,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)vt(t,e[s],n,i,r);else i=p(i)?!!i.capture:!!i,n=Tt(n),t&&t[ot]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=dt(s=t.g[e],n,i,r))&&(ut(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete t.g[e],t.h--)))):t&&(t=Et(t))&&(e=t.g[e.toString()],t=-1,e&&(t=dt(e,n,i,r)),(n=-1<t?e[t]:null)&&_t(n))}function _t(t){if("number"!==typeof t&&t&&!t.ca){var e=t.src;if(e&&e[ot])ht(e.i,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(wt(n),i):e.addListener&&e.removeListener&&e.removeListener(i),(n=Et(e))?(ht(n,t),0==n.h&&(n.src=null,e[ft]=null)):ut(t)}}}function wt(t){return t in pt?pt[t]:pt[t]="on"+t}function bt(t,e){if(t.ca)t=!0;else{e=new rt(e,this);var n=t.listener,i=t.ia||t.src;t.fa&&_t(t),t=n.call(i,e)}return t}function Et(t){return(t=t[ft])instanceof lt?t:null}var Ct="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tt(t){return"function"===typeof t?t:(t[Ct]||(t[Ct]=function(e){return t.handleEvent(e)}),t[Ct])}function It(){E.call(this),this.i=new lt(this),this.P=this,this.I=null}function St(t,e){var n,i=t.I;if(i)for(n=[];i;i=i.I)n.push(i);if(t=t.P,i=e.type||e,"string"===typeof e)e=new it(e,t);else if(e instanceof it)e.target=e.target||t;else{var r=e;j(e=new it(i,t),r)}if(r=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];r=kt(o,i,!0,e)&&r}if(r=kt(o=e.g=t,i,!0,e)&&r,r=kt(o,i,!1,e)&&r,n)for(s=0;s<n.length;s++)r=kt(o=e.g=n[s],i,!1,e)&&r}function kt(t,e,n,i){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&ht(t.i,o),r=!1!==a.call(c,i)&&r}}return r&&!i.defaultPrevented}b(It,E),It.prototype[ot]=!0,It.prototype.removeEventListener=function(t,e,n,i){vt(this,t,e,n,i)},It.prototype.M=function(){if(It.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],i=0;i<n.length;i++)ut(n[i]);delete e.g[t],e.h--}}this.I=null},It.prototype.N=function(t,e,n,i){return this.i.add(String(t),e,!1,n,i)},It.prototype.O=function(t,e,n,i){return this.i.add(String(t),e,!0,n,i)};var Nt=h.JSON.stringify;function At(){var t=Lt;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var xt,Dt=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}((()=>new Pt),(t=>t.reset()));class Pt{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function Rt(t){h.setTimeout((()=>{throw t}),0)}function Ot(t,e){xt||function(){var t=h.Promise.resolve(void 0);xt=function(){t.then(Ft)}}(),Mt||(xt(),Mt=!0),Lt.add(t,e)}var Mt=!1,Lt=new class{constructor(){this.h=this.g=null}add(t,e){const n=Dt.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n}};function Ft(){for(var t;t=At();){try{t.h.call(t.g)}catch(n){Rt(n)}var e=Dt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Mt=!1}function jt(t,e){It.call(this),this.h=t||1,this.g=e||h,this.j=_(this.kb,this),this.l=Date.now()}function Vt(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Ut(t,e,n){if("function"===typeof t)n&&(t=_(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_(t.handleEvent,t)}return 2147483647<Number(e)?-1:h.setTimeout(t,e||0)}function qt(t){t.g=Ut((()=>{t.g=null,t.i&&(t.i=!1,qt(t))}),t.j);const e=t.h;t.h=null,t.m.apply(null,e)}b(jt,It),(i=jt.prototype).da=!1,i.S=null,i.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),St(this,"tick"),this.da&&(Vt(this),this.start()))}},i.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},i.M=function(){jt.Z.M.call(this),Vt(this),delete this.g};class Bt extends E{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:qt(this)}M(){super.M(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function $t(t){E.call(this),this.h=t,this.g={}}b($t,E);var zt=[];function Ht(t,e,n,i){Array.isArray(n)||(n&&(zt[0]=n.toString()),n=zt);for(var r=0;r<n.length;r++){var s=gt(e,n[r],i||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Kt(t){M(t.g,(function(t,e){this.g.hasOwnProperty(e)&&_t(t)}),t),t.g={}}function Wt(){this.g=!0}function Gt(t,e,n,i){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var i=n[t];if(!(2>i.length)){var r=i[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return Nt(n)}catch(a){return e}}(t,n)+(i?" "+i:"")}))}$t.prototype.M=function(){$t.Z.M.call(this),Kt(this)},$t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Wt.prototype.Aa=function(){this.g=!1},Wt.prototype.info=function(){};var Yt={},Qt=null;function Xt(){return Qt=Qt||new It}function Jt(t){it.call(this,Yt.Ma,t)}function Zt(t){const e=Xt();St(e,new Jt(e,t))}function te(t,e){it.call(this,Yt.STAT_EVENT,t),this.stat=e}function ee(t){const e=Xt();St(e,new te(e,t))}function ne(t,e){it.call(this,Yt.Na,t),this.size=e}function ie(t,e){if("function"!==typeof t)throw Error("Fn must not be null and must be a function");return h.setTimeout((function(){t()}),e)}Yt.Ma="serverreachability",b(Jt,it),Yt.STAT_EVENT="statevent",b(te,it),Yt.Na="timingevent",b(ne,it);var re={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},se={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function oe(){}function ae(t){return t.h||(t.h=t.i())}function ce(){}oe.prototype.h=null;var ue,le={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function he(){it.call(this,"d")}function de(){it.call(this,"c")}function fe(){}function pe(t,e,n,i){this.l=t,this.j=e,this.m=n,this.X=i||1,this.V=new $t(this),this.P=me,t=z?125:void 0,this.W=new jt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new ge}function ge(){this.i=null,this.g="",this.h=!1}b(he,it),b(de,it),b(fe,oe),fe.prototype.g=function(){return new XMLHttpRequest},fe.prototype.i=function(){return{}},ue=new fe;var me=45e3,ye={},ve={};function _e(t,e,n){t.K=1,t.v=Be(Le(e)),t.s=n,t.U=!0,we(t,null)}function we(t,e){t.F=Date.now(),Te(t),t.A=Le(t.v);var n=t.A,i=t.X;Array.isArray(i)||(i=[String(i)]),en(n.h,"t",i),t.C=0,n=t.l.H,t.h=new ge,t.g=ii(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Bt(_(t.Ia,t,t.g),t.O)),Ht(t.V,t.g,"readystatechange",t.gb),e=t.H?L(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Zt(1),function(t,e,n,i,r,s){t.info((function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+i+") [attempt "+r+"]: "+e+"\n"+n+"\n"+o}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function be(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Ee(t,e,n){let i,r=!0;for(;!t.I&&t.C<n.length;){if(i=Ce(t,n),i==ve){4==e&&(t.o=4,ee(14),r=!1),Gt(t.j,t.m,null,"[Incomplete Response]");break}if(i==ye){t.o=4,ee(15),Gt(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}Gt(t.j,t.m,i,null),Ae(t,i)}be(t)&&i!=ve&&i!=ye&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,ee(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Yn(e),e.L=!0,ee(11))):(Gt(t.j,t.m,n,"[Invalid Chunked Response]"),Ne(t),ke(t))}function Ce(t,e){var n=t.C,i=e.indexOf("\n",n);return-1==i?ve:(n=Number(e.substring(n,i)),isNaN(n)?ye:(i+=1)+n>e.length?ve:(e=e.substr(i,n),t.C=i+n,e))}function Te(t){t.Y=Date.now()+t.P,Ie(t,t.P)}function Ie(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=ie(_(t.eb,t),e)}function Se(t){t.B&&(h.clearTimeout(t.B),t.B=null)}function ke(t){0==t.l.G||t.I||Jn(t.l,t)}function Ne(t){Se(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,Vt(t.W),Kt(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Ae(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||un(n.i,t)))if(n.I=t.N,!t.J&&un(n.i,t)&&3==n.G){try{var i=n.Ca.g.parse(e)}catch(u){i=null}if(Array.isArray(i)&&3==i.length){var r=i;if(0==r[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;Xn(n),Un(n)}Gn(n),ee(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&0==n.A&&!n.v&&(n.v=ie(_(n.ab,n),6e3));if(1>=cn(n.i)&&n.ka){try{n.ka()}catch(u){}n.ka=void 0}}else ti(n,11)}else if((t.J||n.g==t)&&Xn(n),!N(e))for(r=n.Ca.g.parse(e),e=0;e<r.length;e++){let u=r[e];if(n.U=u[0],u=u[1],2==n.G)if("c"==u[0]){n.J=u[1],n.la=u[2];const e=u[3];null!=e&&(n.ma=e,n.h.info("VER="+n.ma));const r=u[4];null!=r&&(n.za=r,n.h.info("SVER="+n.za));const l=u[5];null!=l&&"number"===typeof l&&0<l&&(i=1.5*l,n.K=i,n.h.info("backChannelRequestTimeoutMs_="+i)),i=n;const h=t.g;if(h){const t=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=i.i;!s.g&&(D(t,"spdy")||D(t,"quic")||D(t,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(ln(s,s.h),s.h=null))}if(i.D){const t=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(i.sa=t,qe(i.F,i.D,t))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=t;if((i=n).oa=ni(i,i.H?i.la:null,i.W),o.J){hn(i.i,o);var a=o,c=i.K;c&&a.setTimeout(c),a.B&&(Se(a),Te(a)),i.g=o}else Wn(i);0<n.l.length&&$n(n)}else"stop"!=u[0]&&"close"!=u[0]||ti(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?ti(n,7):Vn(n):"noop"!=u[0]&&n.j&&n.j.wa(u),n.A=0)}Zt(4)}catch(u){}}function xe(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(f(t)||"string"===typeof t)I(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(f(t)||"string"===typeof t){n=[];for(var i=t.length,r=0;r<i;r++)n.push(r)}else for(r in n=[],i=0,t)n[i++]=r;i=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"===typeof t)return t.split("");if(f(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}(t),r=i.length;for(var s=0;s<r;s++)e.call(void 0,i[s],n&&n[s],t)}}function De(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof De)for(n=t.T(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Pe(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var i=t.g[e];Re(t.h,i)&&(t.g[n++]=i),e++}t.g.length=n}if(t.i!=t.g.length){var r={};for(n=e=0;e<t.g.length;)Re(r,i=t.g[e])||(t.g[n++]=i,r[i]=1),e++;t.g.length=n}}function Re(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(i=pe.prototype).setTimeout=function(t){this.P=t},i.gb=function(t){t=t.target;const e=this.L;e&&3==On(t)?e.l():this.Ia(t)},i.Ia=function(t){try{if(t==this.g)t:{const l=On(this.g);var e=this.g.Da();const d=this.g.ba();if(!(3>l)&&(3!=l||z||this.g&&(this.h.h||this.g.ga()||Mn(this.g)))){this.I||4!=l||7==e||Zt(8==e||0>=d?3:2),Se(this);var n=this.g.ba();this.N=n;e:if(be(this)){var i=Mn(this.g);t="";var r=i.length,s=4==On(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ne(this),ke(this);var o="";break e}this.h.i=new h.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(i[e],{stream:s&&e==r-1});i.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(t,e,n,i,r,s,o){t.info((function(){return"XMLHTTP RESP ("+i+") [ attempt "+r+"]: "+e+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,l,n),this.i){if(this.$&&!this.J){e:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(a)){var u=a;break e}}u=null}if(!(n=u)){this.i=!1,this.o=3,ee(12),Ne(this),ke(this);break t}Gt(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Ae(this,n)}this.U?(Ee(this,l,o),z&&this.i&&3==l&&(Ht(this.V,this.W,"tick",this.fb),this.W.start())):(Gt(this.j,this.m,o,null),Ae(this,o)),4==l&&Ne(this),this.i&&!this.I&&(4==l?Jn(this.l,this):(this.i=!1,Te(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,ee(12)):(this.o=0,ee(13)),Ne(this),ke(this)}}}catch(l){}},i.fb=function(){if(this.g){var t=On(this.g),e=this.g.ga();this.C<e.length&&(Se(this),Ee(this,t,e),this.i&&4!=t&&Te(this))}},i.cancel=function(){this.I=!0,Ne(this)},i.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(Zt(3),ee(17)),Ne(this),this.o=2,ke(this)):Ie(this,this.Y-t)},(i=De.prototype).R=function(){Pe(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},i.T=function(){return Pe(this),this.g.concat()},i.get=function(t,e){return Re(this.h,t)?this.h[t]:e},i.set=function(t,e){Re(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},i.forEach=function(t,e){for(var n=this.T(),i=0;i<n.length;i++){var r=n[i],s=this.get(r);t.call(e,s,r,this)}};var Oe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Me(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Me){this.g=void 0!==e?e:t.g,Fe(this,t.j),this.s=t.s,je(this,t.i),Ve(this,t.m),this.l=t.l,e=t.h;var n=new Xe;n.i=e.i,e.g&&(n.g=new De(e.g),n.h=e.h),Ue(this,n),this.o=t.o}else t&&(n=String(t).match(Oe))?(this.g=!!e,Fe(this,n[1]||"",!0),this.s=$e(n[2]||""),je(this,n[3]||"",!0),Ve(this,n[4]),this.l=$e(n[5]||"",!0),Ue(this,n[6]||"",!0),this.o=$e(n[7]||"")):(this.g=!!e,this.h=new Xe(null,this.g))}function Le(t){return new Me(t)}function Fe(t,e,n){t.j=n?$e(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function je(t,e,n){t.i=n?$e(e,!0):e}function Ve(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Ue(t,e,n){e instanceof Xe?(t.h=e,function(t,e){e&&!t.j&&(Je(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(Ze(this,e),en(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=ze(e,Ye)),t.h=new Xe(e,t.g))}function qe(t,e,n){t.h.set(e,n)}function Be(t){return qe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ze(t,e,n){return"string"===typeof t?(t=encodeURI(t).replace(e,He),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function He(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Me.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ze(e,Ke,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(ze(e,Ke,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(ze(n,"/"==n.charAt(0)?Ge:We,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ze(n,Qe)),t.join("")};var Ke=/[#\/\?@]/g,We=/[#\?:]/g,Ge=/[#\?]/g,Ye=/[#\?@]/g,Qe=/#/g;function Xe(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Je(t){t.g||(t.g=new De,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var s=t[n].substring(0,i);r=t[n].substring(i+1)}else s=t[n];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function Ze(t,e){Je(t),e=nn(t,e),Re(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Re((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&Pe(t)))}function tn(t,e){return Je(t),e=nn(t,e),Re(t.g.h,e)}function en(t,e,n){Ze(t,e),0<n.length&&(t.i=null,t.g.set(nn(t,e),k(n)),t.h+=n.length)}function nn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(i=Xe.prototype).add=function(t,e){Je(this),this.i=null,t=nn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},i.forEach=function(t,e){Je(this),this.g.forEach((function(n,i){I(n,(function(n){t.call(e,n,i,this)}),this)}),this)},i.T=function(){Je(this);for(var t=this.g.R(),e=this.g.T(),n=[],i=0;i<e.length;i++)for(var r=t[i],s=0;s<r.length;s++)n.push(e[i]);return n},i.R=function(t){Je(this);var e=[];if("string"===typeof t)tn(this,t)&&(e=S(e,this.g.get(nn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=S(e,t[n])}return e},i.set=function(t,e){return Je(this),this.i=null,tn(this,t=nn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},i.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},i.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.R(i);for(var s=0;s<i.length;s++){var o=r;""!==i[s]&&(o+="="+encodeURIComponent(String(i[s]))),t.push(o)}}return this.i=t.join("&")};function rn(t){this.l=t||on,h.PerformanceNavigationTiming?t=0<(t=h.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(h.g&&h.g.Ea&&h.g.Ea()&&h.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var sn,on=10;function an(t){return!!t.h||!!t.g&&t.g.size>=t.j}function cn(t){return t.h?1:t.g?t.g.size:0}function un(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function ln(t,e){t.g?t.g.add(e):t.h=e}function hn(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function dn(t){if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return k(t.i)}function fn(){}function pn(){this.g=new fn}function gn(t,e,n){const i=n||"";try{xe(t,(function(t,n){let r=t;p(t)&&(r=Nt(t)),e.push(i+n+"="+encodeURIComponent(r))}))}catch(r){throw e.push(i+"type="+encodeURIComponent("_badmap")),r}}function mn(t,e,n,i,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(i)}catch(s){}}function yn(t){this.l=t.$b||null,this.j=t.ib||!1}function vn(t,e){It.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=_n,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}rn.prototype.cancel=function(){if(this.i=dn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}},fn.prototype.stringify=function(t){return h.JSON.stringify(t,void 0)},fn.prototype.parse=function(t){return h.JSON.parse(t,void 0)},b(yn,oe),yn.prototype.g=function(){return new vn(this.l,this.j)},yn.prototype.i=(sn={},function(){return sn}),b(vn,It);var _n=0;function wn(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function bn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,En(t)}function En(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(i=vn.prototype).open=function(t,e){if(this.readyState!=_n)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,En(this)},i.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||h).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},i.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,bn(this)),this.readyState=_n},i.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,En(this)),this.g&&(this.readyState=3,En(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if("undefined"!==typeof h.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;wn(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},i.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?bn(this):En(this),3==this.readyState&&wn(this)}},i.Ua=function(t){this.g&&(this.response=this.responseText=t,bn(this))},i.Ta=function(t){this.g&&(this.response=t,bn(this))},i.ha=function(){this.g&&bn(this)},i.setRequestHeader=function(t,e){this.v.append(t,e)},i.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},i.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(vn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var Cn=h.JSON.parse;function Tn(t){It.call(this),this.headers=new De,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=In,this.K=this.L=!1}b(Tn,It);var In="",Sn=/^https?$/i,kn=["POST","PUT"];function Nn(t){return"content-type"==t.toLowerCase()}function An(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,xn(t),Pn(t)}function xn(t){t.D||(t.D=!0,St(t,"complete"),St(t,"error"))}function Dn(t){if(t.h&&"undefined"!=typeof l&&(!t.C[1]||4!=On(t)||2!=t.ba()))if(t.v&&4==On(t))Ut(t.Fa,0,t);else if(St(t,"readystatechange"),4==On(t)){t.h=!1;try{const c=t.ba();t:switch(c){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var n;if(!(n=e)){var i;if(i=0===c){var r=String(t.H).match(Oe)[1]||null;if(!r&&h.self&&h.self.location){var s=h.self.location.protocol;r=s.substr(0,s.length-1)}i=!Sn.test(r?r.toLowerCase():"")}n=i}if(n)St(t,"complete"),St(t,"success");else{t.m=6;try{var o=2<On(t)?t.g.statusText:""}catch(a){o=""}t.j=o+" ["+t.ba()+"]",xn(t)}}finally{Pn(t)}}}function Pn(t,e){if(t.g){Rn(t);const i=t.g,r=t.C[0]?d:null;t.g=null,t.C=null,e||St(t,"ready");try{i.onreadystatechange=r}catch(n){}}}function Rn(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(h.clearTimeout(t.A),t.A=null)}function On(t){return t.g?t.g.readyState:0}function Mn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case In:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Ln(t,e,n){t:{for(i in n){var i=!1;break t}i=!0}i||(n=function(t){let e="";return M(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"===typeof t?null!=n&&encodeURIComponent(String(n)):qe(t,e,n))}function Fn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function jn(t){this.za=0,this.l=[],this.h=new Wt,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Fn("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Fn("baseRetryDelayMs",5e3,t),this.$a=Fn("retryDelaySeedMs",1e4,t),this.Ya=Fn("forwardChannelMaxRetries",2,t),this.ra=Fn("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new rn(t&&t.concurrentRequestLimit),this.Ca=new pn,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function Vn(t){if(qn(t),3==t.G){var e=t.V++,n=Le(t.F);qe(n,"SID",t.J),qe(n,"RID",e),qe(n,"TYPE","terminate"),Hn(t,n),(e=new pe(t,t.h,e,void 0)).K=2,e.v=Be(Le(n)),n=!1,h.navigator&&h.navigator.sendBeacon&&(n=h.navigator.sendBeacon(e.v.toString(),"")),!n&&h.Image&&((new Image).src=e.v,n=!0),n||(e.g=ii(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Te(e)}ei(t)}function Un(t){t.g&&(Yn(t),t.g.cancel(),t.g=null)}function qn(t){Un(t),t.u&&(h.clearTimeout(t.u),t.u=null),Xn(t),t.i.cancel(),t.m&&("number"===typeof t.m&&h.clearTimeout(t.m),t.m=null)}function Bn(t,e){t.l.push(new class{constructor(t,e){this.h=t,this.g=e}}(t.Za++,e)),3==t.G&&$n(t)}function $n(t){an(t.i)||t.m||(t.m=!0,Ot(t.Ha,t),t.C=0)}function zn(t,e){var n;n=e?e.m:t.V++;const i=Le(t.F);qe(i,"SID",t.J),qe(i,"RID",n),qe(i,"AID",t.U),Hn(t,i),t.o&&t.s&&Ln(i,t.o,t.s),n=new pe(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=Kn(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),ln(t.i,n),_e(n,i,e)}function Hn(t,e){t.j&&xe({},(function(t,n){qe(e,n,t)}))}function Kn(t,e,n){n=Math.min(t.l.length,n);var i=t.j?_(t.j.Oa,t.j,t):null;t:{var r=t.l;let e=-1;for(;;){const t=["count="+n];-1==e?0<n?(e=r[0].h,t.push("ofs="+e)):e=0:t.push("ofs="+e);let s=!0;for(let o=0;o<n;o++){let n=r[o].h;const a=r[o].g;if(n-=e,0>n)e=Math.max(0,r[o].h-100),s=!1;else try{gn(a,t,"req"+n+"_")}catch(Di){i&&i(a)}}if(s){i=t.join("&");break t}}}return t=t.l.splice(0,n),e.D=t,i}function Wn(t){t.g||t.u||(t.Y=1,Ot(t.Ga,t),t.A=0)}function Gn(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=ie(_(t.Ga,t),Zn(t,t.A)),t.A++,!0)}function Yn(t){null!=t.B&&(h.clearTimeout(t.B),t.B=null)}function Qn(t){t.g=new pe(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=Le(t.oa);qe(e,"RID","rpc"),qe(e,"SID",t.J),qe(e,"CI",t.N?"0":"1"),qe(e,"AID",t.U),Hn(t,e),qe(e,"TYPE","xmlhttp"),t.o&&t.s&&Ln(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Be(Le(e)),n.s=null,n.U=!0,we(n,t)}function Xn(t){null!=t.v&&(h.clearTimeout(t.v),t.v=null)}function Jn(t,e){var n=null;if(t.g==e){Xn(t),Yn(t),t.g=null;var i=2}else{if(!un(t.i,e))return;n=e.D,hn(t.i,e),i=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==i){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;St(i=Xt(),new ne(i,n,e,r)),$n(t)}else Wn(t);else if(3==(r=e.o)||0==r&&0<t.I||!(1==i&&function(t,e){return!(cn(t.i)>=t.i.j-(t.m?1:0))&&(t.m?(t.l=e.D.concat(t.l),!0):!(1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya))&&(t.m=ie(_(t.Ha,t,e),Zn(t,t.C)),t.C++,!0))}(t,e)||2==i&&Gn(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:ti(t,5);break;case 4:ti(t,10);break;case 3:ti(t,6);break;default:ti(t,2)}}function Zn(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function ti(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var i=_(t.jb,t);n||(n=new Me("//www.google.com/images/cleardot.gif"),h.location&&"http"==h.location.protocol||Fe(n,"https"),Be(n)),function(t,e){const n=new Wt;if(h.Image){const i=new Image;i.onload=w(mn,n,i,"TestLoadImage: loaded",!0,e),i.onerror=w(mn,n,i,"TestLoadImage: error",!1,e),i.onabort=w(mn,n,i,"TestLoadImage: abort",!1,e),i.ontimeout=w(mn,n,i,"TestLoadImage: timeout",!1,e),h.setTimeout((function(){i.ontimeout&&i.ontimeout()}),1e4),i.src=t}else e(!1)}(n.toString(),i)}else ee(2);t.G=0,t.j&&t.j.va(e),ei(t),qn(t)}function ei(t){t.G=0,t.I=-1,t.j&&(0==dn(t.i).length&&0==t.l.length||(t.i.i.length=0,k(t.l),t.l.length=0),t.j.ua())}function ni(t,e,n){let i=function(t){return t instanceof Me?Le(t):new Me(t,void 0)}(n);if(""!=i.i)e&&je(i,e+"."+i.i),Ve(i,i.m);else{const t=h.location;i=function(t,e,n,i){var r=new Me(null,void 0);return t&&Fe(r,t),e&&je(r,e),n&&Ve(r,n),i&&(r.l=i),r}(t.protocol,e?e+"."+t.hostname:t.hostname,+t.port,n)}return t.aa&&M(t.aa,(function(t,e){qe(i,e,t)})),e=t.D,n=t.sa,e&&n&&qe(i,e,n),qe(i,"VER",t.ma),Hn(t,i),i}function ii(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new Tn(new yn({ib:!0})):new Tn(t.qa)).L=t.H,e}function ri(){}function si(){if(B&&!(10<=Number(et)))throw Error("Environmental error: no available transport.")}function oi(t,e){It.call(this),this.g=new jn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!N(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!N(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new ui(this)}function ai(t){he.call(this);var e=t.__sm__;if(e){t:{for(const n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function ci(){de.call(this),this.status=1}function ui(t){this.g=t}(i=Tn.prototype).ea=function(t,e,n,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ue.g(),this.C=this.u?ae(this.u):ae(ue),this.g.onreadystatechange=_(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(s){return void An(this,s)}t=n||"";const r=new De(this.headers);i&&xe(i,(function(t,e){r.set(e,t)})),i=function(t){t:{var e=Nn;const n=t.length,i="string"===typeof t?t.split(""):t;for(let r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:"string"===typeof t?t.charAt(e):t[e]}(r.T()),n=h.FormData&&t instanceof h.FormData,!(0<=T(kn,e))||i||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Rn(this),0<this.B&&((this.K=function(t){return B&&Z()&&"number"===typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_(this.pa,this)):this.A=Ut(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){An(this,s)}},i.pa=function(){"undefined"!=typeof l&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,St(this,"timeout"),this.abort(8))},i.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,St(this,"complete"),St(this,"abort"),Pn(this))},i.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Pn(this,!0)),Tn.Z.M.call(this)},i.Fa=function(){this.s||(this.F||this.v||this.l?Dn(this):this.cb())},i.cb=function(){Dn(this)},i.ba=function(){try{return 2<On(this)?this.g.status:-1}catch(sn){return-1}},i.ga=function(){try{return this.g?this.g.responseText:""}catch(sn){return""}},i.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Cn(e)}},i.Da=function(){return this.m},i.La=function(){return"string"===typeof this.j?this.j:String(this.j)},(i=jn.prototype).ma=8,i.G=1,i.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(e){}},i.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const r=new pe(this,this.h,t,void 0);let s=this.s;if(this.P&&(s?(s=L(s),j(s,this.P)):s=this.P),null===this.o&&(r.H=s),this.ja)t:{for(var e=0,n=0;n<this.l.length;n++){var i=this.l[n];if(void 0===(i="__data__"in i.g&&"string"===typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=n;break t}if(4096===e||n===this.l.length-1){e=n+1;break t}}e=1e3}else e=1e3;e=Kn(this,r,e),qe(n=Le(this.F),"RID",t),qe(n,"CVER",22),this.D&&qe(n,"X-HTTP-Session-Id",this.D),Hn(this,n),this.o&&s&&Ln(n,this.o,s),ln(this.i,r),this.Ra&&qe(n,"TYPE","init"),this.ja?(qe(n,"$req",e),qe(n,"SID","null"),r.$=!0,_e(r,n,null)):_e(r,n,e),this.G=2}}else 3==this.G&&(t?zn(this,t):0==this.l.length||an(this.i)||zn(this))},i.Ga=function(){if(this.u=null,Qn(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=ie(_(this.bb,this),t)}},i.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ee(10),Un(this),Qn(this))},i.ab=function(){null!=this.v&&(this.v=null,Un(this),Gn(this),ee(19))},i.jb=function(t){t?(this.h.info("Successfully pinged google.com"),ee(2)):(this.h.info("Failed to ping google.com"),ee(1))},(i=ri.prototype).xa=function(){},i.wa=function(){},i.va=function(){},i.ua=function(){},i.Oa=function(){},si.prototype.g=function(t,e){return new oi(t,e)},b(oi,It),oi.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Ot(_(t.hb,t,e))),ee(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=ni(t,null,t.W),$n(t)},oi.prototype.close=function(){Vn(this.g)},oi.prototype.u=function(t){if("string"===typeof t){var e={};e.__data__=t,Bn(this.g,e)}else this.v?((e={}).__data__=Nt(t),Bn(this.g,e)):Bn(this.g,t)},oi.prototype.M=function(){this.g.j=null,delete this.j,Vn(this.g),delete this.g,oi.Z.M.call(this)},b(ai,he),b(ci,de),b(ui,ri),ui.prototype.xa=function(){St(this.g,"a")},ui.prototype.wa=function(t){St(this.g,new ai(t))},ui.prototype.va=function(t){St(this.g,new ci(t))},ui.prototype.ua=function(){St(this.g,"b")},si.prototype.createWebChannel=si.prototype.g,oi.prototype.send=oi.prototype.u,oi.prototype.open=oi.prototype.m,oi.prototype.close=oi.prototype.close,re.NO_ERROR=0,re.TIMEOUT=8,re.HTTP_ERROR=6,se.COMPLETE="complete",ce.EventType=le,le.OPEN="a",le.CLOSE="b",le.ERROR="c",le.MESSAGE="d",It.prototype.listen=It.prototype.N,Tn.prototype.listenOnce=Tn.prototype.O,Tn.prototype.getLastError=Tn.prototype.La,Tn.prototype.getLastErrorCode=Tn.prototype.Da,Tn.prototype.getStatus=Tn.prototype.ba,Tn.prototype.getResponseJson=Tn.prototype.Qa,Tn.prototype.getResponseText=Tn.prototype.ga,Tn.prototype.send=Tn.prototype.ea;var li=u.createWebChannelTransport=function(){return new si},hi=u.getStatEventTarget=function(){return Xt()},di=u.ErrorCode=re,fi=u.EventType=se,pi=u.Event=Yt,gi=u.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},mi=u.FetchXmlHttpFactory=yn,yi=u.WebChannel=ce,vi=u.XhrIo=Tn;n(3454);const _i="@firebase/firestore";class wi{constructor(t){this.uid=t}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}wi.UNAUTHENTICATED=new wi(null),wi.GOOGLE_CREDENTIALS=new wi("google-credentials-uid"),wi.FIRST_PARTY=new wi("first-party-uid"),wi.MOCK_USER=new wi("mock-user");let bi="9.8.3";const Ei=new o.Yd("@firebase/firestore");function Ci(){return Ei.logLevel}function Ti(t,...e){if(Ei.logLevel<=o.in.DEBUG){const n=e.map(ki);Ei.debug(`Firestore (${bi}): ${t}`,...n)}}function Ii(t,...e){if(Ei.logLevel<=o.in.ERROR){const n=e.map(ki);Ei.error(`Firestore (${bi}): ${t}`,...n)}}function Si(t,...e){if(Ei.logLevel<=o.in.WARN){const n=e.map(ki);Ei.warn(`Firestore (${bi}): ${t}`,...n)}}function ki(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Ni(t="Unexpected state"){const e=`FIRESTORE (${bi}) INTERNAL ASSERTION FAILED: `+t;throw Ii(e),new Error(e)}function Ai(t,e){t||Ni()}function xi(t,e){return t}const Di={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Pi extends a.ZR{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Ri{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class Oi{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Mi{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(wi.UNAUTHENTICATED)))}shutdown(){}}class Li{constructor(t){this.t=t,this.currentUser=wi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let n=this.i;const i=t=>this.i!==n?(n=this.i,e(t)):Promise.resolve();let r=new Ri;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new Ri,t.enqueueRetryable((()=>i(this.currentUser)))};const s=()=>{const e=r;t.enqueueRetryable((async()=>{await e.promise,await i(this.currentUser)}))},o=t=>{Ti("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=t,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((t=>o(t))),setTimeout((()=>{if(!this.auth){const t=this.t.getImmediate({optional:!0});t?o(t):(Ti("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new Ri)}}),0),s()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((e=>this.i!==t?(Ti("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):e?(Ai("string"==typeof e.accessToken),new Oi(e.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const t=this.auth&&this.auth.getUid();return Ai(null===t||"string"==typeof t),new wi(t)}}class Fi{constructor(t,e,n){this.type="FirstParty",this.user=wi.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",e);const i=t.auth.getAuthHeaderValueForFirstParty([]);i&&this.headers.set("Authorization",i),n&&this.headers.set("X-Goog-Iam-Authorization-Token",n)}}class ji{constructor(t,e,n){this.h=t,this.l=e,this.m=n}getToken(){return Promise.resolve(new Fi(this.h,this.l,this.m))}start(t,e){t.enqueueRetryable((()=>e(wi.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Vi{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ui{constructor(t){this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(t,e){const n=t=>{null!=t.error&&Ti("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${t.error.message}`);const n=t.token!==this.p;return this.p=t.token,Ti("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?e(t.token):Promise.resolve()};this.o=e=>{t.enqueueRetryable((()=>n(e)))};const i=t=>{Ti("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=t,this.appCheck.addTokenListener(this.o)};this.g.onInit((t=>i(t))),setTimeout((()=>{if(!this.appCheck){const t=this.g.getImmediate({optional:!0});t?i(t):Ti("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((t=>t?(Ai("string"==typeof t.token),this.p=t.token,new Vi(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function qi(t){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class Bi{static I(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length;let n="";for(;n.length<20;){const i=qi(40);for(let r=0;r<i.length;++r)n.length<20&&i[r]<e&&(n+=t.charAt(i[r]%t.length))}return n}}function $i(t,e){return t<e?-1:t>e?1:0}function zi(t,e,n){return t.length===e.length&&t.every(((t,i)=>n(t,e[i])))}class Hi{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Pi(Di.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Pi(Di.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Pi(Di.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Pi(Di.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return Hi.fromMillis(Date.now())}static fromDate(t){return Hi.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),n=Math.floor(1e6*(t-1e3*e));return new Hi(e,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?$i(this.nanoseconds,t.nanoseconds):$i(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Ki{constructor(t){this.timestamp=t}static fromTimestamp(t){return new Ki(t)}static min(){return new Ki(new Hi(0,0))}static max(){return new Ki(new Hi(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Wi{constructor(t,e,n){void 0===e?e=0:e>t.length&&Ni(),void 0===n?n=t.length-e:n>t.length-e&&Ni(),this.segments=t,this.offset=e,this.len=n}get length(){return this.len}isEqual(t){return 0===Wi.comparator(this,t)}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof Wi?t.forEach((t=>{e.push(t)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return 0===this.length}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const n=t.get(i),r=e.get(i);if(n<r)return-1;if(n>r)return 1}return t.length<e.length?-1:t.length>e.length?1:0}}class Gi extends Wi{construct(t,e,n){return new Gi(t,e,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...t){const e=[];for(const n of t){if(n.indexOf("//")>=0)throw new Pi(Di.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);e.push(...n.split("/").filter((t=>t.length>0)))}return new Gi(e)}static emptyPath(){return new Gi([])}}const Yi=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Qi extends Wi{construct(t,e,n){return new Qi(t,e,n)}static isValidIdentifier(t){return Yi.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Qi.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Qi(["__name__"])}static fromServerFormat(t){const e=[];let n="",i=0;const r=()=>{if(0===n.length)throw new Pi(Di.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(n),n=""};let s=!1;for(;i<t.length;){const e=t[i];if("\\"===e){if(i+1===t.length)throw new Pi(Di.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const e=t[i+1];if("\\"!==e&&"."!==e&&"`"!==e)throw new Pi(Di.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=e,i+=2}else"`"===e?(s=!s,i++):"."!==e||s?(n+=e,i++):(r(),i++)}if(r(),s)throw new Pi(Di.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Qi(e)}static emptyPath(){return new Qi([])}}class Xi{constructor(t){this.path=t}static fromPath(t){return new Xi(Gi.fromString(t))}static fromName(t){return new Xi(Gi.fromString(t).popFirst(5))}static empty(){return new Xi(Gi.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return null!==t&&0===Gi.comparator(this.path,t.path)}toString(){return this.path.toString()}static comparator(t,e){return Gi.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new Xi(new Gi(t.slice()))}}class Ji{constructor(t,e,n,i){this.indexId=t,this.collectionGroup=e,this.fields=n,this.indexState=i}}Ji.UNKNOWN_ID=-1;function Zi(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,r=Ki.fromTimestamp(1e9===i?new Hi(n+1,0):new Hi(n,i));return new er(r,Xi.empty(),e)}function tr(t){return new er(t.readTime,t.key,-1)}class er{constructor(t,e,n){this.readTime=t,this.documentKey=e,this.largestBatchId=n}static min(){return new er(Ki.min(),Xi.empty(),-1)}static max(){return new er(Ki.max(),Xi.empty(),-1)}}function nr(t,e){let n=t.readTime.compareTo(e.readTime);return 0!==n?n:(n=Xi.comparator(t.documentKey,e.documentKey),0!==n?n:$i(t.largestBatchId,e.largestBatchId))}const ir="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rr{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function sr(t){if(t.code!==Di.FAILED_PRECONDITION||t.message!==ir)throw t;Ti("LocalStore","Unexpectedly lost primary lease")}class or{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&Ni(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new or(((n,i)=>{this.nextCallback=e=>{this.wrapSuccess(t,e).next(n,i)},this.catchCallback=t=>{this.wrapFailure(e,t).next(n,i)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof or?e:or.resolve(e)}catch(t){return or.reject(t)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):or.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):or.reject(e)}static resolve(t){return new or(((e,n)=>{e(t)}))}static reject(t){return new or(((e,n)=>{n(t)}))}static waitFor(t){return new or(((e,n)=>{let i=0,r=0,s=!1;t.forEach((t=>{++i,t.next((()=>{++r,s&&r===i&&e()}),(t=>n(t)))})),s=!0,r===i&&e()}))}static or(t){let e=or.resolve(!1);for(const n of t)e=e.next((t=>t?or.resolve(t):n()));return e}static forEach(t,e){const n=[];return t.forEach(((t,i)=>{n.push(e.call(this,t,i))})),this.waitFor(n)}static mapArray(t,e){return new or(((n,i)=>{const r=t.length,s=new Array(r);let o=0;for(let a=0;a<r;a++){const c=a;e(t[c]).next((t=>{s[c]=t,++o,o===r&&n(s)}),(t=>i(t)))}}))}static doWhile(t,e){return new or(((n,i)=>{const r=()=>{!0===t()?e().next((()=>{r()}),i):n()};r()}))}}function ar(t){return"IndexedDbTransactionError"===t.name}class cr{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=t=>this.it(t),this.rt=t=>e.writeSequenceNumber(t))}it(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.rt&&this.rt(t),t}}function ur(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function lr(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function hr(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}cr.ot=-1;class dr{constructor(t,e){this.comparator=t,this.root=e||pr.EMPTY}insert(t,e){return new dr(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,pr.BLACK,null,null))}remove(t){return new dr(this.comparator,this.root.remove(t,this.comparator).copy(null,null,pr.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null}indexOf(t){let e=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(t,n.key);if(0===i)return e+n.left.size;i<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,n)=>(t(e,n),!1)))}toString(){const t=[];return this.inorderTraversal(((e,n)=>(t.push(`${e}:${n}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new fr(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new fr(this.root,t,this.comparator,!1)}getReverseIterator(){return new fr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new fr(this.root,t,this.comparator,!0)}}class fr{constructor(t,e,n,i){this.isReverse=i,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,e&&i&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(0===r){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class pr{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:pr.RED,this.left=null!=i?i:pr.EMPTY,this.right=null!=r?r:pr.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,n,i,r){return new pr(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return pr.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let n,i=this;if(e(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,e),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===e(t,i.key)){if(i.right.isEmpty())return pr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,e))}return i.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,pr.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,pr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ni();if(this.right.isRed())throw Ni();const t=this.left.check();if(t!==this.right.check())throw Ni();return t+(this.isRed()?0:1)}}pr.EMPTY=null,pr.RED=!0,pr.BLACK=!1,pr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ni()}get value(){throw Ni()}get color(){throw Ni()}get left(){throw Ni()}get right(){throw Ni()}copy(t,e,n,i,r){return this}insert(t,e,n){return new pr(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class gr{constructor(t){this.comparator=t,this.data=new dr(this.comparator)}has(t){return null!==this.data.get(t)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,n)=>(t(e),!1)))}forEachInRange(t,e){const n=this.data.getIteratorFrom(t[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,t[1])>=0)return;e(i.key)}}forEachWhile(t,e){let n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new mr(this.data.getIterator())}getIteratorFrom(t){return new mr(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((t=>{e=e.add(t)})),e}isEqual(t){if(!(t instanceof gr))return!1;if(this.size!==t.size)return!1;const e=this.data.getIterator(),n=t.data.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(0!==this.comparator(t,i))return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new gr(this.comparator);return e.data=t,e}}class mr{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class yr{constructor(t){this.fields=t,t.sort(Qi.comparator)}static empty(){return new yr([])}unionWith(t){let e=new gr(Qi.comparator);for(const n of this.fields)e=e.add(n);for(const n of t)e=e.add(n);return new yr(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return zi(this.fields,t.fields,((t,e)=>t.isEqual(e)))}}class vr{constructor(t){this.binaryString=t}static fromBase64String(t){const e=atob(t);return new vr(e)}static fromUint8Array(t){const e=function(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t);return new vr(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return t=this.binaryString,btoa(t);var t}toUint8Array(){return function(t){const e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return $i(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}vr.EMPTY_BYTE_STRING=new vr("");const _r=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function wr(t){if(Ai(!!t),"string"==typeof t){let e=0;const n=_r.exec(t);if(Ai(!!n),n[1]){let t=n[1];t=(t+"000000000").substr(0,9),e=Number(t)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:br(t.seconds),nanos:br(t.nanos)}}function br(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Er(t){return"string"==typeof t?vr.fromBase64String(t):vr.fromUint8Array(t)}function Cr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Tr(t){const e=t.mapValue.fields.__previous_value__;return Cr(e)?Tr(e):e}function Ir(t){const e=wr(t.mapValue.fields.__local_write_time__.timestampValue);return new Hi(e.seconds,e.nanos)}class Sr{constructor(t,e,n,i,r,s,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=i,this.ssl=r,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class kr{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new kr("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(t){return t instanceof kr&&t.projectId===this.projectId&&t.database===this.database}}function Nr(t){return null==t}function Ar(t){return 0===t&&1/t==-1/0}const xr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Dr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Cr(t)?4:zr(t)?9007199254740991:10:Ni()}function Pr(t,e){if(t===e)return!0;const n=Dr(t);if(n!==Dr(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ir(t).isEqual(Ir(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;const n=wr(t.timestampValue),i=wr(e.timestampValue);return n.seconds===i.seconds&&n.nanos===i.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Er(t.bytesValue).isEqual(Er(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return br(t.geoPointValue.latitude)===br(e.geoPointValue.latitude)&&br(t.geoPointValue.longitude)===br(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return br(t.integerValue)===br(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){const n=br(t.doubleValue),i=br(e.doubleValue);return n===i?Ar(n)===Ar(i):isNaN(n)&&isNaN(i)}return!1}(t,e);case 9:return zi(t.arrayValue.values||[],e.arrayValue.values||[],Pr);case 10:return function(t,e){const n=t.mapValue.fields||{},i=e.mapValue.fields||{};if(ur(n)!==ur(i))return!1;for(const r in n)if(n.hasOwnProperty(r)&&(void 0===i[r]||!Pr(n[r],i[r])))return!1;return!0}(t,e);default:return Ni()}}function Rr(t,e){return void 0!==(t.values||[]).find((t=>Pr(t,e)))}function Or(t,e){if(t===e)return 0;const n=Dr(t),i=Dr(e);if(n!==i)return $i(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return $i(t.booleanValue,e.booleanValue);case 2:return function(t,e){const n=br(t.integerValue||t.doubleValue),i=br(e.integerValue||e.doubleValue);return n<i?-1:n>i?1:n===i?0:isNaN(n)?isNaN(i)?0:-1:1}(t,e);case 3:return Mr(t.timestampValue,e.timestampValue);case 4:return Mr(Ir(t),Ir(e));case 5:return $i(t.stringValue,e.stringValue);case 6:return function(t,e){const n=Er(t),i=Er(e);return n.compareTo(i)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){const n=t.split("/"),i=e.split("/");for(let r=0;r<n.length&&r<i.length;r++){const t=$i(n[r],i[r]);if(0!==t)return t}return $i(n.length,i.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){const n=$i(br(t.latitude),br(e.latitude));return 0!==n?n:$i(br(t.longitude),br(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){const n=t.values||[],i=e.values||[];for(let r=0;r<n.length&&r<i.length;++r){const t=Or(n[r],i[r]);if(t)return t}return $i(n.length,i.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){if(t===xr.mapValue&&e===xr.mapValue)return 0;if(t===xr.mapValue)return 1;if(e===xr.mapValue)return-1;const n=t.fields||{},i=Object.keys(n),r=e.fields||{},s=Object.keys(r);i.sort(),s.sort();for(let o=0;o<i.length&&o<s.length;++o){const t=$i(i[o],s[o]);if(0!==t)return t;const e=Or(n[i[o]],r[s[o]]);if(0!==e)return e}return $i(i.length,s.length)}(t.mapValue,e.mapValue);default:throw Ni()}}function Mr(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return $i(t,e);const n=wr(t),i=wr(e),r=$i(n.seconds,i.seconds);return 0!==r?r:$i(n.nanos,i.nanos)}function Lr(t){return Fr(t)}function Fr(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){const e=wr(t);return`time(${e.seconds},${e.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Er(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Xi.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(t){let e="[",n=!0;for(const i of t.values||[])n?n=!1:e+=",",e+=Fr(i);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){const e=Object.keys(t.fields||{}).sort();let n="{",i=!0;for(const r of e)i?i=!1:n+=",",n+=`${r}:${Fr(t.fields[r])}`;return n+"}"}(t.mapValue):Ni();var e,n}function jr(t){return!!t&&"integerValue"in t}function Vr(t){return!!t&&"arrayValue"in t}function Ur(t){return!!t&&"nullValue"in t}function qr(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Br(t){return!!t&&"mapValue"in t}function $r(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return lr(t.mapValue.fields,((t,n)=>e.mapValue.fields[t]=$r(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=$r(t.arrayValue.values[n]);return e}return Object.assign({},t)}function zr(t){return"__max__"===(((t.mapValue||{}).fields||{}).__type__||{}).stringValue}class Hr{constructor(t){this.value=t}static empty(){return new Hr({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let n=0;n<t.length-1;++n)if(e=(e.mapValue.fields||{})[t.get(n)],!Br(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=$r(e)}setAll(t){let e=Qi.emptyPath(),n={},i=[];t.forEach(((t,r)=>{if(!e.isImmediateParentOf(r)){const t=this.getFieldsMap(e);this.applyChanges(t,n,i),n={},i=[],e=r.popLast()}t?n[r.lastSegment()]=$r(t):i.push(r.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,n,i)}delete(t){const e=this.field(t.popLast());Br(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Pr(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let n=0;n<t.length;++n){let i=e.mapValue.fields[t.get(n)];Br(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=i),e=i}return e.mapValue.fields}applyChanges(t,e,n){lr(e,((e,n)=>t[e]=n));for(const i of n)delete t[i]}clone(){return new Hr($r(this.value))}}class Kr{constructor(t,e,n,i,r,s){this.key=t,this.documentType=e,this.version=n,this.readTime=i,this.data=r,this.documentState=s}static newInvalidDocument(t){return new Kr(t,0,Ki.min(),Ki.min(),Hr.empty(),0)}static newFoundDocument(t,e,n){return new Kr(t,1,e,Ki.min(),n,0)}static newNoDocument(t,e){return new Kr(t,2,e,Ki.min(),Hr.empty(),0)}static newUnknownDocument(t,e){return new Kr(t,3,e,Ki.min(),Hr.empty(),2)}convertToFoundDocument(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Hr.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Hr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ki.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(t){return t instanceof Kr&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new Kr(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Wr{constructor(t,e=null,n=[],i=[],r=null,s=null,o=null){this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=i,this.limit=r,this.startAt=s,this.endAt=o,this.ut=null}}function Gr(t,e=null,n=[],i=[],r=null,s=null,o=null){return new Wr(t,e,n,i,r,s,o)}function Yr(t){const e=xi(t);if(null===e.ut){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((t=>{return(e=t).field.canonicalString()+e.op.toString()+Lr(e.value);var e})).join(","),t+="|ob:",t+=e.orderBy.map((t=>function(t){return t.field.canonicalString()+t.dir}(t))).join(","),Nr(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((t=>Lr(t))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((t=>Lr(t))).join(",")),e.ut=t}return e.ut}function Qr(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!us(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],i=e.filters[r],n.op!==i.op||!n.field.isEqual(i.field)||!Pr(n.value,i.value))return!1;var n,i;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!hs(t.startAt,e.startAt)&&hs(t.endAt,e.endAt)}function Xr(t){return Xi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}class Jr extends class{}{constructor(t,e,n){super(),this.field=t,this.op=e,this.value=n}static create(t,e,n){return t.isKeyField()?"in"===e||"not-in"===e?this.ct(t,e,n):new Zr(t,e,n):"array-contains"===e?new is(t,n):"in"===e?new rs(t,n):"not-in"===e?new ss(t,n):"array-contains-any"===e?new os(t,n):new Jr(t,e,n)}static ct(t,e,n){return"in"===e?new ts(t,n):new es(t,n)}matches(t){const e=t.data.field(this.field);return"!="===this.op?null!==e&&this.at(Or(e,this.value)):null!==e&&Dr(this.value)===Dr(e)&&this.at(Or(e,this.value))}at(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Ni()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Zr extends Jr{constructor(t,e,n){super(t,e,n),this.key=Xi.fromName(n.referenceValue)}matches(t){const e=Xi.comparator(t.key,this.key);return this.at(e)}}class ts extends Jr{constructor(t,e){super(t,"in",e),this.keys=ns("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class es extends Jr{constructor(t,e){super(t,"not-in",e),this.keys=ns("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function ns(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((t=>Xi.fromName(t.referenceValue)))}class is extends Jr{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Vr(e)&&Rr(e.arrayValue,this.value)}}class rs extends Jr{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return null!==e&&Rr(this.value.arrayValue,e)}}class ss extends Jr{constructor(t,e){super(t,"not-in",e)}matches(t){if(Rr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return null!==e&&!Rr(this.value.arrayValue,e)}}class os extends Jr{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Vr(e)||!e.arrayValue.values)&&e.arrayValue.values.some((t=>Rr(this.value.arrayValue,t)))}}class as{constructor(t,e){this.position=t,this.inclusive=e}}class cs{constructor(t,e="asc"){this.field=t,this.dir=e}}function us(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function ls(t,e,n){let i=0;for(let r=0;r<t.position.length;r++){const s=e[r],o=t.position[r];if(i=s.field.isKeyField()?Xi.comparator(Xi.fromName(o.referenceValue),n.key):Or(o,n.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function hs(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Pr(t.position[n],e.position[n]))return!1;return!0}class ds{constructor(t,e=null,n=[],i=[],r=null,s="F",o=null,a=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=i,this.limit=r,this.limitType=s,this.startAt=o,this.endAt=a,this.lt=null,this.ft=null,this.startAt,this.endAt}}function fs(t,e,n,i,r,s,o,a){return new ds(t,e,n,i,r,s,o,a)}function ps(t){return new ds(t)}function gs(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function ms(t){for(const e of t.filters)if(e.ht())return e.field;return null}function ys(t){return null!==t.collectionGroup}function vs(t){const e=xi(t);if(null===e.lt){e.lt=[];const t=ms(e),n=gs(e);if(null!==t&&null===n)t.isKeyField()||e.lt.push(new cs(t)),e.lt.push(new cs(Qi.keyField(),"asc"));else{let t=!1;for(const n of e.explicitOrderBy)e.lt.push(n),n.field.isKeyField()&&(t=!0);if(!t){const t=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new cs(Qi.keyField(),t))}}}return e.lt}function _s(t){const e=xi(t);if(!e.ft)if("F"===e.limitType)e.ft=Gr(e.path,e.collectionGroup,vs(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const r of vs(e)){const e="desc"===r.dir?"asc":"desc";t.push(new cs(r.field,e))}const n=e.endAt?new as(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new as(e.startAt.position,e.startAt.inclusive):null;e.ft=Gr(e.path,e.collectionGroup,t,e.filters,e.limit,n,i)}return e.ft}function ws(t,e,n){return new ds(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function bs(t,e){return Qr(_s(t),_s(e))&&t.limitType===e.limitType}function Es(t){return`${Yr(_s(t))}|lt:${t.limitType}`}function Cs(t){return`Query(target=${function(t){let e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map((t=>{return`${(e=t).field.canonicalString()} ${e.op} ${Lr(e.value)}`;var e})).join(", ")}]`),Nr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map((t=>function(t){return`${t.field.canonicalString()} (${t.dir})`}(t))).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((t=>Lr(t))).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((t=>Lr(t))).join(",")),`Target(${e})`}(_s(t))}; limitType=${t.limitType})`}function Ts(t,e){return e.isFoundDocument()&&function(t,e){const n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Xi.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(const n of t.explicitOrderBy)if(!n.field.isKeyField()&&null===e.data.field(n.field))return!1;return!0}(t,e)&&function(t,e){for(const n of t.filters)if(!n.matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!function(t,e,n){const i=ls(t,e,n);return t.inclusive?i<=0:i<0}(t.startAt,vs(t),e))&&!(t.endAt&&!function(t,e,n){const i=ls(t,e,n);return t.inclusive?i>=0:i>0}(t.endAt,vs(t),e))}(t,e)}function Is(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Ss(t){return(e,n)=>{let i=!1;for(const r of vs(t)){const t=ks(r,e,n);if(0!==t)return t;i=i||r.field.isKeyField()}return 0}}function ks(t,e,n){const i=t.field.isKeyField()?Xi.comparator(e.key,n.key):function(t,e,n){const i=e.data.field(t),r=n.data.field(t);return null!==i&&null!==r?Or(i,r):Ni()}(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Ni()}}function Ns(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ar(e)?"-0":e}}function As(t){return{integerValue:""+t}}class xs{constructor(){this._=void 0}}function Ds(t,e,n){return t instanceof Os?function(t,e){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof Ms?Ls(t,e):t instanceof Fs?js(t,e):function(t,e){const n=Rs(t,e),i=Us(n)+Us(t._t);return jr(n)&&jr(t._t)?As(i):Ns(t.wt,i)}(t,e)}function Ps(t,e,n){return t instanceof Ms?Ls(t,e):t instanceof Fs?js(t,e):n}function Rs(t,e){return t instanceof Vs?jr(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}class Os extends xs{}class Ms extends xs{constructor(t){super(),this.elements=t}}function Ls(t,e){const n=qs(e);for(const i of t.elements)n.some((t=>Pr(t,i)))||n.push(i);return{arrayValue:{values:n}}}class Fs extends xs{constructor(t){super(),this.elements=t}}function js(t,e){let n=qs(e);for(const i of t.elements)n=n.filter((t=>!Pr(t,i)));return{arrayValue:{values:n}}}class Vs extends xs{constructor(t,e){super(),this.wt=t,this._t=e}}function Us(t){return br(t.integerValue||t.doubleValue)}function qs(t){return Vr(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class Bs{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new Bs}static exists(t){return new Bs(void 0,t)}static updateTime(t){return new Bs(t)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function $s(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}class zs{}function Hs(t,e){if(!t.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return t.isNoDocument()?new to(t.key,Bs.none()):new Ys(t.key,t.data,Bs.none());{const n=t.data,i=Hr.empty();let r=new gr(Qi.comparator);for(let t of e.fields)if(!r.has(t)){let e=n.field(t);null===e&&t.length>1&&(t=t.popLast(),e=n.field(t)),null===e?i.delete(t):i.set(t,e),r=r.add(t)}return new Qs(t.key,i,new yr(r.toArray()),Bs.none())}}function Ks(t,e,n){t instanceof Ys?function(t,e,n){const i=t.value.clone(),r=Js(t.fieldTransforms,e,n.transformResults);i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(t,e,n):t instanceof Qs?function(t,e,n){if(!$s(t.precondition,e))return void e.convertToUnknownDocument(n.version);const i=Js(t.fieldTransforms,e,n.transformResults),r=e.data;r.setAll(Xs(t)),r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Ws(t,e,n,i){return t instanceof Ys?function(t,e,n,i){if(!$s(t.precondition,e))return n;const r=t.value.clone(),s=Zs(t.fieldTransforms,i,e);return r.setAll(s),e.convertToFoundDocument(e.version,r).setHasLocalMutations(),null}(t,e,n,i):t instanceof Qs?function(t,e,n,i){if(!$s(t.precondition,e))return n;const r=Zs(t.fieldTransforms,i,e),s=e.data;return s.setAll(Xs(t)),s.setAll(r),e.convertToFoundDocument(e.version,s).setHasLocalMutations(),null===n?null:n.unionWith(t.fieldMask.fields).unionWith(t.fieldTransforms.map((t=>t.field)))}(t,e,n,i):function(t,e,n){return $s(t.precondition,e)?(e.convertToNoDocument(e.version).setHasLocalMutations(),null):n}(t,e,n)}function Gs(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&zi(t,e,((t,e)=>function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof Ms&&e instanceof Ms||t instanceof Fs&&e instanceof Fs?zi(t.elements,e.elements,Pr):t instanceof Vs&&e instanceof Vs?Pr(t._t,e._t):t instanceof Os&&e instanceof Os}(t.transform,e.transform)}(t,e)))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ys extends zs{constructor(t,e,n,i=[]){super(),this.key=t,this.value=e,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Qs extends zs{constructor(t,e,n,i,r=[]){super(),this.key=t,this.data=e,this.fieldMask=n,this.precondition=i,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Xs(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function Js(t,e,n){const i=new Map;Ai(t.length===n.length);for(let r=0;r<n.length;r++){const s=t[r],o=s.transform,a=e.data.field(s.field);i.set(s.field,Ps(o,a,n[r]))}return i}function Zs(t,e,n){const i=new Map;for(const r of t){const t=r.transform,s=n.data.field(r.field);i.set(r.field,Ds(t,s,e))}return i}class to extends zs{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class eo{constructor(t){this.count=t}}var no,io;function ro(t){if(void 0===t)return Ii("GRPC error has no .code"),Di.UNKNOWN;switch(t){case no.OK:return Di.OK;case no.CANCELLED:return Di.CANCELLED;case no.UNKNOWN:return Di.UNKNOWN;case no.DEADLINE_EXCEEDED:return Di.DEADLINE_EXCEEDED;case no.RESOURCE_EXHAUSTED:return Di.RESOURCE_EXHAUSTED;case no.INTERNAL:return Di.INTERNAL;case no.UNAVAILABLE:return Di.UNAVAILABLE;case no.UNAUTHENTICATED:return Di.UNAUTHENTICATED;case no.INVALID_ARGUMENT:return Di.INVALID_ARGUMENT;case no.NOT_FOUND:return Di.NOT_FOUND;case no.ALREADY_EXISTS:return Di.ALREADY_EXISTS;case no.PERMISSION_DENIED:return Di.PERMISSION_DENIED;case no.FAILED_PRECONDITION:return Di.FAILED_PRECONDITION;case no.ABORTED:return Di.ABORTED;case no.OUT_OF_RANGE:return Di.OUT_OF_RANGE;case no.UNIMPLEMENTED:return Di.UNIMPLEMENTED;case no.DATA_LOSS:return Di.DATA_LOSS;default:return Ni()}}(io=no||(no={}))[io.OK=0]="OK",io[io.CANCELLED=1]="CANCELLED",io[io.UNKNOWN=2]="UNKNOWN",io[io.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",io[io.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",io[io.NOT_FOUND=5]="NOT_FOUND",io[io.ALREADY_EXISTS=6]="ALREADY_EXISTS",io[io.PERMISSION_DENIED=7]="PERMISSION_DENIED",io[io.UNAUTHENTICATED=16]="UNAUTHENTICATED",io[io.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",io[io.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",io[io.ABORTED=10]="ABORTED",io[io.OUT_OF_RANGE=11]="OUT_OF_RANGE",io[io.UNIMPLEMENTED=12]="UNIMPLEMENTED",io[io.INTERNAL=13]="INTERNAL",io[io.UNAVAILABLE=14]="UNAVAILABLE",io[io.DATA_LOSS=15]="DATA_LOSS";class so{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(const[i,r]of n)if(this.equalsFn(i,t))return r}has(t){return void 0!==this.get(t)}set(t,e){const n=this.mapKeyFn(t),i=this.inner[n];if(void 0===i)return this.inner[n]=[[t,e]],void this.innerSize++;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return void(i[r]=[t,e]);i.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],t))return 1===n.length?delete this.inner[e]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(t){lr(this.inner,((e,n)=>{for(const[i,r]of n)t(i,r)}))}isEmpty(){return hr(this.inner)}size(){return this.innerSize}}const oo=new dr(Xi.comparator);function ao(){return oo}const co=new dr(Xi.comparator);function uo(...t){let e=co;for(const n of t)e=e.insert(n.key,n);return e}function lo(t){let e=co;return t.forEach(((t,n)=>e=e.insert(t,n.overlayedDocument))),e}function ho(){return po()}function fo(){return po()}function po(){return new so((t=>t.toString()),((t,e)=>t.isEqual(e)))}new dr(Xi.comparator);const go=new gr(Xi.comparator);function mo(...t){let e=go;for(const n of t)e=e.add(n);return e}const yo=new gr($i);function vo(){return yo}class _o{constructor(t,e,n,i,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e){const n=new Map;return n.set(t,wo.createSynthesizedTargetChangeForCurrentChange(t,e)),new _o(Ki.min(),n,vo(),ao(),mo())}}class wo{constructor(t,e,n,i,r){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e){return new wo(vr.EMPTY_BYTE_STRING,e,mo(),mo(),mo())}}class bo{constructor(t,e,n,i){this.gt=t,this.removedTargetIds=e,this.key=n,this.yt=i}}class Eo{constructor(t,e){this.targetId=t,this.It=e}}class Co{constructor(t,e,n=vr.EMPTY_BYTE_STRING,i=null){this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=i}}class To{constructor(){this.Tt=0,this.Et=ko(),this.At=vr.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return 0!==this.Tt}get vt(){return this.bt}Vt(t){t.approximateByteSize()>0&&(this.bt=!0,this.At=t)}St(){let t=mo(),e=mo(),n=mo();return this.Et.forEach(((i,r)=>{switch(r){case 0:t=t.add(i);break;case 2:e=e.add(i);break;case 1:n=n.add(i);break;default:Ni()}})),new wo(this.At,this.Rt,t,e,n)}Dt(){this.bt=!1,this.Et=ko()}Ct(t,e){this.bt=!0,this.Et=this.Et.insert(t,e)}xt(t){this.bt=!0,this.Et=this.Et.remove(t)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class Io{constructor(t){this.Mt=t,this.Ft=new Map,this.$t=ao(),this.Bt=So(),this.Lt=new gr($i)}Ut(t){for(const e of t.gt)t.yt&&t.yt.isFoundDocument()?this.qt(e,t.yt):this.Kt(e,t.key,t.yt);for(const e of t.removedTargetIds)this.Kt(e,t.key,t.yt)}Gt(t){this.forEachTarget(t,(e=>{const n=this.Qt(e);switch(t.state){case 0:this.jt(e)&&n.Vt(t.resumeToken);break;case 1:n.kt(),n.Pt||n.Dt(),n.Vt(t.resumeToken);break;case 2:n.kt(),n.Pt||this.removeTarget(e);break;case 3:this.jt(e)&&(n.Ot(),n.Vt(t.resumeToken));break;case 4:this.jt(e)&&(this.Wt(e),n.Vt(t.resumeToken));break;default:Ni()}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Ft.forEach(((t,n)=>{this.jt(n)&&e(n)}))}zt(t){const e=t.targetId,n=t.It.count,i=this.Ht(e);if(i){const t=i.target;if(Xr(t))if(0===n){const n=new Xi(t.path);this.Kt(e,n,Kr.newNoDocument(n,Ki.min()))}else Ai(1===n);else this.Jt(e)!==n&&(this.Wt(e),this.Lt=this.Lt.add(e))}}Yt(t){const e=new Map;this.Ft.forEach(((n,i)=>{const r=this.Ht(i);if(r){if(n.current&&Xr(r.target)){const e=new Xi(r.target.path);null!==this.$t.get(e)||this.Xt(i,e)||this.Kt(i,e,Kr.newNoDocument(e,t))}n.vt&&(e.set(i,n.St()),n.Dt())}}));let n=mo();this.Bt.forEach(((t,e)=>{let i=!0;e.forEachWhile((t=>{const e=this.Ht(t);return!e||2===e.purpose||(i=!1,!1)})),i&&(n=n.add(t))})),this.$t.forEach(((e,n)=>n.setReadTime(t)));const i=new _o(t,e,this.Lt,this.$t,n);return this.$t=ao(),this.Bt=So(),this.Lt=new gr($i),i}qt(t,e){if(!this.jt(t))return;const n=this.Xt(t,e.key)?2:0;this.Qt(t).Ct(e.key,n),this.$t=this.$t.insert(e.key,e),this.Bt=this.Bt.insert(e.key,this.Zt(e.key).add(t))}Kt(t,e,n){if(!this.jt(t))return;const i=this.Qt(t);this.Xt(t,e)?i.Ct(e,1):i.xt(e),this.Bt=this.Bt.insert(e,this.Zt(e).delete(t)),n&&(this.$t=this.$t.insert(e,n))}removeTarget(t){this.Ft.delete(t)}Jt(t){const e=this.Qt(t).St();return this.Mt.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Nt(t){this.Qt(t).Nt()}Qt(t){let e=this.Ft.get(t);return e||(e=new To,this.Ft.set(t,e)),e}Zt(t){let e=this.Bt.get(t);return e||(e=new gr($i),this.Bt=this.Bt.insert(t,e)),e}jt(t){const e=null!==this.Ht(t);return e||Ti("WatchChangeAggregator","Detected inactive target",t),e}Ht(t){const e=this.Ft.get(t);return e&&e.Pt?null:this.Mt.te(t)}Wt(t){this.Ft.set(t,new To),this.Mt.getRemoteKeysForTarget(t).forEach((e=>{this.Kt(t,e,null)}))}Xt(t,e){return this.Mt.getRemoteKeysForTarget(t).has(e)}}function So(){return new dr(Xi.comparator)}function ko(){return new dr(Xi.comparator)}const No={asc:"ASCENDING",desc:"DESCENDING"},Ao={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class xo{constructor(t,e){this.databaseId=t,this.dt=e}}function Do(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Po(t,e){return t.dt?e.toBase64():e.toUint8Array()}function Ro(t){return Ai(!!t),Ki.fromTimestamp(function(t){const e=wr(t);return new Hi(e.seconds,e.nanos)}(t))}function Oo(t,e){return function(t){return new Gi(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Mo(t){const e=Gi.fromString(t);return Ai(Xo(e)),e}function Lo(t,e){const n=Mo(e);if(n.get(1)!==t.databaseId.projectId)throw new Pi(Di.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Pi(Di.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Xi(Uo(n))}function Fo(t,e){return Oo(t.databaseId,e)}function jo(t){const e=Mo(t);return 4===e.length?Gi.emptyPath():Uo(e)}function Vo(t){return new Gi(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Uo(t){return Ai(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function qo(t,e){return{documents:[Fo(t,e.path)]}}function Bo(t,e){const n={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(n.parent=Fo(t,i),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Fo(t,i.popLast()),n.structuredQuery.from=[{collectionId:i.lastSegment()}]);const r=function(t){if(0===t.length)return;const e=t.map((t=>function(t){if("=="===t.op){if(qr(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NAN"}};if(Ur(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(qr(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NOT_NAN"}};if(Ur(t.value))return{unaryFilter:{field:Wo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wo(t.field),op:Ko(t.op),value:t.value}}}(t)));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}(e.filters);r&&(n.structuredQuery.where=r);const s=function(t){if(0!==t.length)return t.map((t=>function(t){return{field:Wo(t.field),direction:Ho(t.dir)}}(t)))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(t,e){return t.dt||Nr(e)?e:{value:e}}(t,e.limit);var a;return null!==o&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(t){return{before:!t.inclusive,values:t.position}}(e.endAt)),n}function $o(t){let e=jo(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let r=null;if(i>0){Ai(1===i);const t=n.from[0];t.allDescendants?r=t.collectionId:e=e.child(t.collectionId)}let s=[];n.where&&(s=zo(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((t=>function(t){return new cs(Go(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t))));let a=null;n.limit&&(a=function(t){let e;return e="object"==typeof t?t.value:t,Nr(e)?null:e}(n.limit));let c=null;n.startAt&&(c=function(t){const e=!!t.before,n=t.values||[];return new as(n,e)}(n.startAt));let u=null;return n.endAt&&(u=function(t){const e=!t.before,n=t.values||[];return new as(n,e)}(n.endAt)),fs(e,r,o,s,a,"F",c,u)}function zo(t){return t?void 0!==t.unaryFilter?[Qo(t)]:void 0!==t.fieldFilter?[Yo(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((t=>zo(t))).reduce(((t,e)=>t.concat(e))):Ni():[]}function Ho(t){return No[t]}function Ko(t){return Ao[t]}function Wo(t){return{fieldPath:t.canonicalString()}}function Go(t){return Qi.fromServerFormat(t.fieldPath)}function Yo(t){return Jr.create(Go(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ni()}}(t.fieldFilter.op),t.fieldFilter.value)}function Qo(t){switch(t.unaryFilter.op){case"IS_NAN":const e=Go(t.unaryFilter.field);return Jr.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=Go(t.unaryFilter.field);return Jr.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Go(t.unaryFilter.field);return Jr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=Go(t.unaryFilter.field);return Jr.create(r,"!=",{nullValue:"NULL_VALUE"});default:return Ni()}}function Xo(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}const Jo=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Zo=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ta=Zo;class ea{constructor(t,e,n,i){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(t,e){const n=e.mutationResults;for(let i=0;i<this.mutations.length;i++){const e=this.mutations[i];e.key.isEqual(t.key)&&Ks(e,t,n[i])}}applyToLocalView(t,e){for(const n of this.baseMutations)n.key.isEqual(t.key)&&(e=Ws(n,t,e,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(t.key)&&(e=Ws(n,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const n=fo();return this.mutations.forEach((i=>{const r=t.get(i.key),s=r.overlayedDocument;let o=this.applyToLocalView(s,r.mutatedFields);o=e.has(i.key)?null:o;const a=Hs(s,o);null!==a&&n.set(i.key,a),s.isValidDocument()||s.convertToNoDocument(Ki.min())})),n}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),mo())}isEqual(t){return this.batchId===t.batchId&&zi(this.mutations,t.mutations,((t,e)=>Gs(t,e)))&&zi(this.baseMutations,t.baseMutations,((t,e)=>Gs(t,e)))}}class na{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return null!==t&&this.mutation===t.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ia{constructor(t,e,n,i,r=Ki.min(),s=Ki.min(),o=vr.EMPTY_BYTE_STRING){this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(t){return new ia(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(t,e){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)}withLastLimboFreeSnapshotVersion(t){return new ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}class ra{constructor(t){this.ne=t}}function sa(t){const e=$o({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?ws(e,e.limit,"L"):e}class oa{constructor(){}re(t,e){this.oe(t,e),e.ue()}oe(t,e){if("nullValue"in t)this.ce(e,5);else if("booleanValue"in t)this.ce(e,10),e.ae(t.booleanValue?1:0);else if("integerValue"in t)this.ce(e,15),e.ae(br(t.integerValue));else if("doubleValue"in t){const n=br(t.doubleValue);isNaN(n)?this.ce(e,13):(this.ce(e,15),Ar(n)?e.ae(0):e.ae(n))}else if("timestampValue"in t){const n=t.timestampValue;this.ce(e,20),"string"==typeof n?e.he(n):(e.he(`${n.seconds||""}`),e.ae(n.nanos||0))}else if("stringValue"in t)this.le(t.stringValue,e),this.fe(e);else if("bytesValue"in t)this.ce(e,30),e.de(Er(t.bytesValue)),this.fe(e);else if("referenceValue"in t)this._e(t.referenceValue,e);else if("geoPointValue"in t){const n=t.geoPointValue;this.ce(e,45),e.ae(n.latitude||0),e.ae(n.longitude||0)}else"mapValue"in t?zr(t)?this.ce(e,Number.MAX_SAFE_INTEGER):(this.we(t.mapValue,e),this.fe(e)):"arrayValue"in t?(this.me(t.arrayValue,e),this.fe(e)):Ni()}le(t,e){this.ce(e,25),this.ge(t,e)}ge(t,e){e.he(t)}we(t,e){const n=t.fields||{};this.ce(e,55);for(const i of Object.keys(n))this.le(i,e),this.oe(n[i],e)}me(t,e){const n=t.values||[];this.ce(e,50);for(const i of n)this.oe(i,e)}_e(t,e){this.ce(e,37),Xi.fromName(t).path.forEach((t=>{this.ce(e,60),this.ge(t,e)}))}ce(t,e){t.ae(e)}fe(t){t.ae(2)}}oa.ye=new oa;class aa{constructor(){this.ze=new ca}addToCollectionParentIndex(t,e){return this.ze.add(e),or.resolve()}getCollectionParents(t,e){return or.resolve(this.ze.getEntries(e))}addFieldIndex(t,e){return or.resolve()}deleteFieldIndex(t,e){return or.resolve()}getDocumentsMatchingTarget(t,e){return or.resolve(null)}getIndexType(t,e){return or.resolve(0)}getFieldIndexes(t,e){return or.resolve([])}getNextCollectionGroupToUpdate(t){return or.resolve(null)}getMinOffset(t,e){return or.resolve(er.min())}getMinOffsetFromCollectionGroup(t,e){return or.resolve(er.min())}updateCollectionGroup(t,e,n){return or.resolve()}updateIndexEntries(t,e){return or.resolve()}}class ca{constructor(){this.index={}}add(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e]||new gr(Gi.comparator),r=!i.has(n);return this.index[e]=i.add(n),r}has(t){const e=t.lastSegment(),n=t.popLast(),i=this.index[e];return i&&i.has(n)}getEntries(t){return(this.index[t]||new gr(Gi.comparator)).toArray()}}new Uint8Array(0);class ua{constructor(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}static withCacheSize(t){return new ua(t,ua.DEFAULT_COLLECTION_PERCENTILE,ua.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}ua.DEFAULT_COLLECTION_PERCENTILE=10,ua.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ua.DEFAULT=new ua(41943040,ua.DEFAULT_COLLECTION_PERCENTILE,ua.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ua.DISABLED=new ua(-1,0,0);class la{constructor(t){this.En=t}next(){return this.En+=2,this.En}static An(){return new la(0)}static Rn(){return new la(-1)}}class ha{constructor(){this.changes=new so((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,Kr.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const n=this.changes.get(e);return void 0!==n?or.resolve(n):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class da{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class fa{constructor(t,e,n,i){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=n,this.indexManager=i}getDocument(t,e){let n=null;return this.documentOverlayCache.getOverlay(t,e).next((i=>(n=i,this.getBaseDocument(t,e,n)))).next((t=>(null!==n&&Ws(n.mutation,t,yr.empty(),Hi.now()),t)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.getLocalViewOfDocuments(t,e,mo()).next((()=>e))))}getLocalViewOfDocuments(t,e,n=mo()){const i=ho();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,n).next((t=>{let e=uo();return t.forEach(((t,n)=>{e=e.insert(t,n.overlayedDocument)})),e}))))}getOverlayedDocuments(t,e){const n=ho();return this.populateOverlays(t,n,e).next((()=>this.computeViews(t,e,n,mo())))}populateOverlays(t,e,n){const i=[];return n.forEach((t=>{e.has(t)||i.push(t)})),this.documentOverlayCache.getOverlays(t,i).next((t=>{t.forEach(((t,n)=>{e.set(t,n)}))}))}computeViews(t,e,n,i){let r=ao();const s=po(),o=po();return e.forEach(((t,e)=>{const o=n.get(e.key);i.has(e.key)&&(void 0===o||o.mutation instanceof Qs)?r=r.insert(e.key,e):void 0!==o&&(s.set(e.key,o.mutation.getFieldMask()),Ws(o.mutation,e,o.mutation.getFieldMask(),Hi.now()))})),this.recalculateAndSaveOverlays(t,r).next((t=>(t.forEach(((t,e)=>s.set(t,e))),e.forEach(((t,e)=>{var n;return o.set(t,new da(e,null!==(n=s.get(t))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(t,e){const n=po();let i=new dr(((t,e)=>t-e)),r=mo();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((t=>{for(const r of t)r.keys().forEach((t=>{const s=e.get(t);if(null===s)return;let o=n.get(t)||yr.empty();o=r.applyToLocalView(s,o),n.set(t,o);const a=(i.get(r.batchId)||mo()).add(t);i=i.insert(r.batchId,a)}))})).next((()=>{const s=[],o=i.getReverseIterator();for(;o.hasNext();){const i=o.getNext(),a=i.key,c=i.value,u=fo();c.forEach((t=>{if(!r.has(t)){const i=Hs(e.get(t),n.get(t));null!==i&&u.set(t,i),r=r.add(t)}})),s.push(this.documentOverlayCache.saveOverlays(t,a,u))}return or.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((e=>this.recalculateAndSaveOverlays(t,e)))}getDocumentsMatchingQuery(t,e,n){return function(t){return Xi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):ys(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,n):this.getDocumentsMatchingCollectionQuery(t,e,n)}getNextDocuments(t,e,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,n,i).next((r=>{const s=i-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,n.largestBatchId,i-r.size):or.resolve(ho());let o=-1,a=r;return s.next((e=>or.forEach(e,((e,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),r.get(e)?or.resolve():this.getBaseDocument(t,e,n).next((t=>{a=a.insert(e,t)}))))).next((()=>this.populateOverlays(t,e,r))).next((()=>this.computeViews(t,a,e,mo()))).next((t=>({batchId:o,changes:lo(t)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new Xi(e)).next((t=>{let e=uo();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))}getDocumentsMatchingCollectionGroupQuery(t,e,n){const i=e.collectionGroup;let r=uo();return this.indexManager.getCollectionParents(t,i).next((s=>or.forEach(s,(s=>{const o=function(t,e){return new ds(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,s.child(i));return this.getDocumentsMatchingCollectionQuery(t,o,n).next((t=>{t.forEach(((t,e)=>{r=r.insert(t,e)}))}))})).next((()=>r))))}getDocumentsMatchingCollectionQuery(t,e,n){let i;return this.remoteDocumentCache.getAllFromCollection(t,e.path,n).next((r=>(i=r,this.documentOverlayCache.getOverlaysForCollection(t,e.path,n.largestBatchId)))).next((t=>{t.forEach(((t,e)=>{const n=e.getKey();null===i.get(n)&&(i=i.insert(n,Kr.newInvalidDocument(n)))}));let n=uo();return i.forEach(((i,r)=>{const s=t.get(i);void 0!==s&&Ws(s.mutation,r,yr.empty(),Hi.now()),Ts(e,r)&&(n=n.insert(i,r))})),n}))}getBaseDocument(t,e,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(t,e):or.resolve(Kr.newInvalidDocument(e))}}class pa{constructor(t){this.wt=t,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(t,e){return or.resolve(this.Jn.get(e))}saveBundleMetadata(t,e){var n;return this.Jn.set(e.id,{id:(n=e).id,version:n.version,createTime:Ro(n.createTime)}),or.resolve()}getNamedQuery(t,e){return or.resolve(this.Yn.get(e))}saveNamedQuery(t,e){return this.Yn.set(e.name,function(t){return{name:t.name,query:sa(t.bundledQuery),readTime:Ro(t.readTime)}}(e)),or.resolve()}}class ga{constructor(){this.overlays=new dr(Xi.comparator),this.Xn=new Map}getOverlay(t,e){return or.resolve(this.overlays.get(e))}getOverlays(t,e){const n=ho();return or.forEach(e,(e=>this.getOverlay(t,e).next((t=>{null!==t&&n.set(e,t)})))).next((()=>n))}saveOverlays(t,e,n){return n.forEach(((n,i)=>{this.ie(t,e,i)})),or.resolve()}removeOverlaysForBatchId(t,e,n){const i=this.Xn.get(n);return void 0!==i&&(i.forEach((t=>this.overlays=this.overlays.remove(t))),this.Xn.delete(n)),or.resolve()}getOverlaysForCollection(t,e,n){const i=ho(),r=e.length+1,s=new Xi(e.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const t=o.getNext().value,s=t.getKey();if(!e.isPrefixOf(s.path))break;s.path.length===r&&t.largestBatchId>n&&i.set(t.getKey(),t)}return or.resolve(i)}getOverlaysForCollectionGroup(t,e,n,i){let r=new dr(((t,e)=>t-e));const s=this.overlays.getIterator();for(;s.hasNext();){const t=s.getNext().value;if(t.getKey().getCollectionGroup()===e&&t.largestBatchId>n){let e=r.get(t.largestBatchId);null===e&&(e=ho(),r=r.insert(t.largestBatchId,e)),e.set(t.getKey(),t)}}const o=ho(),a=r.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((t,e)=>o.set(t,e))),!(o.size()>=i)););return or.resolve(o)}ie(t,e,n){const i=this.overlays.get(n.key);if(null!==i){const t=this.Xn.get(i.largestBatchId).delete(n.key);this.Xn.set(i.largestBatchId,t)}this.overlays=this.overlays.insert(n.key,new na(e,n));let r=this.Xn.get(e);void 0===r&&(r=mo(),this.Xn.set(e,r)),this.Xn.set(e,r.add(n.key))}}class ma{constructor(){this.Zn=new gr(ya.ts),this.es=new gr(ya.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(t,e){const n=new ya(t,e);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(t,e){t.forEach((t=>this.addReference(t,e)))}removeReference(t,e){this.rs(new ya(t,e))}os(t,e){t.forEach((t=>this.removeReference(t,e)))}us(t){const e=new Xi(new Gi([])),n=new ya(e,t),i=new ya(e,t+1),r=[];return this.es.forEachInRange([n,i],(t=>{this.rs(t),r.push(t.key)})),r}cs(){this.Zn.forEach((t=>this.rs(t)))}rs(t){this.Zn=this.Zn.delete(t),this.es=this.es.delete(t)}hs(t){const e=new Xi(new Gi([])),n=new ya(e,t),i=new ya(e,t+1);let r=mo();return this.es.forEachInRange([n,i],(t=>{r=r.add(t.key)})),r}containsKey(t){const e=new ya(t,0),n=this.Zn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)}}class ya{constructor(t,e){this.key=t,this.ls=e}static ts(t,e){return Xi.comparator(t.key,e.key)||$i(t.ls,e.ls)}static ns(t,e){return $i(t.ls,e.ls)||Xi.comparator(t.key,e.key)}}class va{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.fs=1,this.ds=new gr(ya.ts)}checkEmpty(t){return or.resolve(0===this.mutationQueue.length)}addMutationBatch(t,e,n,i){const r=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new ea(r,e,n,i);this.mutationQueue.push(s);for(const o of i)this.ds=this.ds.add(new ya(o.key,r)),this.indexManager.addToCollectionParentIndex(t,o.key.path.popLast());return or.resolve(s)}lookupMutationBatch(t,e){return or.resolve(this._s(e))}getNextMutationBatchAfterBatchId(t,e){const n=e+1,i=this.ws(n),r=i<0?0:i;return or.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return or.resolve(0===this.mutationQueue.length?-1:this.fs-1)}getAllMutationBatches(t){return or.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const n=new ya(e,0),i=new ya(e,Number.POSITIVE_INFINITY),r=[];return this.ds.forEachInRange([n,i],(t=>{const e=this._s(t.ls);r.push(e)})),or.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let n=new gr($i);return e.forEach((t=>{const e=new ya(t,0),i=new ya(t,Number.POSITIVE_INFINITY);this.ds.forEachInRange([e,i],(t=>{n=n.add(t.ls)}))})),or.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(t,e){const n=e.path,i=n.length+1;let r=n;Xi.isDocumentKey(r)||(r=r.child(""));const s=new ya(new Xi(r),0);let o=new gr($i);return this.ds.forEachWhile((t=>{const e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===i&&(o=o.add(t.ls)),!0)}),s),or.resolve(this.gs(o))}gs(t){const e=[];return t.forEach((t=>{const n=this._s(t);null!==n&&e.push(n)})),e}removeMutationBatch(t,e){Ai(0===this.ys(e.batchId,"removed")),this.mutationQueue.shift();let n=this.ds;return or.forEach(e.mutations,(i=>{const r=new ya(i.key,e.batchId);return n=n.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((()=>{this.ds=n}))}In(t){}containsKey(t,e){const n=new ya(e,0),i=this.ds.firstAfterOrEqual(n);return or.resolve(e.isEqual(i&&i.key))}performConsistencyCheck(t){return this.mutationQueue.length,or.resolve()}ys(t,e){return this.ws(t)}ws(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId}_s(t){const e=this.ws(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class _a{constructor(t){this.ps=t,this.docs=new dr(Xi.comparator),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const n=e.key,i=this.docs.get(n),r=i?i.size:0,s=this.ps(e);return this.docs=this.docs.insert(n,{document:e.mutableCopy(),size:s}),this.size+=s-r,this.indexManager.addToCollectionParentIndex(t,n.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const n=this.docs.get(e);return or.resolve(n?n.document.mutableCopy():Kr.newInvalidDocument(e))}getEntries(t,e){let n=ao();return e.forEach((t=>{const e=this.docs.get(t);n=n.insert(t,e?e.document.mutableCopy():Kr.newInvalidDocument(t))})),or.resolve(n)}getAllFromCollection(t,e,n){let i=ao();const r=new Xi(e.child("")),s=this.docs.getIteratorFrom(r);for(;s.hasNext();){const{key:t,value:{document:r}}=s.getNext();if(!e.isPrefixOf(t.path))break;t.path.length>e.length+1||nr(tr(r),n)<=0||(i=i.insert(r.key,r.mutableCopy()))}return or.resolve(i)}getAllFromCollectionGroup(t,e,n,i){Ni()}Is(t,e){return or.forEach(this.docs,(t=>e(t)))}newChangeBuffer(t){return new wa(this)}getSize(t){return or.resolve(this.size)}}class wa extends ha{constructor(t){super(),this.zn=t}applyChanges(t){const e=[];return this.changes.forEach(((n,i)=>{i.isValidDocument()?e.push(this.zn.addEntry(t,i)):this.zn.removeEntry(n)})),or.waitFor(e)}getFromCache(t,e){return this.zn.getEntry(t,e)}getAllFromCache(t,e){return this.zn.getEntries(t,e)}}class ba{constructor(t){this.persistence=t,this.Ts=new so((t=>Yr(t)),Qr),this.lastRemoteSnapshotVersion=Ki.min(),this.highestTargetId=0,this.Es=0,this.As=new ma,this.targetCount=0,this.Rs=la.An()}forEachTarget(t,e){return this.Ts.forEach(((t,n)=>e(n))),or.resolve()}getLastRemoteSnapshotVersion(t){return or.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return or.resolve(this.Es)}allocateTargetId(t){return this.highestTargetId=this.Rs.next(),or.resolve(this.highestTargetId)}setTargetsMetadata(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Es&&(this.Es=e),or.resolve()}vn(t){this.Ts.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.Rs=new la(e),this.highestTargetId=e),t.sequenceNumber>this.Es&&(this.Es=t.sequenceNumber)}addTargetData(t,e){return this.vn(e),this.targetCount+=1,or.resolve()}updateTargetData(t,e){return this.vn(e),or.resolve()}removeTargetData(t,e){return this.Ts.delete(e.target),this.As.us(e.targetId),this.targetCount-=1,or.resolve()}removeTargets(t,e,n){let i=0;const r=[];return this.Ts.forEach(((s,o)=>{o.sequenceNumber<=e&&null===n.get(o.targetId)&&(this.Ts.delete(s),r.push(this.removeMatchingKeysForTargetId(t,o.targetId)),i++)})),or.waitFor(r).next((()=>i))}getTargetCount(t){return or.resolve(this.targetCount)}getTargetData(t,e){const n=this.Ts.get(e)||null;return or.resolve(n)}addMatchingKeys(t,e,n){return this.As.ss(e,n),or.resolve()}removeMatchingKeys(t,e,n){this.As.os(e,n);const i=this.persistence.referenceDelegate,r=[];return i&&e.forEach((e=>{r.push(i.markPotentiallyOrphaned(t,e))})),or.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this.As.us(e),or.resolve()}getMatchingKeysForTargetId(t,e){const n=this.As.hs(e);return or.resolve(n)}containsKey(t,e){return or.resolve(this.As.containsKey(e))}}class Ea{constructor(t,e){this.bs={},this.overlays={},this.Ps=new cr(0),this.vs=!1,this.vs=!0,this.referenceDelegate=t(this),this.Vs=new ba(this),this.indexManager=new aa,this.remoteDocumentCache=function(t){return new _a(t)}((t=>this.referenceDelegate.Ss(t))),this.wt=new ra(e),this.Ds=new pa(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new ga,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let n=this.bs[t.toKey()];return n||(n=new va(e,this.referenceDelegate),this.bs[t.toKey()]=n),n}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(t,e,n){Ti("MemoryPersistence","Starting transaction:",t);const i=new Ca(this.Ps.next());return this.referenceDelegate.Cs(),n(i).next((t=>this.referenceDelegate.xs(i).next((()=>t)))).toPromise().then((t=>(i.raiseOnCommittedEvent(),t)))}Ns(t,e){return or.or(Object.values(this.bs).map((n=>()=>n.containsKey(t,e))))}}class Ca extends rr{constructor(t){super(),this.currentSequenceNumber=t}}class Ta{constructor(t){this.persistence=t,this.ks=new ma,this.Os=null}static Ms(t){return new Ta(t)}get Fs(){if(this.Os)return this.Os;throw Ni()}addReference(t,e,n){return this.ks.addReference(n,e),this.Fs.delete(n.toString()),or.resolve()}removeReference(t,e,n){return this.ks.removeReference(n,e),this.Fs.add(n.toString()),or.resolve()}markPotentiallyOrphaned(t,e){return this.Fs.add(e.toString()),or.resolve()}removeTarget(t,e){this.ks.us(e.targetId).forEach((t=>this.Fs.add(t.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(t,e.targetId).next((t=>{t.forEach((t=>this.Fs.add(t.toString())))})).next((()=>n.removeTargetData(t,e)))}Cs(){this.Os=new Set}xs(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return or.forEach(this.Fs,(n=>{const i=Xi.fromPath(n);return this.$s(t,i).next((t=>{t||e.removeEntry(i,Ki.min())}))})).next((()=>(this.Os=null,e.apply(t))))}updateLimboDocument(t,e){return this.$s(t,e).next((t=>{t?this.Fs.delete(e.toString()):this.Fs.add(e.toString())}))}Ss(t){return 0}$s(t,e){return or.or([()=>or.resolve(this.ks.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ns(t,e)])}}class Ia{constructor(t,e,n,i){this.targetId=t,this.fromCache=e,this.Pi=n,this.vi=i}static Vi(t,e){let n=mo(),i=mo();for(const r of e.docChanges)switch(r.type){case 0:n=n.add(r.doc.key);break;case 1:i=i.add(r.doc.key)}return new Ia(t,e.fromCache,n,i)}}class Sa{constructor(){this.Si=!1}initialize(t,e){this.Di=t,this.indexManager=e,this.Si=!0}getDocumentsMatchingQuery(t,e,n,i){return this.Ci(t,e).next((r=>r||this.xi(t,e,i,n))).next((n=>n||this.Ni(t,e)))}Ci(t,e){return or.resolve(null)}xi(t,e,n,i){return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||i.isEqual(Ki.min())?this.Ni(t,e):this.Di.getDocuments(t,n).next((r=>{const s=this.ki(e,r);return this.Oi(e,s,n,i)?this.Ni(t,e):(Ci()<=o.in.DEBUG&&Ti("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Cs(e)),this.Mi(t,s,e,Zi(i,-1)))}))}ki(t,e){let n=new gr(Ss(t));return e.forEach(((e,i)=>{Ts(t,i)&&(n=n.add(i))})),n}Oi(t,e,n,i){if(null===t.limit)return!1;if(n.size!==e.size)return!0;const r="F"===t.limitType?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(i)>0)}Ni(t,e){return Ci()<=o.in.DEBUG&&Ti("QueryEngine","Using full collection scan to execute query:",Cs(e)),this.Di.getDocumentsMatchingQuery(t,e,er.min())}Mi(t,e,n,i){return this.Di.getDocumentsMatchingQuery(t,n,i).next((t=>(e.forEach((e=>{t=t.insert(e.key,e)})),t)))}}class ka{constructor(t,e,n,i){this.persistence=t,this.Fi=e,this.wt=i,this.$i=new dr($i),this.Bi=new so((t=>Yr(t)),Qr),this.Li=new Map,this.Ui=t.getRemoteDocumentCache(),this.Vs=t.getTargetCache(),this.Ds=t.getBundleCache(),this.qi(n)}qi(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new fa(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.$i)))}}function Na(t,e,n,i){return new ka(t,e,n,i)}async function Aa(t,e){const n=xi(t);return await n.persistence.runTransaction("Handle user change","readonly",(t=>{let i;return n.mutationQueue.getAllMutationBatches(t).next((r=>(i=r,n.qi(e),n.mutationQueue.getAllMutationBatches(t)))).next((e=>{const r=[],s=[];let o=mo();for(const t of i){r.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}for(const t of e){s.push(t.batchId);for(const e of t.mutations)o=o.add(e.key)}return n.localDocuments.getDocuments(t,o).next((t=>({Ki:t,removedBatchIds:r,addedBatchIds:s})))}))}))}function xa(t){const e=xi(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Vs.getLastRemoteSnapshotVersion(t)))}function Da(t,e,n){let i=mo(),r=mo();return n.forEach((t=>i=i.add(t))),e.getEntries(t,i).next((t=>{let i=ao();return n.forEach(((n,s)=>{const o=t.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(r=r.add(n)),s.isNoDocument()&&s.version.isEqual(Ki.min())?(e.removeEntry(n,s.readTime),i=i.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(e.addEntry(s),i=i.insert(n,s)):Ti("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{Gi:i,Qi:r}}))}function Pa(t,e){const n=xi(t);return n.persistence.runTransaction("Allocate target","readwrite",(t=>{let i;return n.Vs.getTargetData(t,e).next((r=>r?(i=r,or.resolve(i)):n.Vs.allocateTargetId(t).next((r=>(i=new ia(e,r,0,t.currentSequenceNumber),n.Vs.addTargetData(t,i).next((()=>i)))))))})).then((t=>{const i=n.$i.get(t.targetId);return(null===i||t.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.$i=n.$i.insert(t.targetId,t),n.Bi.set(e,t.targetId)),t}))}async function Ra(t,e,n){const i=xi(t),r=i.$i.get(e),s=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",s,(t=>i.persistence.referenceDelegate.removeTarget(t,r)))}catch(t){if(!ar(t))throw t;Ti("LocalStore",`Failed to update sequence numbers for target ${e}: ${t}`)}i.$i=i.$i.remove(e),i.Bi.delete(r.target)}function Oa(t,e,n){const i=xi(t);let r=Ki.min(),s=mo();return i.persistence.runTransaction("Execute query","readonly",(t=>function(t,e,n){const i=xi(t),r=i.Bi.get(n);return void 0!==r?or.resolve(i.$i.get(r)):i.Vs.getTargetData(e,n)}(i,t,_s(e)).next((e=>{if(e)return r=e.lastLimboFreeSnapshotVersion,i.Vs.getMatchingKeysForTargetId(t,e.targetId).next((t=>{s=t}))})).next((()=>i.Fi.getDocumentsMatchingQuery(t,e,n?r:Ki.min(),n?s:mo()))).next((t=>(Ma(i,Is(e),t),{documents:t,ji:s})))))}function Ma(t,e,n){let i=Ki.min();n.forEach(((t,e)=>{e.readTime.compareTo(i)>0&&(i=e.readTime)})),t.Li.set(e,i)}class La{constructor(){this.activeTargetIds=vo()}Xi(t){this.activeTargetIds=this.activeTargetIds.add(t)}Zi(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Yi(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Fa{constructor(){this.Fr=new La,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,n){}addLocalQueryTarget(t){return this.Fr.Xi(t),this.$r[t]||"not-current"}updateQueryState(t,e,n){this.$r[t]=e}removeLocalQueryTarget(t){this.Fr.Zi(t)}isLocalQueryTarget(t){return this.Fr.activeTargetIds.has(t)}clearQueryState(t){delete this.$r[t]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(t){return this.Fr.activeTargetIds.has(t)}start(){return this.Fr=new La,Promise.resolve()}handleUserChange(t,e,n){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class ja{Br(t){}shutdown(){}}class Va{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(t){this.Gr.push(t)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){Ti("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const t of this.Gr)t(0)}Kr(){Ti("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const t of this.Gr)t(1)}static V(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Ua={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class qa{constructor(t){this.jr=t.jr,this.Wr=t.Wr}zr(t){this.Hr=t}Jr(t){this.Yr=t}onMessage(t){this.Xr=t}close(){this.Wr()}send(t){this.jr(t)}Zr(){this.Hr()}eo(t){this.Yr(t)}no(t){this.Xr(t)}}class Ba extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http";this.so=e+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(t,e,n,i,r){const s=this.oo(t,e);Ti("RestConnection","Sending: ",s,n);const o={};return this.uo(o,i,r),this.co(t,s,o,n).then((t=>(Ti("RestConnection","Received: ",t),t)),(e=>{throw Si("RestConnection",`${t} failed with error: `,e,"url: ",s,"request:",n),e}))}ao(t,e,n,i,r){return this.ro(t,e,n,i,r)}uo(t,e,n){t["X-Goog-Api-Client"]="gl-js/ fire/"+bi,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((e,n)=>t[n]=e)),n&&n.headers.forEach(((e,n)=>t[n]=e))}oo(t,e){const n=Ua[t];return`${this.so}/v1/${e}:${n}`}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams}co(t,e,n,i){return new Promise(((r,s)=>{const o=new vi;o.listenOnce(fi.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case di.NO_ERROR:const e=o.getResponseJson();Ti("Connection","XHR received:",JSON.stringify(e)),r(e);break;case di.TIMEOUT:Ti("Connection",'RPC "'+t+'" timed out'),s(new Pi(Di.DEADLINE_EXCEEDED,"Request time out"));break;case di.HTTP_ERROR:const n=o.getStatus();if(Ti("Connection",'RPC "'+t+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const t=o.getResponseJson().error;if(t&&t.status&&t.message){const e=function(t){const e=t.toLowerCase().replace(/_/g,"-");return Object.values(Di).indexOf(e)>=0?e:Di.UNKNOWN}(t.status);s(new Pi(e,t.message))}else s(new Pi(Di.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Pi(Di.UNAVAILABLE,"Connection failed."));break;default:Ni()}}finally{Ti("Connection",'RPC "'+t+'" completed.')}}));const a=JSON.stringify(i);o.send(e,"POST",a,n,15)}))}ho(t,e,n){const i=[this.so,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=li(),s=hi(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new mi({})),this.uo(o.initMessageHeaders,e,n),(0,a.uI)()||(0,a.b$)()||(0,a.d)()||(0,a.w1)()||(0,a.Mn)()||(0,a.ru)()||(o.httpHeadersOverwriteParam="$httpHeaders");const c=i.join("");Ti("Connection","Creating WebChannel: "+c,o);const u=r.createWebChannel(c,o);let l=!1,h=!1;const d=new qa({jr:t=>{h?Ti("Connection","Not sending because WebChannel is closed:",t):(l||(Ti("Connection","Opening WebChannel transport."),u.open(),l=!0),Ti("Connection","WebChannel sending:",t),u.send(t))},Wr:()=>u.close()}),f=(t,e,n)=>{t.listen(e,(t=>{try{n(t)}catch(t){setTimeout((()=>{throw t}),0)}}))};return f(u,yi.EventType.OPEN,(()=>{h||Ti("Connection","WebChannel transport opened.")})),f(u,yi.EventType.CLOSE,(()=>{h||(h=!0,Ti("Connection","WebChannel transport closed"),d.eo())})),f(u,yi.EventType.ERROR,(t=>{h||(h=!0,Si("Connection","WebChannel transport errored:",t),d.eo(new Pi(Di.UNAVAILABLE,"The operation could not be completed")))})),f(u,yi.EventType.MESSAGE,(t=>{var e;if(!h){const n=t.data[0];Ai(!!n);const i=n,r=i.error||(null===(e=i[0])||void 0===e?void 0:e.error);if(r){Ti("Connection","WebChannel received error:",r);const t=r.status;let e=function(t){const e=no[t];if(void 0!==e)return ro(e)}(t),n=r.message;void 0===e&&(e=Di.INTERNAL,n="Unknown error status: "+t+" with message "+r.message),h=!0,d.eo(new Pi(e,n)),u.close()}else Ti("Connection","WebChannel received:",n),d.no(n)}})),f(s,pi.STAT_EVENT,(t=>{t.stat===gi.PROXY?Ti("Connection","Detected buffering proxy"):t.stat===gi.NOPROXY&&Ti("Connection","Detected no buffering proxy")})),setTimeout((()=>{d.Zr()}),0),d}}function $a(){return"undefined"!=typeof document?document:null}function za(t){return new xo(t,!0)}class Ha{constructor(t,e,n=1e3,i=1.5,r=6e4){this.js=t,this.timerId=e,this.lo=n,this.fo=i,this._o=r,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(t){this.cancel();const e=Math.floor(this.wo+this.To()),n=Math.max(0,Date.now()-this.yo),i=Math.max(0,e-n);i>0&&Ti("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.wo} ms, delay with jitter: ${e} ms, last attempt: ${n} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,i,(()=>(this.yo=Date.now(),t()))),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}cancel(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}class Ka{constructor(t,e,n,i,r,s,o,a){this.js=t,this.Ao=n,this.Ro=i,this.bo=r,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new Ha(t,e)}Do(){return 1===this.state||5===this.state||this.Co()}Co(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,(()=>this.Oo())))}Mo(t){this.Fo(),this.stream.send(t)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(t,e){this.Fo(),this.$o(),this.So.cancel(),this.Po++,4!==t?this.So.reset():e&&e.code===Di.RESOURCE_EXHAUSTED?(Ii(e.toString()),Ii("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):e&&e.code===Di.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Bo(),this.stream.close(),this.stream=null),this.state=t,await this.listener.Jr(e)}Bo(){}auth(){this.state=1;const t=this.Lo(this.Po),e=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([t,n])=>{this.Po===e&&this.Uo(t,n)}),(e=>{t((()=>{const t=new Pi(Di.UNKNOWN,"Fetching auth token failed: "+e.message);return this.qo(t)}))}))}Uo(t,e){const n=this.Lo(this.Po);this.stream=this.Ko(t,e),this.stream.zr((()=>{n((()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,(()=>(this.Co()&&(this.state=3),Promise.resolve()))),this.listener.zr())))})),this.stream.Jr((t=>{n((()=>this.qo(t)))})),this.stream.onMessage((t=>{n((()=>this.onMessage(t)))}))}xo(){this.state=5,this.So.Io((async()=>{this.state=0,this.start()}))}qo(t){return Ti("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}Lo(t){return e=>{this.js.enqueueAndForget((()=>this.Po===t?e():(Ti("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Wa extends Ka{constructor(t,e,n,i,r,s){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,n,i,s),this.wt=r}Ko(t,e){return this.bo.ho("Listen",t,e)}onMessage(t){this.So.reset();const e=function(t,e){let n;if("targetChange"in e){e.targetChange;const i=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Ni()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],s=function(t,e){return t.dt?(Ai(void 0===e||"string"==typeof e),vr.fromBase64String(e||"")):(Ai(void 0===e||e instanceof Uint8Array),vr.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(t){const e=void 0===t.code?Di.UNKNOWN:ro(t.code);return new Pi(e,t.message||"")}(o);n=new Co(i,r,s,a||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const r=Lo(t,i.document.name),s=Ro(i.document.updateTime),o=new Hr({mapValue:{fields:i.document.fields}}),a=Kr.newFoundDocument(r,s,o),c=i.targetIds||[],u=i.removedTargetIds||[];n=new bo(c,u,a.key,a)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const r=Lo(t,i.document),s=i.readTime?Ro(i.readTime):Ki.min(),o=Kr.newNoDocument(r,s),a=i.removedTargetIds||[];n=new bo([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const r=Lo(t,i.document),s=i.removedTargetIds||[];n=new bo([],s,r,null)}else{if(!("filter"in e))return Ni();{e.filter;const t=e.filter;t.targetId;const i=t.count||0,r=new eo(i),s=t.targetId;n=new Eo(s,r)}}return n}(this.wt,t),n=function(t){if(!("targetChange"in t))return Ki.min();const e=t.targetChange;return e.targetIds&&e.targetIds.length?Ki.min():e.readTime?Ro(e.readTime):Ki.min()}(t);return this.listener.Go(e,n)}Qo(t){const e={};e.database=Vo(this.wt),e.addTarget=function(t,e){let n;const i=e.target;return n=Xr(i)?{documents:qo(t,i)}:{query:Bo(t,i)},n.targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Po(t,e.resumeToken):e.snapshotVersion.compareTo(Ki.min())>0&&(n.readTime=Do(t,e.snapshotVersion.toTimestamp())),n}(this.wt,t);const n=function(t,e){const n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ni()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.wt,t);n&&(e.labels=n),this.Mo(e)}jo(t){const e={};e.database=Vo(this.wt),e.removeTarget=t,this.Mo(e)}}class Ga extends class{}{constructor(t,e,n,i){super(),this.authCredentials=t,this.appCheckCredentials=e,this.bo=n,this.wt=i,this.Zo=!1}tu(){if(this.Zo)throw new Pi(Di.FAILED_PRECONDITION,"The client has already been terminated.")}ro(t,e,n){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.bo.ro(t,e,n,i,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Di.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Pi(Di.UNKNOWN,t.toString())}))}ao(t,e,n){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,r])=>this.bo.ao(t,e,n,i,r))).catch((t=>{throw"FirebaseError"===t.name?(t.code===Di.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),t):new Pi(Di.UNKNOWN,t.toString())}))}terminate(){this.Zo=!0}}class Ya{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve()))))}uu(t){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ru("Offline")))}set(t){this.cu(),this.eu=0,"Online"===t&&(this.su=!1),this.ru(t)}ru(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}ou(t){const e=`Could not reach Cloud Firestore backend. ${t}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(Ii(e),this.su=!1):Ti("OnlineStateTracker",e)}cu(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}class Qa{constructor(t,e,n,i,r){this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=r,this.du.Br((t=>{n.enqueueAndForget((async()=>{sc(this)&&(Ti("RemoteStore","Restarting streams for network reachability change."),await async function(t){const e=xi(t);e.lu.add(4),await Ja(e),e._u.set("Unknown"),e.lu.delete(4),await Xa(e)}(this))}))})),this._u=new Ya(n,i)}}async function Xa(t){if(sc(t))for(const e of t.fu)await e(!0)}async function Ja(t){for(const e of t.fu)await e(!1)}function Za(t,e){const n=xi(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),rc(n)?ic(n):fc(n).Co()&&ec(n,e))}function tc(t,e){const n=xi(t),i=fc(n);n.hu.delete(e),i.Co()&&nc(n,e),0===n.hu.size&&(i.Co()?i.ko():sc(n)&&n._u.set("Unknown"))}function ec(t,e){t.wu.Nt(e.targetId),fc(t).Qo(e)}function nc(t,e){t.wu.Nt(e),fc(t).jo(e)}function ic(t){t.wu=new Io({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),fc(t).start(),t._u.iu()}function rc(t){return sc(t)&&!fc(t).Do()&&t.hu.size>0}function sc(t){return 0===xi(t).lu.size}function oc(t){t.wu=void 0}async function ac(t){t.hu.forEach(((e,n)=>{ec(t,e)}))}async function cc(t,e){oc(t),rc(t)?(t._u.uu(e),ic(t)):t._u.set("Unknown")}async function uc(t,e,n){if(t._u.set("Online"),e instanceof Co&&2===e.state&&e.cause)try{await async function(t,e){const n=e.cause;for(const i of e.targetIds)t.hu.has(i)&&(await t.remoteSyncer.rejectListen(i,n),t.hu.delete(i),t.wu.removeTarget(i))}(t,e)}catch(n){Ti("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),n),await lc(t,n)}else if(e instanceof bo?t.wu.Ut(e):e instanceof Eo?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(Ki.min()))try{const e=await xa(t.localStore);n.compareTo(e)>=0&&await function(t,e){const n=t.wu.Yt(e);return n.targetChanges.forEach(((n,i)=>{if(n.resumeToken.approximateByteSize()>0){const r=t.hu.get(i);r&&t.hu.set(i,r.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((e=>{const n=t.hu.get(e);if(!n)return;t.hu.set(e,n.withResumeToken(vr.EMPTY_BYTE_STRING,n.snapshotVersion)),nc(t,e);const i=new ia(n.target,e,1,n.sequenceNumber);ec(t,i)})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)}catch(e){Ti("RemoteStore","Failed to raise snapshot:",e),await lc(t,e)}}async function lc(t,e,n){if(!ar(e))throw e;t.lu.add(1),await Ja(t),t._u.set("Offline"),n||(n=()=>xa(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ti("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await Xa(t)}))}async function hc(t,e){const n=xi(t);n.asyncQueue.verifyOperationInProgress(),Ti("RemoteStore","RemoteStore received new credentials");const i=sc(n);n.lu.add(3),await Ja(n),i&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await Xa(n)}async function dc(t,e){const n=xi(t);e?(n.lu.delete(2),await Xa(n)):e||(n.lu.add(2),await Ja(n),n._u.set("Unknown"))}function fc(t){return t.mu||(t.mu=function(t,e,n){const i=xi(t);return i.tu(),new Wa(e,i.bo,i.authCredentials,i.appCheckCredentials,i.wt,n)}(t.datastore,t.asyncQueue,{zr:ac.bind(null,t),Jr:cc.bind(null,t),Go:uc.bind(null,t)}),t.fu.push((async e=>{e?(t.mu.No(),rc(t)?ic(t):t._u.set("Unknown")):(await t.mu.stop(),oc(t))}))),t.mu}class pc{constructor(t,e,n,i,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=i,this.removalCallback=r,this.deferred=new Ri,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((t=>{}))}static createAndSchedule(t,e,n,i,r){const s=Date.now()+n,o=new pc(t,e,s,i,r);return o.start(n),o}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Pi(Di.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gc(t,e){if(Ii("AsyncQueue",`${e}: ${t}`),ar(t))return new Pi(Di.UNAVAILABLE,`${e}: ${t}`);throw t}class mc{constructor(t){this.comparator=t?(e,n)=>t(e,n)||Xi.comparator(e.key,n.key):(t,e)=>Xi.comparator(t.key,e.key),this.keyedMap=uo(),this.sortedSet=new dr(this.comparator)}static emptySet(t){return new mc(t.comparator)}has(t){return null!=this.keyedMap.get(t)}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,n)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof mc))return!1;if(this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),n=t.sortedSet.getIterator();for(;e.hasNext();){const t=e.getNext().key,i=n.getNext().key;if(!t.isEqual(i))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"}copy(t,e){const n=new mc;return n.comparator=this.comparator,n.keyedMap=t,n.sortedSet=e,n}}class yc{constructor(){this.yu=new dr(Xi.comparator)}track(t){const e=t.doc.key,n=this.yu.get(e);n?0!==t.type&&3===n.type?this.yu=this.yu.insert(e,t):3===t.type&&1!==n.type?this.yu=this.yu.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.yu=this.yu.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.yu=this.yu.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.yu=this.yu.remove(e):1===t.type&&2===n.type?this.yu=this.yu.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.yu=this.yu.insert(e,{type:2,doc:t.doc}):Ni():this.yu=this.yu.insert(e,t)}pu(){const t=[];return this.yu.inorderTraversal(((e,n)=>{t.push(n)})),t}}class vc{constructor(t,e,n,i,r,s,o,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=r,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(t,e,n,i){const r=[];return e.forEach((t=>{r.push({type:0,doc:t})})),new vc(t,e,mc.emptySet(e),r,n,i,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&bs(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i].type!==n[i].type||!e[i].doc.isEqual(n[i].doc))return!1;return!0}}class _c{constructor(){this.Iu=void 0,this.listeners=[]}}class wc{constructor(){this.queries=new so((t=>Es(t)),bs),this.onlineState="Unknown",this.Tu=new Set}}async function bc(t,e){const n=xi(t),i=e.query;let r=!1,s=n.queries.get(i);if(s||(r=!0,s=new _c),r)try{s.Iu=await n.onListen(i)}catch(t){const n=gc(t,`Initialization of query '${Cs(e.query)}' failed`);return void e.onError(n)}n.queries.set(i,s),s.listeners.push(e),e.Eu(n.onlineState),s.Iu&&e.Au(s.Iu)&&Ic(n)}async function Ec(t,e){const n=xi(t),i=e.query;let r=!1;const s=n.queries.get(i);if(s){const t=s.listeners.indexOf(e);t>=0&&(s.listeners.splice(t,1),r=0===s.listeners.length)}if(r)return n.queries.delete(i),n.onUnlisten(i)}function Cc(t,e){const n=xi(t);let i=!1;for(const r of e){const t=r.query,e=n.queries.get(t);if(e){for(const t of e.listeners)t.Au(r)&&(i=!0);e.Iu=r}}i&&Ic(n)}function Tc(t,e,n){const i=xi(t),r=i.queries.get(e);if(r)for(const s of r.listeners)s.onError(n);i.queries.delete(e)}function Ic(t){t.Tu.forEach((t=>{t.next()}))}class Sc{constructor(t,e,n){this.query=t,this.Ru=e,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=n||{}}Au(t){if(!this.options.includeMetadataChanges){const e=[];for(const n of t.docChanges)3!==n.type&&e.push(n);t=new vc(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}let e=!1;return this.bu?this.vu(t)&&(this.Ru.next(t),e=!0):this.Vu(t,this.onlineState)&&(this.Su(t),e=!0),this.Pu=t,e}onError(t){this.Ru.error(t)}Eu(t){this.onlineState=t;let e=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,t)&&(this.Su(this.Pu),e=!0),e}Vu(t,e){if(!t.fromCache)return!0;const n="Offline"!==e;return(!this.options.Du||!n)&&(!t.docs.isEmpty()||"Offline"===e)}vu(t){if(t.docChanges.length>0)return!0;const e=this.Pu&&this.Pu.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges}Su(t){t=vc.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.bu=!0,this.Ru.next(t)}}class kc{constructor(t){this.key=t}}class Nc{constructor(t){this.key=t}}class Ac{constructor(t,e){this.query=t,this.Fu=e,this.$u=null,this.current=!1,this.Bu=mo(),this.mutatedKeys=mo(),this.Lu=Ss(t),this.Uu=new mc(this.Lu)}get qu(){return this.Fu}Ku(t,e){const n=e?e.Gu:new yc,i=e?e.Uu:this.Uu;let r=e?e.mutatedKeys:this.mutatedKeys,s=i,o=!1;const a="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,c="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal(((t,e)=>{const u=i.get(t),l=Ts(this.query,e)?e:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.Qu(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.Lu(l,a)>0||c&&this.Lu(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),r=d?r.add(t):r.delete(t)):(s=s.delete(t),r=r.delete(t)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const t="F"===this.query.limitType?s.last():s.first();s=s.delete(t.key),r=r.delete(t.key),n.track({type:1,doc:t})}return{Uu:s,Gu:n,Oi:o,mutatedKeys:r}}Qu(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,n){const i=this.Uu;this.Uu=t.Uu,this.mutatedKeys=t.mutatedKeys;const r=t.Gu.pu();r.sort(((t,e)=>function(t,e){const n=t=>{switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ni()}};return n(t)-n(e)}(t.type,e.type)||this.Lu(t.doc,e.doc))),this.ju(n);const s=e?this.Wu():[],o=0===this.Bu.size&&this.current?1:0,a=o!==this.$u;return this.$u=o,0!==r.length||a?{snapshot:new vc(this.query,t.Uu,i,r,t.mutatedKeys,0===o,a,!1),zu:s}:{zu:s}}Eu(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new yc,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(t){return!this.Fu.has(t)&&!!this.Uu.has(t)&&!this.Uu.get(t).hasLocalMutations}ju(t){t&&(t.addedDocuments.forEach((t=>this.Fu=this.Fu.add(t))),t.modifiedDocuments.forEach((t=>{})),t.removedDocuments.forEach((t=>this.Fu=this.Fu.delete(t))),this.current=t.current)}Wu(){if(!this.current)return[];const t=this.Bu;this.Bu=mo(),this.Uu.forEach((t=>{this.Hu(t.key)&&(this.Bu=this.Bu.add(t.key))}));const e=[];return t.forEach((t=>{this.Bu.has(t)||e.push(new Nc(t))})),this.Bu.forEach((n=>{t.has(n)||e.push(new kc(n))})),e}Ju(t){this.Fu=t.ji,this.Bu=mo();const e=this.Ku(t.documents);return this.applyChanges(e,!0)}Yu(){return vc.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}class xc{constructor(t,e,n){this.query=t,this.targetId=e,this.view=n}}class Dc{constructor(t){this.key=t,this.Xu=!1}}class Pc{constructor(t,e,n,i,r,s){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=i,this.currentUser=r,this.maxConcurrentLimboResolutions=s,this.Zu={},this.tc=new so((t=>Es(t)),bs),this.ec=new Map,this.nc=new Set,this.sc=new dr(Xi.comparator),this.ic=new Map,this.rc=new ma,this.oc={},this.uc=new Map,this.cc=la.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return!0===this.ac}}async function Rc(t,e){const n=Wc(t);let i,r;const s=n.tc.get(e);if(s)i=s.targetId,n.sharedClientState.addLocalQueryTarget(i),r=s.view.Yu();else{const t=await Pa(n.localStore,_s(e));n.isPrimaryClient&&Za(n.remoteStore,t);const s=n.sharedClientState.addLocalQueryTarget(t.targetId);i=t.targetId,r=await Oc(n,e,i,"current"===s)}return r}async function Oc(t,e,n,i){t.hc=(e,n,i)=>async function(t,e,n,i){let r=e.view.Ku(n);r.Oi&&(r=await Oa(t.localStore,e.query,!1).then((({documents:t})=>e.view.Ku(t,r))));const s=i&&i.targetChanges.get(e.targetId),o=e.view.applyChanges(r,t.isPrimaryClient,s);return qc(t,e.targetId,o.zu),o.snapshot}(t,e,n,i);const r=await Oa(t.localStore,e,!0),s=new Ac(e,r.ji),o=s.Ku(r.documents),a=wo.createSynthesizedTargetChangeForCurrentChange(n,i&&"Offline"!==t.onlineState),c=s.applyChanges(o,t.isPrimaryClient,a);qc(t,n,c.zu);const u=new xc(e,n,s);return t.tc.set(e,u),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),c.snapshot}async function Mc(t,e){const n=xi(t),i=n.tc.get(e),r=n.ec.get(i.targetId);if(r.length>1)return n.ec.set(i.targetId,r.filter((t=>!bs(t,e)))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Ra(n.localStore,i.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(i.targetId),tc(n.remoteStore,i.targetId),Vc(n,i.targetId)})).catch(sr)):(Vc(n,i.targetId),await Ra(n.localStore,i.targetId,!0))}async function Lc(t,e){const n=xi(t);try{const t=await function(t,e){const n=xi(t),i=e.snapshotVersion;let r=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(t=>{const s=n.Ui.newChangeBuffer({trackRemovals:!0});r=n.$i;const o=[];e.targetChanges.forEach(((s,a)=>{const c=r.get(a);if(!c)return;o.push(n.Vs.removeMatchingKeys(t,s.removedDocuments,a).next((()=>n.Vs.addMatchingKeys(t,s.addedDocuments,a))));let u=c.withSequenceNumber(t.currentSequenceNumber);e.targetMismatches.has(a)?u=u.withResumeToken(vr.EMPTY_BYTE_STRING,Ki.min()).withLastLimboFreeSnapshotVersion(Ki.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,i)),r=r.insert(a,u),function(t,e,n){return 0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.Vs.updateTargetData(t,u))}));let a=ao(),c=mo();if(e.documentUpdates.forEach((i=>{e.resolvedLimboDocuments.has(i)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(t,i))})),o.push(Da(t,s,e.documentUpdates).next((t=>{a=t.Gi,c=t.Qi}))),!i.isEqual(Ki.min())){const e=n.Vs.getLastRemoteSnapshotVersion(t).next((e=>n.Vs.setTargetsMetadata(t,t.currentSequenceNumber,i)));o.push(e)}return or.waitFor(o).next((()=>s.apply(t))).next((()=>n.localDocuments.getLocalViewOfDocuments(t,a,c))).next((()=>a))})).then((t=>(n.$i=r,t)))}(n.localStore,e);e.targetChanges.forEach(((t,e)=>{const i=n.ic.get(e);i&&(Ai(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?i.Xu=!0:t.modifiedDocuments.size>0?Ai(i.Xu):t.removedDocuments.size>0&&(Ai(i.Xu),i.Xu=!1))})),await zc(n,t,e)}catch(t){await sr(t)}}function Fc(t,e,n){const i=xi(t);if(i.isPrimaryClient&&0===n||!i.isPrimaryClient&&1===n){const t=[];i.tc.forEach(((n,i)=>{const r=i.view.Eu(e);r.snapshot&&t.push(r.snapshot)})),function(t,e){const n=xi(t);n.onlineState=e;let i=!1;n.queries.forEach(((t,n)=>{for(const r of n.listeners)r.Eu(e)&&(i=!0)})),i&&Ic(n)}(i.eventManager,e),t.length&&i.Zu.Go(t),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function jc(t,e,n){const i=xi(t);i.sharedClientState.updateQueryState(e,"rejected",n);const r=i.ic.get(e),s=r&&r.key;if(s){let t=new dr(Xi.comparator);t=t.insert(s,Kr.newNoDocument(s,Ki.min()));const n=mo().add(s),r=new _o(Ki.min(),new Map,new gr($i),t,n);await Lc(i,r),i.sc=i.sc.remove(s),i.ic.delete(e),$c(i)}else await Ra(i.localStore,e,!1).then((()=>Vc(i,e,n))).catch(sr)}function Vc(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.ec.get(e))t.tc.delete(i),n&&t.Zu.lc(i,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach((e=>{t.rc.containsKey(e)||Uc(t,e)}))}function Uc(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);null!==n&&(tc(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),$c(t))}function qc(t,e,n){for(const i of n)i instanceof kc?(t.rc.addReference(i.key,e),Bc(t,i)):i instanceof Nc?(Ti("SyncEngine","Document no longer in limbo: "+i.key),t.rc.removeReference(i.key,e),t.rc.containsKey(i.key)||Uc(t,i.key)):Ni()}function Bc(t,e){const n=e.key,i=n.path.canonicalString();t.sc.get(n)||t.nc.has(i)||(Ti("SyncEngine","New document in limbo: "+n),t.nc.add(i),$c(t))}function $c(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new Xi(Gi.fromString(e)),i=t.cc.next();t.ic.set(i,new Dc(n)),t.sc=t.sc.insert(n,i),Za(t.remoteStore,new ia(_s(ps(n.path)),i,2,cr.ot))}}async function zc(t,e,n){const i=xi(t),r=[],s=[],o=[];i.tc.isEmpty()||(i.tc.forEach(((t,a)=>{o.push(i.hc(a,e,n).then((t=>{if(t){i.isPrimaryClient&&i.sharedClientState.updateQueryState(a.targetId,t.fromCache?"not-current":"current"),r.push(t);const e=Ia.Vi(a.targetId,t);s.push(e)}})))})),await Promise.all(o),i.Zu.Go(r),await async function(t,e){const n=xi(t);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(t=>or.forEach(e,(e=>or.forEach(e.Pi,(i=>n.persistence.referenceDelegate.addReference(t,e.targetId,i))).next((()=>or.forEach(e.vi,(i=>n.persistence.referenceDelegate.removeReference(t,e.targetId,i)))))))))}catch(t){if(!ar(t))throw t;Ti("LocalStore","Failed to update sequence numbers: "+t)}for(const i of e){const t=i.targetId;if(!i.fromCache){const e=n.$i.get(t),i=e.snapshotVersion,r=e.withLastLimboFreeSnapshotVersion(i);n.$i=n.$i.insert(t,r)}}}(i.localStore,s))}async function Hc(t,e){const n=xi(t);if(!n.currentUser.isEqual(e)){Ti("SyncEngine","User change. New user:",e.toKey());const t=await Aa(n.localStore,e);n.currentUser=e,function(t,e){t.uc.forEach((t=>{t.forEach((t=>{t.reject(new Pi(Di.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.uc.clear()}(n),n.sharedClientState.handleUserChange(e,t.removedBatchIds,t.addedBatchIds),await zc(n,t.Ki)}}function Kc(t,e){const n=xi(t),i=n.ic.get(e);if(i&&i.Xu)return mo().add(i.key);{let t=mo();const i=n.ec.get(e);if(!i)return t;for(const e of i){const i=n.tc.get(e);t=t.unionWith(i.view.qu)}return t}}function Wc(t){const e=xi(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Lc.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Kc.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jc.bind(null,e),e.Zu.Go=Cc.bind(null,e.eventManager),e.Zu.lc=Tc.bind(null,e.eventManager),e}class Gc{constructor(){this.synchronizeTabs=!1}async initialize(t){this.wt=za(t.databaseInfo.databaseId),this.sharedClientState=this.dc(t),this.persistence=this._c(t),await this.persistence.start(),this.localStore=this.wc(t),this.gcScheduler=this.mc(t,this.localStore),this.indexBackfillerScheduler=this.gc(t,this.localStore)}mc(t,e){return null}gc(t,e){return null}wc(t){return Na(this.persistence,new Sa,t.initialUser,this.wt)}_c(t){return new Ea(Ta.Ms,this.wt)}dc(t){return new Fa}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class Yc{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=t=>Fc(this.syncEngine,t,1),this.remoteStore.remoteSyncer.handleCredentialChange=Hc.bind(null,this.syncEngine),await dc(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return new wc}createDatastore(t){const e=za(t.databaseInfo.databaseId),n=(i=t.databaseInfo,new Ba(i));var i;return function(t,e,n,i){return new Ga(t,e,n,i)}(t.authCredentials,t.appCheckCredentials,n,e)}createRemoteStore(t){return e=this.localStore,n=this.datastore,i=t.asyncQueue,r=t=>Fc(this.syncEngine,t,0),s=Va.V()?new Va:new ja,new Qa(e,n,i,r,s);var e,n,i,r,s}createSyncEngine(t,e){return function(t,e,n,i,r,s,o){const a=new Pc(t,e,n,i,r,s);return o&&(a.ac=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return async function(t){const e=xi(t);Ti("RemoteStore","RemoteStore shutting down."),e.lu.add(5),await Ja(e),e.du.shutdown(),e._u.set("Unknown")}(this.remoteStore)}}class Qc{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ic(this.observer.next,t)}error(t){this.observer.error?this.Ic(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)}Tc(){this.muted=!0}Ic(t,e){this.muted||setTimeout((()=>{this.muted||t(e)}),0)}}class Xc{constructor(t,e,n,i){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=n,this.databaseInfo=i,this.user=wi.UNAUTHENTICATED,this.clientId=Bi.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async t=>{Ti("FirestoreClient","Received user=",t.uid),await this.authCredentialListener(t),this.user=t})),this.appCheckCredentials.start(n,(t=>(Ti("FirestoreClient","Received new app check token=",t),this.appCheckCredentialListener(t,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Pi(Di.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const t=new Ri;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const n=gc(e,"Failed to shutdown persistence");t.reject(n)}})),t.promise}}async function Jc(t,e){t.asyncQueue.verifyOperationInProgress(),Ti("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async t=>{i.isEqual(t)||(await Aa(e.localStore,t),i=t)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t.offlineComponents=e}async function Zc(t,e){t.asyncQueue.verifyOperationInProgress();const n=await tu(t);Ti("FirestoreClient","Initializing OnlineComponentProvider");const i=await t.getConfiguration();await e.initialize(n,i),t.setCredentialChangeListener((t=>hc(e.remoteStore,t))),t.setAppCheckTokenChangeListener(((t,n)=>hc(e.remoteStore,n))),t.onlineComponents=e}async function tu(t){return t.offlineComponents||(Ti("FirestoreClient","Using default OfflineComponentProvider"),await Jc(t,new Gc)),t.offlineComponents}async function eu(t){return t.onlineComponents||(Ti("FirestoreClient","Using default OnlineComponentProvider"),await Zc(t,new Yc)),t.onlineComponents}async function nu(t){const e=await eu(t),n=e.eventManager;return n.onListen=Rc.bind(null,e.syncEngine),n.onUnlisten=Mc.bind(null,e.syncEngine),n}const iu=new Map;function ru(t,e,n){if(!n)throw new Pi(Di.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function su(t){if(Xi.isDocumentKey(t))throw new Pi(Di.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ou(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";{const e=function(t){return t.constructor?t.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return"function"==typeof t?"a function":Ni()}function au(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Pi(Di.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ou(t);throw new Pi(Di.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}class cu{constructor(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Pi(Di.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Pi(Di.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(t,e,n,i){if(!0===e&&!0===i)throw new Pi(Di.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class uu{constructor(t,e,n){this._authCredentials=e,this._appCheckCredentials=n,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new cu({}),this._settingsFrozen=!1,t instanceof kr?this._databaseId=t:(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Pi(Di.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new kr(t.options.projectId)}(t))}get app(){if(!this._app)throw new Pi(Di.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(t){if(this._settingsFrozen)throw new Pi(Di.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new cu(t),void 0!==t.credentials&&(this._authCredentials=function(t){if(!t)return new Mi;switch(t.type){case"gapi":const e=t.client;return Ai(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new ji(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Pi(Di.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const e=iu.get(t);e&&(Ti("ComponentProvider","Removing Datastore"),iu.delete(t),e.terminate())}(this),Promise.resolve()}}class lu{constructor(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new du(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new lu(this.firestore,t,this._key)}}class hu{constructor(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}withConverter(t){return new hu(this.firestore,t,this._query)}}class du extends hu{constructor(t,e,n){super(t,e,ps(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new lu(this.firestore,null,new Xi(t))}withConverter(t){return new du(this.firestore,t,this._path)}}function fu(t,e,...n){if(t=(0,a.m9)(t),ru("collection","path",e),t instanceof uu){const i=Gi.fromString(e,...n);return su(i),new du(t,null,i)}{if(!(t instanceof lu||t instanceof du))throw new Pi(Di.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Gi.fromString(e,...n));return su(i),new du(t.firestore,null,i)}}class pu{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new Ha(this,"async_queue_retry"),this.Kc=()=>{const t=$a();t&&Ti("AsyncQueue","Visibility state changed to "+t.visibilityState),this.So.Eo()};const t=$a();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.Gc(),this.Qc(t)}enterRestrictedMode(t){if(!this.Fc){this.Fc=!0,this.Uc=t||!1;const e=$a();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Kc)}}enqueue(t){if(this.Gc(),this.Fc)return new Promise((()=>{}));const e=new Ri;return this.Qc((()=>this.Fc&&this.Uc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Mc.push(t),this.jc())))}async jc(){if(0!==this.Mc.length){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(b){if(!ar(b))throw b;Ti("AsyncQueue","Operation failed with retryable error: "+b)}this.Mc.length>0&&this.So.Io((()=>this.jc()))}}Qc(t){const e=this.Oc.then((()=>(this.Lc=!0,t().catch((t=>{this.Bc=t,this.Lc=!1;const e=function(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t);throw Ii("INTERNAL UNHANDLED ERROR: ",e),t})).then((t=>(this.Lc=!1,t))))));return this.Oc=e,e}enqueueAfterDelay(t,e,n){this.Gc(),this.qc.indexOf(t)>-1&&(e=0);const i=pc.createAndSchedule(this,t,e,n,(t=>this.Wc(t)));return this.$c.push(i),i}Gc(){this.Bc&&Ni()}verifyOperationInProgress(){}async zc(){let t;do{t=this.Oc,await t}while(t!==this.Oc)}Hc(t){for(const e of this.$c)if(e.timerId===t)return!0;return!1}Jc(t){return this.zc().then((()=>{this.$c.sort(((t,e)=>t.targetTimeMs-e.targetTimeMs));for(const e of this.$c)if(e.skipDelay(),"all"!==t&&e.timerId===t)break;return this.zc()}))}Yc(t){this.qc.push(t)}Wc(t){const e=this.$c.indexOf(t);this.$c.splice(e,1)}}function gu(t){return function(t,e){if("object"!=typeof t||null===t)return!1;const n=t;for(const i of["next","error","complete"])if(i in n&&"function"==typeof n[i])return!0;return!1}(t)}class mu extends uu{constructor(t,e,n){super(t,e,n),this.type="firestore",this._queue=new pu,this._persistenceKey="name"in t?t.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||_u(this),this._firestoreClient.terminate()}}function yu(t=(0,r.Mq)()){return(0,r.qX)(t,"firestore").getImmediate()}function vu(t){return t._firestoreClient||_u(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function _u(t){var e;const n=t._freezeSettings(),i=function(t,e,n,i){return new Sr(t,e,n,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,i.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new Xc(t._authCredentials,t._appCheckCredentials,t._queue,i)}class wu{constructor(...t){for(let e=0;e<t.length;++e)if(0===t[e].length)throw new Pi(Di.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Qi(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class bu{constructor(t){this._byteString=t}static fromBase64String(t){try{return new bu(vr.fromBase64String(t))}catch(t){throw new Pi(Di.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(t){return new bu(vr.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}}class Eu{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new Pi(Di.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Pi(Di.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return $i(this._lat,t._lat)||$i(this._long,t._long)}}const Cu=new RegExp("[~\\*/\\[\\]]");function Tu(t,e,n){if(e.search(Cu)>=0)throw Iu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new wu(...e.split("."))._internalPath}catch(i){throw Iu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Iu(t,e,n,i,r){const s=i&&!i.isEmpty(),o=void 0!==r;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new Pi(Di.INVALID_ARGUMENT,a+t+c)}class Su{constructor(t,e,n,i,r){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=i,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new lu(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const t=new ku(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(Nu("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}}}class ku extends Su{data(){return super.data()}}function Nu(t,e){return"string"==typeof e?Tu(t,e):e instanceof wu?e._internalPath:e._delegate._internalPath}class Au{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class xu extends Su{constructor(t,e,n,i,r,s){super(t,e,n,i,s),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Du(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const n=this._document.data.field(Nu("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}}}class Du extends xu{data(t={}){return super.data(t)}}class Pu{constructor(t,e,n,i){this._firestore=t,this._userDataWriter=e,this._snapshot=i,this.metadata=new Au(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(t,e){this._snapshot.docs.forEach((n=>{t.call(e,new Du(this._firestore,this._userDataWriter,n.key,n,new Au(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Pi(Di.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){let e=0;return t._snapshot.docChanges.map((n=>({type:"added",doc:new Du(t._firestore,t._userDataWriter,n.doc.key,n.doc,new Au(t._snapshot.mutatedKeys.has(n.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:e++})))}{let n=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((t=>e||3!==t.type)).map((e=>{const i=new Du(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Au(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter);let r=-1,s=-1;return 0!==e.type&&(r=n.indexOf(e.doc.key),n=n.delete(e.doc.key)),1!==e.type&&(n=n.add(e.doc),s=n.indexOf(e.doc.key)),{type:Ru(e.type),doc:i,oldIndex:r,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Ru(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ni()}}function Ou(t){if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new Pi(Di.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function Mu(t,...e){for(const n of e)t=n._apply(t);return t}class Lu{convertValue(t,e="none"){switch(Dr(t)){case 0:return null;case 1:return t.booleanValue;case 2:return br(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Er(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Ni()}}convertObject(t,e){const n={};return lr(t.fields,((t,i)=>{n[t]=this.convertValue(i,e)})),n}convertGeoPoint(t){return new Eu(br(t.latitude),br(t.longitude))}convertArray(t,e){return(t.values||[]).map((t=>this.convertValue(t,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const n=Tr(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Ir(t));default:return null}}convertTimestamp(t){const e=wr(t);return new Hi(e.seconds,e.nanos)}convertDocumentKey(t,e){const n=Gi.fromString(t);Ai(Xo(n));const i=new kr(n.get(1),n.get(3)),r=new Xi(n.popFirst(5));return i.isEqual(e)||Ii(`Document ${r} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}class Fu extends Lu{constructor(t){super(),this.firestore=t}convertBytes(t){return new bu(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new lu(this.firestore,null,e)}}function ju(t,...e){var n,i,r;t=(0,a.m9)(t);let s={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||gu(e[o])||(s=e[o],o++);const c={includeMetadataChanges:s.includeMetadataChanges};if(gu(e[o])){const t=e[o];e[o]=null===(n=t.next)||void 0===n?void 0:n.bind(t),e[o+1]=null===(i=t.error)||void 0===i?void 0:i.bind(t),e[o+2]=null===(r=t.complete)||void 0===r?void 0:r.bind(t)}let u,l,h;if(t instanceof lu)l=au(t.firestore,mu),h=ps(t._key.path),u={next:n=>{e[o]&&e[o](Vu(l,t,n))},error:e[o+1],complete:e[o+2]};else{const n=au(t,hu);l=au(n.firestore,mu),h=n._query;const i=new Fu(l);u={next:t=>{e[o]&&e[o](new Pu(l,i,n,t))},error:e[o+1],complete:e[o+2]},Ou(t._query)}return function(t,e,n,i){const r=new Qc(i),s=new Sc(e,r,n);return t.asyncQueue.enqueueAndForget((async()=>bc(await nu(t),s))),()=>{r.Tc(),t.asyncQueue.enqueueAndForget((async()=>Ec(await nu(t),s)))}}(vu(l),h,c,u)}function Vu(t,e,n){const i=n.docs.get(e._key),r=new Fu(t);return new xu(t,r,e._key,i,new Au(n.hasPendingWrites,n.fromCache),e.converter)}!function(t,e=!0){!function(t){bi=t}(r.Jn),(0,r.Xd)(new s.wA("firestore",((t,{options:n})=>{const i=t.getProvider("app").getImmediate(),r=new mu(i,new Li(t.getProvider("auth-internal")),new Ui(t.getProvider("app-check-internal")));return n=Object.assign({useFetchStreams:e},n),r._setSettings(n),r}),"PUBLIC")),(0,r.KN)(_i,"3.4.10",t),(0,r.KN)(_i,"3.4.10","esm2017")}()},6086:function(t){"use strict";var e=Object.assign.bind(Object);t.exports=e,t.exports.default=t.exports},3454:function(t,e,n){"use strict";var i,r;t.exports=(null===(i=n.g.process)||void 0===i?void 0:i.env)&&"object"===typeof(null===(r=n.g.process)||void 0===r?void 0:r.env)?n.g.process:n(7663)},1118:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return n(11)}])},3951:function(t,e,n){"use strict";var i=n(5893),r=n(9008),s=n.n(r),o=function(t){var e=t.title,n=t.keywords,r=t.description;return(0,i.jsxs)(s(),{children:[(0,i.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,i.jsx)("meta",{name:"keywords",content:n}),(0,i.jsx)("meta",{name:"description",content:r}),(0,i.jsx)("meta",{charSet:"utf-8"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"}),(0,i.jsx)("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),(0,i.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:!0}),(0,i.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Teko:wght@400;500;600;700&display=swap",rel:"stylesheet"}),(0,i.jsx)("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"}),(0,i.jsx)("title",{children:e})]})};o.defaultProps={title:"WebDev Newz",keywords:"web development, programming",description:"Get the latest news in web dev"},e.Z=o},3393:function(t,e,n){"use strict";n.d(e,{db:function(){return us}});var i=n(2238);(0,i.KN)("firebase","9.8.3","app");var r=n(5321),s=n(8463),o=n(4444),a=n(3333),c=n(3454);const u="@firebase/database",l="0.13.1";let h="";class d{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,o.Pz)(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,o.cI)(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class f{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e}get(t){return(0,o.r3)(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const p=function(t){try{if("undefined"!==typeof window&&"undefined"!==typeof window[t]){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new d(e)}}catch(e){}return new f},g=p("localStorage"),m=p("sessionStorage"),y=new a.Yd("@firebase/database"),v=function(){let t=1;return function(){return t++}}(),_=function(t){const e=(0,o.dS)(t),n=new o.gQ;n.update(e);const i=n.digest();return o.US.encodeByteArray(i)},w=function(...t){let e="";for(let n=0;n<t.length;n++){const i=t[n];Array.isArray(i)||i&&"object"===typeof i&&"number"===typeof i.length?e+=w.apply(null,i):e+="object"===typeof i?(0,o.Pz)(i):i,e+=" "}return e};let b=null,E=!0;const C=function(t,e){(0,o.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(y.logLevel=a.in.VERBOSE,b=y.log.bind(y),e&&m.set("logging_enabled",!0)):"function"===typeof t?b=t:(b=null,m.remove("logging_enabled"))},T=function(...t){if(!0===E&&(E=!1,null===b&&!0===m.get("logging_enabled")&&C(!0)),b){const e=w.apply(null,t);b(e)}},I=function(t){return function(...e){T(t,...e)}},S=function(...t){const e="FIREBASE INTERNAL ERROR: "+w(...t);y.error(e)},k=function(...t){const e=`FIREBASE FATAL ERROR: ${w(...t)}`;throw y.error(e),new Error(e)},N=function(...t){const e="FIREBASE WARNING: "+w(...t);y.warn(e)},A=function(t){return"number"===typeof t&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},x="[MIN_NAME]",D="[MAX_NAME]",P=function(t,e){if(t===e)return 0;if(t===x||e===D)return-1;if(e===x||t===D)return 1;{const n=B(t),i=B(e);return null!==n?null!==i?n-i===0?t.length-e.length:n-i:-1:null!==i?1:t<e?-1:1}},R=function(t,e){return t===e?0:t<e?-1:1},O=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,o.Pz)(e))},M=function(t){if("object"!==typeof t||null===t)return(0,o.Pz)(t);const e=[];for(const i in t)e.push(i);e.sort();let n="{";for(let i=0;i<e.length;i++)0!==i&&(n+=","),n+=(0,o.Pz)(e[i]),n+=":",n+=M(t[e[i]]);return n+="}",n},L=function(t,e){const n=t.length;if(n<=e)return[t];const i=[];for(let r=0;r<n;r+=e)r+e>n?i.push(t.substring(r,n)):i.push(t.substring(r,r+e));return i};function F(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const j=function(t){(0,o.hu)(!A(t),"Invalid JSON number");const e=1023;let n,i,r,s,a;0===t?(i=0,r=0,n=1/t===-1/0?1:0):(n=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(s=Math.min(Math.floor(Math.log(t)/Math.LN2),e),i=s+e,r=Math.round(t*Math.pow(2,52-s)-Math.pow(2,52))):(i=0,r=Math.round(t/Math.pow(2,-1074))));const c=[];for(a=52;a;a-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)c.push(i%2?1:0),i=Math.floor(i/2);c.push(n?1:0),c.reverse();const u=c.join("");let l="";for(a=0;a<64;a+=8){let t=parseInt(u.substr(a,8),2).toString(16);1===t.length&&(t="0"+t),l+=t}return l.toLowerCase()};const V=new RegExp("^-?(0*)\\d{1,10}$"),U=-2147483648,q=2147483647,B=function(t){if(V.test(t)){const e=Number(t);if(e>=U&&e<=q)return e}return null},$=function(t){try{t()}catch(e){setTimeout((()=>{const t=e.stack||"";throw N("Exception was thrown by user callback.",t),e}),Math.floor(0))}},z=function(t,e){const n=setTimeout(t,e);return"object"===typeof n&&n.unref&&n.unref(),n};class H{constructor(t,e){this.appName_=t,this.appCheckProvider=e,this.appCheck=null===e||void 0===e?void 0:e.getImmediate({optional:!0}),this.appCheck||null===e||void 0===e||e.get().then((t=>this.appCheck=t))}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise(((e,n)=>{setTimeout((()=>{this.appCheck?this.getToken(t).then(e,n):e(null)}),0)}))}addTokenChangeListener(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((e=>e.addTokenListener(t)))}notifyForInvalidToken(){N(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class K{constructor(t,e,n){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((t=>this.auth_=t))}getToken(t){return this.auth_?this.auth_.getToken(t).catch((t=>t&&"auth/token-not-initialized"===t.code?(T("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t))):new Promise(((e,n)=>{setTimeout((()=>{this.auth_?this.getToken(t).then(e,n):e(null)}),0)}))}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((e=>e.addAuthTokenListener(t)))}removeTokenChangeListener(t){this.authProvider_.get().then((e=>e.removeAuthTokenListener(t)))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',N(t)}}class W{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}W.OWNER="owner";const G="5",Y=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Q="websocket",X="long_polling";class J{constructor(t,e,n,i,r=!1,s="",o=!1){this.secure=e,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=r,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=g.get("host:"+t)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&g.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${e}`}}function Z(t,e,n){let i;if((0,o.hu)("string"===typeof e,"typeof type must == string"),(0,o.hu)("object"===typeof n,"typeof params must == object"),e===Q)i=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==X)throw new Error("Unknown connection type: "+e);i=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);const r=[];return F(n,((t,e)=>{r.push(t+"="+e)})),i+r.join("&")}class tt{constructor(){this.counters_={}}incrementCounter(t,e=1){(0,o.r3)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return(0,o.p$)(this.counters_)}}const et={},nt={};function it(t){const e=t.toString();return et[e]||(et[e]=new tt),et[e]}class rt{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const t=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let e=0;e<t.length;++e)t[e]&&$((()=>{this.onMessage_(t[e])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const st="start";class ot{constructor(t,e,n,i,r,s,o){this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=I(t),this.stats_=it(e),this.urlFn=t=>(this.appCheckToken&&(t.ac=this.appCheckToken),Z(e,X,t))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new rt(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if((0,o.Yr)()||"complete"===document.readyState)t();else{let e=!1;const n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new at(((...t)=>{const[e,n,i,r,s]=t;if(this.incrementIncomingBytes_(t),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,e===st)this.id=n,this.password=i;else{if("close"!==e)throw new Error("Unrecognized command received: "+e);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...t)=>{const[e,n]=t;this.incrementIncomingBytes_(t),this.myPacketOrderer.handleResponse(e,n)}),(()=>{this.onClosed_()}),this.urlFn);const t={start:"t"};t.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=this.scriptTagHolder.uniqueCallbackIdentifier),t.v=G,this.transportSessionId&&(t.s=this.transportSessionId),this.lastSessionId&&(t.ls=this.lastSessionId),this.applicationId&&(t.p=this.applicationId),this.appCheckToken&&(t.ac=this.appCheckToken),"undefined"!==typeof location&&location.hostname&&Y.test(location.hostname)&&(t.r="f");const e=this.urlFn(t);this.log_("Connecting via long-poll to "+e),this.scriptTagHolder.addTag(e,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){ot.forceAllow_=!0}static forceDisallow(){ot.forceDisallow_=!0}static isAvailable(){return!(0,o.Yr)()&&(!!ot.forceAllow_||!ot.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=(0,o.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=(0,o.h$)(e),i=L(n,1840);for(let r=0;r<i.length;r++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[r]),this.curSegmentNum++}addDisconnectPingFrame(t,e){if((0,o.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=(0,o.Pz)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class at{constructor(t,e,n,i){if(this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,o.Yr)())this.commandCB=t,this.onMessageCB=e;else{this.uniqueCallbackIdentifier=v(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=at.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){n='<script>document.domain="'+document.domain+'";<\/script>'}const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(r){T("frame writing exception"),r.stack&&T(r.stack),T(r)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||T("No IE domain setting required")}catch(e){const n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;let e=this.urlFn(t),n="",i=0;for(;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;{const t=this.pendingSegs.shift();n=n+"&seg"+i+"="+t.seg+"&ts"+i+"="+t.ts+"&d"+i+"="+t.d,i++}}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const n=()=>{this.outstandingRequests.delete(e),this.newRequest_()},i=setTimeout(n,Math.floor(25e3));this.addTag(t,(()=>{clearTimeout(i),n()}))}addTag(t,e){(0,o.Yr)()?this.doNodeLongPoll(t,e):setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,n.onload=n.onreadystatechange=function(){const t=n.readyState;t&&"loaded"!==t&&"complete"!==t||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),e())},n.onerror=()=>{T("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(n){}}),Math.floor(1))}}let ct=null;"undefined"!==typeof MozWebSocket?ct=MozWebSocket:"undefined"!==typeof WebSocket&&(ct=WebSocket);class ut{constructor(t,e,n,i,r,s,o){this.connId=t,this.applicationId=n,this.appCheckToken=i,this.authToken=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=I(this.connId),this.stats_=it(e),this.connURL=ut.connectionURL_(e,s,o,i,n),this.nodeAdmin=e.nodeAdmin}static connectionURL_(t,e,n,i,r){const s={};return s.v=G,!(0,o.Yr)()&&"undefined"!==typeof location&&location.hostname&&Y.test(location.hostname)&&(s.r="f"),e&&(s.s=e),n&&(s.ls=n),i&&(s.ac=i),r&&(s.p=r),Z(t,Q,s)}open(t,e){this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,g.set("previous_websocket_failure",!0);try{let t;if((0,o.Yr)()){const t=this.nodeAdmin?"AdminNode":"Node",e={headers:{"User-Agent":`Firebase/5/${h}/${c.platform}/${t}`,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(e.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);const n=c.env,i=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;i&&(e.proxy={origin:i})}this.mySock=new ct(this.connURL,[],t)}catch(n){this.log_("Error instantiating WebSocket.");const t=n.message||n.data;return t&&this.log_(t),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=t=>{this.handleIncomingFrame(t)},this.mySock.onerror=t=>{this.log_("WebSocket error.  Closing connection.");const e=t.message||t.data;e&&this.log_(e),this.onClosed_()}}start(){}static forceDisallow(){ut.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!==typeof navigator&&navigator.userAgent){const e=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(e);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==ct&&!ut.forceDisallow_}static previouslyFailed(){return g.isInMemoryStorage||!0===g.get("previous_websocket_failure")}markConnectionHealthy(){g.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const e=(0,o.cI)(t);this.onMessage(e)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,o.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{const t=this.extractFrameCount_(e);null!==t&&this.appendFrame_(t)}}send(t){this.resetKeepAlive();const e=(0,o.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=L(e,16384);n.length>1&&this.sendString_(String(n.length));for(let i=0;i<n.length;i++)this.sendString_(n[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ut.responsesRequiredToBeHealthy=2,ut.healthyTimeout=3e4;class lt{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[ot,ut]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const e=ut&&ut.isAvailable();let n=e&&!ut.previouslyFailed();if(t.webSocketOnly&&(e||N("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[ut];else{const t=this.transports_=[];for(const e of lt.ALL_TRANSPORTS)e&&e.isAvailable()&&t.push(e);lt.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}lt.globalTransportInitialized_=!1;class ht{constructor(t,e,n,i,r,s,o,a,c,u){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=r,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=I("c:"+this.id+":"),this.transportManager_=new lt(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(e,n)}),Math.floor(0));const i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=z((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){const e={t:"d",d:t};this.sendData_(e)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if("t"in t){const e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=O("t",t),n=O("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=O("t",t),n=O("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=O("t",t);if("d"in t){const n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let t=0;t<this.pendingDataMessages.length;++t)this.onDataMessage_(this.pendingDataMessages[t]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?S("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):S("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,n=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),G!==n&&N("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,n),z((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):z((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()}onConnectionLost_(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(g.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class dt{put(t,e,n,i){}merge(t,e,n,i){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,n){}onDisconnectMerge(t,e,n){}onDisconnectCancel(t,e){}reportStats(t){}}class ft{constructor(t){this.allowedEvents_=t,this.listeners_={},(0,o.hu)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const n=[...this.listeners_[t]];for(let t=0;t<n.length;t++)n[t].callback.apply(n[t].context,e)}}on(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});const i=this.getInitialEvent(t);i&&e.apply(n,i)}off(t,e,n){this.validateEventType_(t);const i=this.listeners_[t]||[];for(let r=0;r<i.length;r++)if(i[r].callback===e&&(!n||n===i[r].context))return void i.splice(r,1)}validateEventType_(t){(0,o.hu)(this.allowedEvents_.find((e=>e===t)),"Unknown event: "+t)}}class pt extends ft{constructor(){super(["online"]),this.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||(0,o.uI)()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new pt}getInitialEvent(t){return(0,o.hu)("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}class gt{constructor(t,e){if(void 0===e){this.pieces_=t.split("/");let e=0;for(let t=0;t<this.pieces_.length;t++)this.pieces_[t].length>0&&(this.pieces_[e]=this.pieces_[t],e++);this.pieces_.length=e,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"}}function mt(){return new gt("")}function yt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function vt(t){return t.pieces_.length-t.pieceNum_}function _t(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new gt(t.pieces_,e)}function wt(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function bt(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Et(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new gt(e,0)}function Ct(t,e){const n=[];for(let i=t.pieceNum_;i<t.pieces_.length;i++)n.push(t.pieces_[i]);if(e instanceof gt)for(let i=e.pieceNum_;i<e.pieces_.length;i++)n.push(e.pieces_[i]);else{const t=e.split("/");for(let e=0;e<t.length;e++)t[e].length>0&&n.push(t[e])}return new gt(n,0)}function Tt(t){return t.pieceNum_>=t.pieces_.length}function It(t,e){const n=yt(t),i=yt(e);if(null===n)return e;if(n===i)return It(_t(t),_t(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function St(t,e){if(vt(t)!==vt(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function kt(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(vt(t)>vt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}class Nt{constructor(t,e){this.errorPrefix_=e,this.parts_=bt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let n=0;n<this.parts_.length;n++)this.byteLength_+=(0,o.ug)(this.parts_[n]);At(this)}}function At(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+xt(t))}function xt(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class Dt extends ft{constructor(){let t,e;super(["visible"]),"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(e="visibilitychange",t="hidden"):"undefined"!==typeof document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):"undefined"!==typeof document.msHidden?(e="msvisibilitychange",t="msHidden"):"undefined"!==typeof document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,(()=>{const e=!document[t];e!==this.visible_&&(this.visible_=e,this.trigger("visible",e))}),!1)}static getInstance(){return new Dt}getInitialEvent(t){return(0,o.hu)("visible"===t,"Unknown event type: "+t),[this.visible_]}}const Pt=1e3;class Rt extends dt{constructor(t,e,n,i,r,s,a,c){if(super(),this.repoInfo_=t,this.applicationId_=e,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=r,this.authTokenProvider_=s,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=Rt.nextPersistentConnectionId_++,this.log_=I("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Pt,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!(0,o.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");Dt.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&pt.getInstance().on("online",this.onOnline_,this)}sendRequest(t,e,n){const i=++this.requestNumber_,r={r:i,a:t,b:e};this.log_((0,o.Pz)(r)),(0,o.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[i]=n)}get(t){this.initConnection_();const e=new o.BH,n={p:t._path.toString(),q:t._queryObject},i={action:"g",request:n,onComplete:t=>{const i=t.d;"ok"===t.s?(this.onDataUpdate_(n.p,i,!1,null),e.resolve(i)):e.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const r=this.outstandingGets_.length-1;return this.connected_||setTimeout((()=>{const t=this.outstandingGets_[r];void 0!==t&&i===t&&(delete this.outstandingGets_[r],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),this.log_("get "+r+" timed out on connection"),e.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(r),e.promise}listen(t,e,n,i){this.initConnection_();const r=t._queryIdentifier,s=t._path.toString();this.log_("Listen called for "+s+" "+r),this.listens.has(s)||this.listens.set(s,new Map),(0,o.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,o.hu)(!this.listens.get(s).has(r),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:e,query:t,tag:n};this.listens.get(s).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(t){const e=this.outstandingGets_[t];this.sendRequest("g",e.request,(n=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),e.onComplete&&e.onComplete(n)}))}sendListen_(t){const e=t.query,n=e._path.toString(),i=e._queryIdentifier;this.log_("Listen on "+n+" for "+i);const r={p:n};t.tag&&(r.q=e._queryObject,r.t=t.tag),r.h=t.hashFn(),this.sendRequest("q",r,(r=>{const s=r.d,o=r.s;Rt.warnOnListenWarnings_(s,e);(this.listens.get(n)&&this.listens.get(n).get(i))===t&&(this.log_("listen response",r),"ok"!==o&&this.removeListen_(n,i),t.onComplete&&t.onComplete(o,s))}))}static warnOnListenWarnings_(t,e){if(t&&"object"===typeof t&&(0,o.r3)(t,"w")){const n=(0,o.DV)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const t='".indexOn": "'+e._queryParams.getIndex().toString()+'"',n=e._path.toString();N(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${t} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,o.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,e=(0,o.w9)(t)?"auth":"gauth",n={cred:t};null===this.authOverride_?n.noauth=!0:"object"===typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(e,n,(e=>{const n=e.s,i=e.d||"error";this.authToken_===t&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(t=>{const e=t.s,n=t.d||"error";"ok"===e?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(e,n)}))}unlisten(t,e){const n=t._path.toString(),i=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+i),(0,o.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");this.removeListen_(n,i)&&this.connected_&&this.sendUnlisten_(n,i,t._queryObject,e)}sendUnlisten_(t,e,n,i){this.log_("Unlisten on "+t+" for "+e);const r={p:t};i&&(r.q=n,r.t=i),this.sendRequest("n",r)}onDisconnectPut(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})}onDisconnectMerge(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})}onDisconnectCancel(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})}sendOnDisconnect_(t,e,n,i){const r={p:e,d:n};this.log_("onDisconnect "+t,r),this.sendRequest(t,r,(t=>{i&&setTimeout((()=>{i(t.s,t.d)}),Math.floor(0))}))}put(t,e,n,i){this.putInternal("p",t,e,n,i)}merge(t,e,n,i){this.putInternal("m",t,e,n,i)}putInternal(t,e,n,i,r){this.initConnection_();const s={p:e,d:n};void 0!==r&&(s.h=r),this.outstandingPuts_.push({action:t,request:s,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+e)}sendPut_(t){const e=this.outstandingPuts_[t].action,n=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(e,n,(n=>{this.log_(e+" response",n),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)}))}reportStats(t){if(this.connected_){const e={c:t};this.log_("reportStats",e),this.sendRequest("s",e,(t=>{if("ok"!==t.s){const e=t.d;this.log_("reportStats","Error sending stats: "+e)}}))}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,o.Pz)(t));const e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):S("Unrecognized action received from server: "+(0,o.Pz)(t)+"\nAre you using the latest client?")}onReady_(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,o.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Pt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Pt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Pt),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),e=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Rt.nextConnectionId_++,r=this.lastSessionId;let s=!1,a=null;const c=function(){a?a.close():(s=!0,n())},u=function(t){(0,o.hu)(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(t)};this.realtime_={close:c,sendRequest:u};const l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[o,c]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);s?T("getToken() completed but was canceled"):(T("getToken() completed. Creating connection."),this.authToken_=o&&o.accessToken,this.appCheckToken_=c&&c.token,a=new ht(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,e,n,(t=>{N(t+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),r))}catch(S){this.log_("Failed to get token: "+S),s||(this.repoInfo_.nodeAdmin&&N(S),c())}}}interrupt(t){T("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){T("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,o.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Pt,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,e){let n;n=e?e.map((t=>M(t))).join("$"):"default";const i=this.removeListen_(t,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(t,e){const n=new gt(t).toString();let i;if(this.listens.has(n)){const t=this.listens.get(n);i=t.get(e),t.delete(e),0===t.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(t,e){T("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,e){T("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const e of t.values())this.sendListen_(e);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let e="js";(0,o.Yr)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+h.replace(/\./g,"-")]=1,(0,o.uI)()?t["framework.cordova"]=1:(0,o.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=pt.getInstance().currentlyOnline();return(0,o.xb)(this.interruptReasons_)&&t}}Rt.nextPersistentConnectionId_=0,Rt.nextConnectionId_=0;class Ot{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new Ot(t,e)}}class Mt{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const n=new Ot(x,t),i=new Ot(x,e);return 0!==this.compare(n,i)}minPost(){return Ot.MIN}}let Lt;class Ft extends Mt{static get __EMPTY_NODE(){return Lt}static set __EMPTY_NODE(t){Lt=t}compare(t,e){return P(t.name,e.name)}isDefinedOn(t){throw(0,o.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return Ot.MIN}maxPost(){return new Ot(D,Lt)}makePost(t,e){return(0,o.hu)("string"===typeof t,"KeyIndex indexValue must always be a string."),new Ot(t,Lt)}toString(){return".key"}}const jt=new Ft;class Vt{constructor(t,e,n,i,r=null){this.isReverse_=i,this.resultGenerator_=r,this.nodeStack_=[];let s=1;for(;!t.isEmpty();)if(t=t,s=e?n(t.key,e):1,i&&(s*=-1),s<0)t=this.isReverse_?t.left:t.right;else{if(0===s){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class Ut{constructor(t,e,n,i,r){this.key=t,this.value=e,this.color=null!=n?n:Ut.RED,this.left=null!=i?i:qt.EMPTY_NODE,this.right=null!=r?r:qt.EMPTY_NODE}copy(t,e,n,i,r){return new Ut(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=r?r:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const r=n(t,i.key);return i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return qt.EMPTY_NODE;let t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,e){let n,i;if(n=this,e(t,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return qt.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,Ut.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,Ut.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}Ut.RED=!0,Ut.BLACK=!1;class qt{constructor(t,e=qt.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new qt(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,Ut.BLACK,null,null))}remove(t){return new qt(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Ut.BLACK,null,null))}get(t){let e,n=this.root_;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e)return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null}getPredecessorKey(t){let e,n=this.root_,i=null;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new Vt(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new Vt(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new Vt(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new Vt(this.root_,null,this.comparator_,!0,t)}}function Bt(t,e){return P(t.name,e.name)}function $t(t,e){return P(t,e)}let zt;qt.EMPTY_NODE=new class{copy(t,e,n,i,r){return this}insert(t,e,n){return new Ut(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Ht=function(t){return"number"===typeof t?"number:"+j(t):"string:"+t},Kt=function(t){if(t.isLeafNode()){const e=t.val();(0,o.hu)("string"===typeof e||"number"===typeof e||"object"===typeof e&&(0,o.r3)(e,".sv"),"Priority must be a string or number.")}else(0,o.hu)(t===zt||t.isEmpty(),"priority of unexpected type.");(0,o.hu)(t===zt||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Wt,Gt,Yt;class Qt{constructor(t,e=Qt.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=e,this.lazyHash_=null,(0,o.hu)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Kt(this.priorityNode_)}static set __childrenNodeConstructor(t){Wt=t}static get __childrenNodeConstructor(){return Wt}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new Qt(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:Qt.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Tt(t)?this:".priority"===yt(t)?this.priorityNode_:Qt.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,e){return null}updateImmediateChild(t,e){return".priority"===t?this.updatePriority(e):e.isEmpty()&&".priority"!==t?this:Qt.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,e).updatePriority(this.priorityNode_)}updateChild(t,e){const n=yt(t);return null===n?e:e.isEmpty()&&".priority"!==n?this:((0,o.hu)(".priority"!==n||1===vt(t),".priority must be the last token in a path"),this.updateImmediateChild(n,Qt.__childrenNodeConstructor.EMPTY_NODE.updateChild(_t(t),e)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,e){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Ht(this.priorityNode_.val())+":");const e=typeof this.value_;t+=e+":",t+="number"===e?j(this.value_):this.value_,this.lazyHash_=_(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===Qt.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof Qt.__childrenNodeConstructor?-1:((0,o.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const e=typeof t.value_,n=typeof this.value_,i=Qt.VALUE_TYPE_ORDER.indexOf(e),r=Qt.VALUE_TYPE_ORDER.indexOf(n);return(0,o.hu)(i>=0,"Unknown leaf type: "+e),(0,o.hu)(r>=0,"Unknown leaf type: "+n),i===r?"object"===n?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:r-i}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1}}Qt.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Xt=new class extends Mt{compare(t,e){const n=t.node.getPriority(),i=e.node.getPriority(),r=n.compareTo(i);return 0===r?P(t.name,e.name):r}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return Ot.MIN}maxPost(){return new Ot(D,new Qt("[PRIORITY-POST]",Yt))}makePost(t,e){const n=Gt(t);return new Ot(e,new Qt("[PRIORITY-POST]",n))}toString(){return".priority"}},Jt=Math.log(2);class Zt{constructor(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Jt,10)),this.current_=this.count-1;const n=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=t+1&n}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const te=function(t,e,n,i){t.sort(e);const r=function(e,i){const s=i-e;let o,a;if(0===s)return null;if(1===s)return o=t[e],a=n?n(o):o,new Ut(a,o.node,Ut.BLACK,null,null);{const c=parseInt(s/2,10)+e,u=r(e,c),l=r(c+1,i);return o=t[c],a=n?n(o):o,new Ut(a,o.node,Ut.BLACK,u,l)}},s=function(e){let i=null,s=null,o=t.length;const a=function(e,i){const s=o-e,a=o;o-=e;const u=r(s+1,a),l=t[s],h=n?n(l):l;c(new Ut(h,l.node,i,null,u))},c=function(t){i?(i.left=t,i=t):(s=t,i=t)};for(let t=0;t<e.count;++t){const n=e.nextBitIsOne(),i=Math.pow(2,e.count-(t+1));n?a(i,Ut.BLACK):(a(i,Ut.BLACK),a(i,Ut.RED))}return s}(new Zt(t.length));return new qt(i||e,s)};let ee;const ne={};class ie{constructor(t,e){this.indexes_=t,this.indexSet_=e}static get Default(){return(0,o.hu)(ne&&Xt,"ChildrenNode.ts has not been loaded"),ee=ee||new ie({".priority":ne},{".priority":Xt}),ee}get(t){const e=(0,o.DV)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof qt?e:null}hasIndex(t){return(0,o.r3)(this.indexSet_,t.toString())}addIndex(t,e){(0,o.hu)(t!==jt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const n=[];let i=!1;const r=e.getIterator(Ot.Wrap);let s,a=r.getNext();for(;a;)i=i||t.isDefinedOn(a.node),n.push(a),a=r.getNext();s=i?te(n,t.getCompare()):ne;const c=t.toString(),u=Object.assign({},this.indexSet_);u[c]=t;const l=Object.assign({},this.indexes_);return l[c]=s,new ie(l,u)}addToIndexes(t,e){const n=(0,o.UI)(this.indexes_,((n,i)=>{const r=(0,o.DV)(this.indexSet_,i);if((0,o.hu)(r,"Missing index implementation for "+i),n===ne){if(r.isDefinedOn(t.node)){const n=[],i=e.getIterator(Ot.Wrap);let s=i.getNext();for(;s;)s.name!==t.name&&n.push(s),s=i.getNext();return n.push(t),te(n,r.getCompare())}return ne}{const i=e.get(t.name);let r=n;return i&&(r=r.remove(new Ot(t.name,i))),r.insert(t,t.node)}}));return new ie(n,this.indexSet_)}removeFromIndexes(t,e){const n=(0,o.UI)(this.indexes_,(n=>{if(n===ne)return n;{const i=e.get(t.name);return i?n.remove(new Ot(t.name,i)):n}}));return new ie(n,this.indexSet_)}}let re;class se{constructor(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Kt(this.priorityNode_),this.children_.isEmpty()&&(0,o.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return re||(re=new se(new qt($t),null,ie.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||re}updatePriority(t){return this.children_.isEmpty()?this:new se(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const e=this.children_.get(t);return null===e?re:e}}getChild(t){const e=yt(t);return null===e?this:this.getImmediateChild(e).getChild(_t(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,e){if((0,o.hu)(e,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(e);{const n=new Ot(t,e);let i,r;e.isEmpty()?(i=this.children_.remove(t),r=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(t,e),r=this.indexMap_.addToIndexes(n,this.children_));const s=i.isEmpty()?re:this.priorityNode_;return new se(i,s,r)}}updateChild(t,e){const n=yt(t);if(null===n)return e;{(0,o.hu)(".priority"!==yt(t)||1===vt(t),".priority must be the last token in a path");const i=this.getImmediateChild(n).updateChild(_t(t),e);return this.updateImmediateChild(n,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const e={};let n=0,i=0,r=!0;if(this.forEachChild(Xt,((s,o)=>{e[s]=o.val(t),n++,r&&se.INTEGER_REGEXP_.test(s)?i=Math.max(i,Number(s)):r=!1})),!t&&r&&i<2*n){const t=[];for(const n in e)t[n]=e[n];return t}return t&&!this.getPriority().isEmpty()&&(e[".priority"]=this.getPriority().val()),e}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+Ht(this.getPriority().val())+":"),this.forEachChild(Xt,((e,n)=>{const i=n.hash();""!==i&&(t+=":"+e+":"+i)})),this.lazyHash_=""===t?"":_(t)}return this.lazyHash_}getPredecessorChildName(t,e,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new Ot(t,e));return n?n.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.minKey();return t&&t.name}return this.children_.minKey()}getFirstChild(t){const e=this.getFirstChildName(t);return e?new Ot(e,this.children_.get(e)):null}getLastChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.maxKey();return t&&t.name}return this.children_.maxKey()}getLastChild(t){const e=this.getLastChildName(t);return e?new Ot(e,this.children_.get(e)):null}forEachChild(t,e){const n=this.resolveIndex_(t);return n?n.inorderTraversal((t=>e(t.name,t.node))):this.children_.inorderTraversal(e)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(t=>t));{const n=this.children_.getIteratorFrom(t.name,Ot.Wrap);let i=n.peek();for(;null!=i&&e.compare(i,t)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(t=>t));{const n=this.children_.getReverseIteratorFrom(t.name,Ot.Wrap);let i=n.peek();for(;null!=i&&e.compare(i,t)>0;)n.getNext(),i=n.peek();return n}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===oe?-1:0}withIndex(t){if(t===jt||this.indexMap_.hasIndex(t))return this;{const e=this.indexMap_.addIndex(t,this.children_);return new se(this.children_,this.priorityNode_,e)}}isIndexed(t){return t===jt||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){const t=this.getIterator(Xt),n=e.getIterator(Xt);let i=t.getNext(),r=n.getNext();for(;i&&r;){if(i.name!==r.name||!i.node.equals(r.node))return!1;i=t.getNext(),r=n.getNext()}return null===i&&null===r}return!1}return!1}}resolveIndex_(t){return t===jt?null:this.indexMap_.get(t.toString())}}se.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const oe=new class extends se{constructor(){super(new qt($t),se.EMPTY_NODE,ie.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return se.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Ot,{MIN:{value:new Ot(x,se.EMPTY_NODE)},MAX:{value:new Ot(D,oe)}}),Ft.__EMPTY_NODE=se.EMPTY_NODE,Qt.__childrenNodeConstructor=se,zt=oe,function(t){Yt=t}(oe);function ae(t,e=null){if(null===t)return se.EMPTY_NODE;if("object"===typeof t&&".priority"in t&&(e=t[".priority"]),(0,o.hu)(null===e||"string"===typeof e||"number"===typeof e||"object"===typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"===typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!==typeof t||".sv"in t){return new Qt(t,ae(e))}if(t instanceof Array){let n=se.EMPTY_NODE;return F(t,((e,i)=>{if((0,o.r3)(t,e)&&"."!==e.substring(0,1)){const t=ae(i);!t.isLeafNode()&&t.isEmpty()||(n=n.updateImmediateChild(e,t))}})),n.updatePriority(ae(e))}{const n=[];let i=!1;if(F(t,((t,e)=>{if("."!==t.substring(0,1)){const r=ae(e);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),n.push(new Ot(t,r)))}})),0===n.length)return se.EMPTY_NODE;const r=te(n,Bt,(t=>t.name),$t);if(i){const t=te(n,Xt.getCompare());return new se(r,ae(e),new ie({".priority":t},{".priority":Xt}))}return new se(r,ae(e),ie.Default)}}!function(t){Gt=t}(ae);class ce extends Mt{constructor(t){super(),this.indexPath_=t,(0,o.hu)(!Tt(t)&&".priority"!==yt(t),"Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const n=this.extractChild(t.node),i=this.extractChild(e.node),r=n.compareTo(i);return 0===r?P(t.name,e.name):r}makePost(t,e){const n=ae(t),i=se.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ot(e,i)}maxPost(){const t=se.EMPTY_NODE.updateChild(this.indexPath_,oe);return new Ot(D,t)}toString(){return bt(this.indexPath_,0).join("/")}}const ue=new class extends Mt{compare(t,e){const n=t.node.compareTo(e.node);return 0===n?P(t.name,e.name):n}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return Ot.MIN}maxPost(){return Ot.MAX}makePost(t,e){const n=ae(t);return new Ot(e,n)}toString(){return".value"}},le="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";!function(){let t=0;const e=[]}();function he(t){return{type:"value",snapshotNode:t}}function de(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function fe(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function pe(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}class ge{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Xt}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:x}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:D}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,o.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Xt}copy(){const t=new ge;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function me(t){const e={};if(t.isDefault())return e;let n;return t.index_===Xt?n="$priority":t.index_===ue?n="$value":t.index_===jt?n="$key":((0,o.hu)(t.index_ instanceof ce,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=(0,o.Pz)(n),t.startSet_&&(e.startAt=(0,o.Pz)(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+(0,o.Pz)(t.indexStartName_))),t.endSet_&&(e.endAt=(0,o.Pz)(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+(0,o.Pz)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function ye(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==Xt&&(e.i=t.index_.toString()),e}class ve extends dt{constructor(t,e,n,i){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=I("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,e){return void 0!==e?"tag$"+e:((0,o.hu)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,e,n,i){const r=t._path.toString();this.log_("Listen called for "+r+" "+t._queryIdentifier);const s=ve.getListenId_(t,n),a={};this.listens_[s]=a;const c=me(t._queryParams);this.restRequest_(r+".json",c,((t,e)=>{let c=e;if(404===t&&(c=null,t=null),null===t&&this.onDataUpdate_(r,c,!1,n),(0,o.DV)(this.listens_,s)===a){let e;e=t?401===t?"permission_denied":"rest_error:"+t:"ok",i(e,null)}}))}unlisten(t,e){const n=ve.getListenId_(t,e);delete this.listens_[n]}get(t){const e=me(t._queryParams),n=t._path.toString(),i=new o.BH;return this.restRequest_(n+".json",e,((t,e)=>{let r=e;404===t&&(r=null,t=null),null===t?(this.onDataUpdate_(n,r,!1,null),i.resolve(r)):i.reject(new Error(r))})),i.promise}refreshAuthToken(t){}restRequest_(t,e={},n){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([i,r])=>{i&&i.accessToken&&(e.auth=i.accessToken),r&&r.token&&(e.ac=r.token);const s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+(0,o.xO)(e);this.log_("Sending REST request for "+s);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(n&&4===a.readyState){this.log_("REST Response for "+s+" received. status:",a.status,"response:",a.responseText);let e=null;if(a.status>=200&&a.status<300){try{e=(0,o.cI)(a.responseText)}catch(t){N("Failed to parse JSON response for "+s+": "+a.responseText)}n(null,e)}else 401!==a.status&&404!==a.status&&N("Got unsuccessful REST response for "+s+" Status: "+a.status),n(a.status);n=null}},a.open("GET",s,!0),a.send()}))}}class _e{constructor(){this.rootNode_=se.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}function we(){return{value:null,children:new Map}}function be(t,e,n){if(Tt(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{const i=yt(e);t.children.has(i)||t.children.set(i,we());be(t.children.get(i),e=_t(e),n)}}function Ee(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach(((t,n)=>{e(n,t)}))}(t,((t,i)=>{Ee(i,new gt(e.toString()+"/"+t),n)}))}class Ce{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&F(this.last_,((t,n)=>{e[t]=e[t]-n})),this.last_=t,e}}class Te{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Ce(t);const n=1e4+2e4*Math.random();z(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const t=this.statsListener_.get(),e={};let n=!1;F(t,((t,i)=>{i>0&&(0,o.r3)(this.statsToReport_,t)&&(e[t]=i,n=!0)})),n&&this.server_.reportStats(e),z(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Ie;function Se(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Ie||(Ie={}));class ke{constructor(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Ie.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(Tt(this.path)){if(null!=this.affectedTree.value)return(0,o.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new gt(t));return new ke(mt(),e,this.revert)}}return(0,o.hu)(yt(this.path)===t,"operationForChild called for unrelated child."),new ke(_t(this.path),this.affectedTree,this.revert)}}class Ne{constructor(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Ie.OVERWRITE}operationForChild(t){return Tt(this.path)?new Ne(this.source,mt(),this.snap.getImmediateChild(t)):new Ne(this.source,_t(this.path),this.snap)}}class Ae{constructor(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Ie.MERGE}operationForChild(t){if(Tt(this.path)){const e=this.children.subtree(new gt(t));return e.isEmpty()?null:e.value?new Ne(this.source,mt(),e.value):new Ae(this.source,mt(),e)}return(0,o.hu)(yt(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new Ae(this.source,_t(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class xe{constructor(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(Tt(t))return this.isFullyInitialized()&&!this.filtered_;const e=yt(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}function De(t,e,n,i,r,s){const a=i.filter((t=>t.type===n));a.sort(((e,n)=>function(t,e,n){if(null==e.childName||null==n.childName)throw(0,o.g5)("Should only compare child_ events.");const i=new Ot(e.childName,e.snapshotNode),r=new Ot(n.childName,n.snapshotNode);return t.index_.compare(i,r)}(t,e,n))),a.forEach((n=>{const i=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,s);r.forEach((r=>{r.respondsTo(n.type)&&e.push(r.createEvent(i,t.query_))}))}))}function Pe(t,e){return{eventCache:t,serverCache:e}}function Re(t,e,n,i){return Pe(new xe(e,n,i),t.serverCache)}function Oe(t,e,n,i){return Pe(t.eventCache,new xe(e,n,i))}function Me(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Le(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let Fe;class je{constructor(t,e=(()=>(Fe||(Fe=new qt(R)),Fe))()){this.value=t,this.children=e}static fromObject(t){let e=new je(null);return F(t,((t,n)=>{e=e.set(new gt(t),n)})),e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(null!=this.value&&e(this.value))return{path:mt(),value:this.value};if(Tt(t))return null;{const n=yt(t),i=this.children.get(n);if(null!==i){const r=i.findRootMostMatchingPathAndValue(_t(t),e);if(null!=r){return{path:Ct(new gt(n),r.path),value:r.value}}return null}return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,(()=>!0))}subtree(t){if(Tt(t))return this;{const e=yt(t),n=this.children.get(e);return null!==n?n.subtree(_t(t)):new je(null)}}set(t,e){if(Tt(t))return new je(e,this.children);{const n=yt(t),i=(this.children.get(n)||new je(null)).set(_t(t),e),r=this.children.insert(n,i);return new je(this.value,r)}}remove(t){if(Tt(t))return this.children.isEmpty()?new je(null):new je(null,this.children);{const e=yt(t),n=this.children.get(e);if(n){const i=n.remove(_t(t));let r;return r=i.isEmpty()?this.children.remove(e):this.children.insert(e,i),null===this.value&&r.isEmpty()?new je(null):new je(this.value,r)}return this}}get(t){if(Tt(t))return this.value;{const e=yt(t),n=this.children.get(e);return n?n.get(_t(t)):null}}setTree(t,e){if(Tt(t))return e;{const n=yt(t),i=(this.children.get(n)||new je(null)).setTree(_t(t),e);let r;return r=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new je(this.value,r)}}fold(t){return this.fold_(mt(),t)}fold_(t,e){const n={};return this.children.inorderTraversal(((i,r)=>{n[i]=r.fold_(Ct(t,i),e)})),e(t,this.value,n)}findOnPath(t,e){return this.findOnPath_(t,mt(),e)}findOnPath_(t,e,n){const i=!!this.value&&n(e,this.value);if(i)return i;if(Tt(t))return null;{const i=yt(t),r=this.children.get(i);return r?r.findOnPath_(_t(t),Ct(e,i),n):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,mt(),e)}foreachOnPath_(t,e,n){if(Tt(t))return this;{this.value&&n(e,this.value);const i=yt(t),r=this.children.get(i);return r?r.foreachOnPath_(_t(t),Ct(e,i),n):new je(null)}}foreach(t){this.foreach_(mt(),t)}foreach_(t,e){this.children.inorderTraversal(((n,i)=>{i.foreach_(Ct(t,n),e)})),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal(((e,n)=>{n.value&&t(e,n.value)}))}}class Ve{constructor(t){this.writeTree_=t}static empty(){return new Ve(new je(null))}}function Ue(t,e,n){if(Tt(e))return new Ve(new je(n));{const i=t.writeTree_.findRootMostValueAndPath(e);if(null!=i){const r=i.path;let s=i.value;const o=It(r,e);return s=s.updateChild(o,n),new Ve(t.writeTree_.set(r,s))}{const i=new je(n),r=t.writeTree_.setTree(e,i);return new Ve(r)}}}function qe(t,e,n){let i=t;return F(n,((t,n)=>{i=Ue(i,Ct(e,t),n)})),i}function Be(t,e){if(Tt(e))return Ve.empty();{const n=t.writeTree_.setTree(e,new je(null));return new Ve(n)}}function $e(t,e){return null!=ze(t,e)}function ze(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(It(n.path,e)):null}function He(t){const e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Xt,((t,n)=>{e.push(new Ot(t,n))})):t.writeTree_.children.inorderTraversal(((t,n)=>{null!=n.value&&e.push(new Ot(t,n.value))})),e}function Ke(t,e){if(Tt(e))return t;{const n=ze(t,e);return new Ve(null!=n?new je(n):t.writeTree_.subtree(e))}}function We(t){return t.writeTree_.isEmpty()}function Ge(t,e){return Ye(mt(),t.writeTree_,e)}function Ye(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);{let i=null;return e.children.inorderTraversal(((e,r)=>{".priority"===e?((0,o.hu)(null!==r.value,"Priority writes must always be leaf nodes"),i=r.value):n=Ye(Ct(t,e),r,n)})),n.getChild(t).isEmpty()||null===i||(n=n.updateChild(Ct(t,".priority"),i)),n}}function Qe(t,e){return ln(e,t)}function Xe(t,e){const n=t.allWrites.findIndex((t=>t.writeId===e));(0,o.hu)(n>=0,"removeWrite called with nonexistent writeId.");const i=t.allWrites[n];t.allWrites.splice(n,1);let r=i.visible,s=!1,a=t.allWrites.length-1;for(;r&&a>=0;){const e=t.allWrites[a];e.visible&&(a>=n&&Je(e,i.path)?r=!1:kt(i.path,e.path)&&(s=!0)),a--}if(r){if(s)return function(t){t.visibleWrites=tn(t.allWrites,Ze,mt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0;if(i.snap)t.visibleWrites=Be(t.visibleWrites,i.path);else{F(i.children,(e=>{t.visibleWrites=Be(t.visibleWrites,Ct(i.path,e))}))}return!0}return!1}function Je(t,e){if(t.snap)return kt(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&kt(Ct(t.path,n),e))return!0;return!1}function Ze(t){return t.visible}function tn(t,e,n){let i=Ve.empty();for(let r=0;r<t.length;++r){const s=t[r];if(e(s)){const t=s.path;let e;if(s.snap)kt(n,t)?(e=It(n,t),i=Ue(i,e,s.snap)):kt(t,n)&&(e=It(t,n),i=Ue(i,mt(),s.snap.getChild(e)));else{if(!s.children)throw(0,o.g5)("WriteRecord should have .snap or .children");if(kt(n,t))e=It(n,t),i=qe(i,e,s.children);else if(kt(t,n))if(e=It(t,n),Tt(e))i=qe(i,mt(),s.children);else{const t=(0,o.DV)(s.children,yt(e));if(t){const n=t.getChild(_t(e));i=Ue(i,mt(),n)}}}}}return i}function en(t,e,n,i,r){if(i||r){const s=Ke(t.visibleWrites,e);if(!r&&We(s))return n;if(r||null!=n||$e(s,mt())){const s=function(t){return(t.visible||r)&&(!i||!~i.indexOf(t.writeId))&&(kt(t.path,e)||kt(e,t.path))};return Ge(tn(t.allWrites,s,e),n||se.EMPTY_NODE)}return null}{const i=ze(t.visibleWrites,e);if(null!=i)return i;{const i=Ke(t.visibleWrites,e);if(We(i))return n;if(null!=n||$e(i,mt())){return Ge(i,n||se.EMPTY_NODE)}return null}}}function nn(t,e,n,i){return en(t.writeTree,t.treePath,e,n,i)}function rn(t,e){return function(t,e,n){let i=se.EMPTY_NODE;const r=ze(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(Xt,((t,e)=>{i=i.updateImmediateChild(t,e)})),i;if(n){const r=Ke(t.visibleWrites,e);return n.forEachChild(Xt,((t,e)=>{const n=Ge(Ke(r,new gt(t)),e);i=i.updateImmediateChild(t,n)})),He(r).forEach((t=>{i=i.updateImmediateChild(t.name,t.node)})),i}return He(Ke(t.visibleWrites,e)).forEach((t=>{i=i.updateImmediateChild(t.name,t.node)})),i}(t.writeTree,t.treePath,e)}function sn(t,e,n,i){return function(t,e,n,i,r){(0,o.hu)(i||r,"Either existingEventSnap or existingServerSnap must exist");const s=Ct(e,n);if($e(t.visibleWrites,s))return null;{const e=Ke(t.visibleWrites,s);return We(e)?r.getChild(n):Ge(e,r.getChild(n))}}(t.writeTree,t.treePath,e,n,i)}function on(t,e){return function(t,e){return ze(t.visibleWrites,e)}(t.writeTree,Ct(t.treePath,e))}function an(t,e,n,i,r,s){return function(t,e,n,i,r,s,o){let a;const c=Ke(t.visibleWrites,e),u=ze(c,mt());if(null!=u)a=u;else{if(null==n)return[];a=Ge(c,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const t=[],e=o.getCompare(),n=s?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let c=n.getNext();for(;c&&t.length<r;)0!==e(c,i)&&t.push(c),c=n.getNext();return t}}(t.writeTree,t.treePath,e,n,i,r,s)}function cn(t,e,n){return function(t,e,n,i){const r=Ct(e,n),s=ze(t.visibleWrites,r);if(null!=s)return s;if(i.isCompleteForChild(n))return Ge(Ke(t.visibleWrites,r),i.getNode().getImmediateChild(n));return null}(t.writeTree,t.treePath,e,n)}function un(t,e){return ln(Ct(t.treePath,e),t.writeTree)}function ln(t,e){return{treePath:t,writeTree:e}}class hn{constructor(){this.changeMap=new Map}trackChildChange(t){const e=t.type,n=t.childName;(0,o.hu)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,o.hu)(".priority"!==n,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(n);if(i){const r=i.type;if("child_added"===e&&"child_removed"===r)this.changeMap.set(n,pe(n,t.snapshotNode,i.snapshotNode));else if("child_removed"===e&&"child_added"===r)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===r)this.changeMap.set(n,fe(n,i.oldSnap));else if("child_changed"===e&&"child_added"===r)this.changeMap.set(n,de(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==r)throw(0,o.g5)("Illegal combination of changes: "+t+" occurred after "+i);this.changeMap.set(n,pe(n,t.snapshotNode,i.oldSnap))}}else this.changeMap.set(n,t)}getChanges(){return Array.from(this.changeMap.values())}}const dn=new class{getCompleteChild(t){return null}getChildAfterChild(t,e,n){return null}};class fn{constructor(t,e,n=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const e=null!=this.optCompleteServerCache_?new xe(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return cn(this.writes_,t,e)}}getChildAfterChild(t,e,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Le(this.viewCache_),r=an(this.writes_,i,e,1,n,t);return 0===r.length?null:r[0]}}function pn(t,e,n,i,r){const s=new hn;let a,c;if(n.type===Ie.OVERWRITE){const u=n;u.source.fromUser?a=yn(t,e,u.path,u.snap,i,r,s):((0,o.hu)(u.source.fromServer,"Unknown source."),c=u.source.tagged||e.serverCache.isFiltered()&&!Tt(u.path),a=mn(t,e,u.path,u.snap,i,r,c,s))}else if(n.type===Ie.MERGE){const u=n;u.source.fromUser?a=function(t,e,n,i,r,s,o){let a=e;return i.foreach(((i,c)=>{const u=Ct(n,i);vn(e,yt(u))&&(a=yn(t,a,u,c,r,s,o))})),i.foreach(((i,c)=>{const u=Ct(n,i);vn(e,yt(u))||(a=yn(t,a,u,c,r,s,o))})),a}(t,e,u.path,u.children,i,r,s):((0,o.hu)(u.source.fromServer,"Unknown source."),c=u.source.tagged||e.serverCache.isFiltered(),a=wn(t,e,u.path,u.children,i,r,c,s))}else if(n.type===Ie.ACK_USER_WRITE){const c=n;a=c.revert?function(t,e,n,i,r,s){let a;if(null!=on(i,n))return e;{const c=new fn(i,e,r),u=e.eventCache.getNode();let l;if(Tt(n)||".priority"===yt(n)){let n;if(e.serverCache.isFullyInitialized())n=nn(i,Le(e));else{const t=e.serverCache.getNode();(0,o.hu)(t instanceof se,"serverChildren would be complete if leaf node"),n=rn(i,t)}n=n,l=t.filter.updateFullNode(u,n,s)}else{const r=yt(n);let o=cn(i,r,e.serverCache);null==o&&e.serverCache.isCompleteForChild(r)&&(o=u.getImmediateChild(r)),l=null!=o?t.filter.updateChild(u,r,o,_t(n),c,s):e.eventCache.getNode().hasChild(r)?t.filter.updateChild(u,r,se.EMPTY_NODE,_t(n),c,s):u,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(a=nn(i,Le(e)),a.isLeafNode()&&(l=t.filter.updateFullNode(l,a,s)))}return a=e.serverCache.isFullyInitialized()||null!=on(i,mt()),Re(e,l,a,t.filter.filtersNodes())}}(t,e,c.path,i,r,s):function(t,e,n,i,r,s,o){if(null!=on(r,n))return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(null!=i.value){if(Tt(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return mn(t,e,n,c.getNode().getChild(n),r,s,a,o);if(Tt(n)){let i=new je(null);return c.getNode().forEachChild(jt,((t,e)=>{i=i.set(new gt(t),e)})),wn(t,e,n,i,r,s,a,o)}return e}{let u=new je(null);return i.foreach(((t,e)=>{const i=Ct(n,t);c.isCompleteForPath(i)&&(u=u.set(t,c.getNode().getChild(i)))})),wn(t,e,n,u,r,s,a,o)}}(t,e,c.path,c.affectedTree,i,r,s)}else{if(n.type!==Ie.LISTEN_COMPLETE)throw(0,o.g5)("Unknown operation type: "+n.type);a=function(t,e,n,i,r){const s=e.serverCache,o=Oe(e,s.getNode(),s.isFullyInitialized()||Tt(n),s.isFiltered());return gn(t,o,n,i,dn,r)}(t,e,n.path,i,s)}const u=s.getChanges();return function(t,e,n){const i=e.eventCache;if(i.isFullyInitialized()){const r=i.getNode().isLeafNode()||i.getNode().isEmpty(),s=Me(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!i.getNode().equals(s)||!i.getNode().getPriority().equals(s.getPriority()))&&n.push(he(Me(e)))}}(e,a,u),{viewCache:a,changes:u}}function gn(t,e,n,i,r,s){const a=e.eventCache;if(null!=on(i,n))return e;{let c,u;if(Tt(n))if((0,o.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const n=Le(e),r=rn(i,n instanceof se?n:se.EMPTY_NODE);c=t.filter.updateFullNode(e.eventCache.getNode(),r,s)}else{const n=nn(i,Le(e));c=t.filter.updateFullNode(e.eventCache.getNode(),n,s)}else{const l=yt(n);if(".priority"===l){(0,o.hu)(1===vt(n),"Can't have a priority with additional path components");const r=a.getNode();u=e.serverCache.getNode();const s=sn(i,n,r,u);c=null!=s?t.filter.updatePriority(r,s):a.getNode()}else{const o=_t(n);let h;if(a.isCompleteForChild(l)){u=e.serverCache.getNode();const t=sn(i,n,a.getNode(),u);h=null!=t?a.getNode().getImmediateChild(l).updateChild(o,t):a.getNode().getImmediateChild(l)}else h=cn(i,l,e.serverCache);c=null!=h?t.filter.updateChild(a.getNode(),l,h,o,r,s):a.getNode()}}return Re(e,c,a.isFullyInitialized()||Tt(n),t.filter.filtersNodes())}}function mn(t,e,n,i,r,s,o,a){const c=e.serverCache;let u;const l=o?t.filter:t.filter.getIndexedFilter();if(Tt(n))u=l.updateFullNode(c.getNode(),i,null);else if(l.filtersNodes()&&!c.isFiltered()){const t=c.getNode().updateChild(n,i);u=l.updateFullNode(c.getNode(),t,null)}else{const t=yt(n);if(!c.isCompleteForPath(n)&&vt(n)>1)return e;const r=_t(n),s=c.getNode().getImmediateChild(t).updateChild(r,i);u=".priority"===t?l.updatePriority(c.getNode(),s):l.updateChild(c.getNode(),t,s,r,dn,null)}const h=Oe(e,u,c.isFullyInitialized()||Tt(n),l.filtersNodes());return gn(t,h,n,r,new fn(r,h,s),a)}function yn(t,e,n,i,r,s,o){const a=e.eventCache;let c,u;const l=new fn(r,e,s);if(Tt(n))u=t.filter.updateFullNode(e.eventCache.getNode(),i,o),c=Re(e,u,!0,t.filter.filtersNodes());else{const r=yt(n);if(".priority"===r)u=t.filter.updatePriority(e.eventCache.getNode(),i),c=Re(e,u,a.isFullyInitialized(),a.isFiltered());else{const s=_t(n),u=a.getNode().getImmediateChild(r);let h;if(Tt(s))h=i;else{const t=l.getCompleteChild(r);h=null!=t?".priority"===wt(s)&&t.getChild(Et(s)).isEmpty()?t:t.updateChild(s,i):se.EMPTY_NODE}if(u.equals(h))c=e;else{c=Re(e,t.filter.updateChild(a.getNode(),r,h,s,l,o),a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function vn(t,e){return t.eventCache.isCompleteForChild(e)}function _n(t,e,n){return n.foreach(((t,n)=>{e=e.updateChild(t,n)})),e}function wn(t,e,n,i,r,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c,u=e;c=Tt(n)?i:new je(null).setTree(n,i);const l=e.serverCache.getNode();return c.children.inorderTraversal(((n,i)=>{if(l.hasChild(n)){const c=_n(0,e.serverCache.getNode().getImmediateChild(n),i);u=mn(t,u,new gt(n),c,r,s,o,a)}})),c.children.inorderTraversal(((n,i)=>{const c=!e.serverCache.isCompleteForChild(n)&&void 0===i.value;if(!l.hasChild(n)&&!c){const c=_n(0,e.serverCache.getNode().getImmediateChild(n),i);u=mn(t,u,new gt(n),c,r,s,o,a)}})),u}function bn(t,e){const n=Le(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Tt(e)&&!n.getImmediateChild(yt(e)).isEmpty())?n.getChild(e):null}function En(t,e,n,i){e.type===Ie.MERGE&&null!==e.source.queryId&&((0,o.hu)(Le(t.viewCache_),"We should always have a full cache before handling merges"),(0,o.hu)(Me(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,s=pn(t.processor_,r,e,n,i);var a,c;return a=t.processor_,c=s.viewCache,(0,o.hu)(c.eventCache.getNode().isIndexed(a.filter.getIndex()),"Event snap not indexed"),(0,o.hu)(c.serverCache.getNode().isIndexed(a.filter.getIndex()),"Server snap not indexed"),(0,o.hu)(s.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,Cn(t,s.changes,s.viewCache.eventCache.getNode(),null)}function Cn(t,e,n,i){const r=i?[i]:t.eventRegistrations_;return function(t,e,n,i){const r=[],s=[];return e.forEach((e=>{var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&s.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),De(t,r,"child_removed",e,i,n),De(t,r,"child_added",e,i,n),De(t,r,"child_moved",s,i,n),De(t,r,"child_changed",e,i,n),De(t,r,"value",e,i,n),r}(t.eventGenerator_,e,n,r)}let Tn,In;function Sn(t,e,n,i){const r=e.source.queryId;if(null!==r){const s=t.views.get(r);return(0,o.hu)(null!=s,"SyncTree gave us an op for an invalid query."),En(s,e,n,i)}{let r=[];for(const s of t.views.values())r=r.concat(En(s,e,n,i));return r}}function kn(t,e){let n=null;for(const i of t.views.values())n=n||bn(i,e);return n}class Nn{constructor(t){this.listenProvider_=t,this.syncPointTree_=new je(null),this.pendingWriteTree_={visibleWrites:Ve.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function An(t,e,n,i,r){return function(t,e,n,i,r){(0,o.hu)(i>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:i,visible:r}),r&&(t.visibleWrites=Ue(t.visibleWrites,e,n)),t.lastWriteId=i}(t.pendingWriteTree_,e,n,i,r),r?Rn(t,new Ne({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function xn(t,e,n=!1){const i=function(t,e){for(let n=0;n<t.allWrites.length;n++){const i=t.allWrites[n];if(i.writeId===e)return i}return null}(t.pendingWriteTree_,e);if(Xe(t.pendingWriteTree_,e)){let e=new je(null);return null!=i.snap?e=e.set(mt(),!0):F(i.children,(t=>{e=e.set(new gt(t),!0)})),Rn(t,new ke(i.path,e,n))}return[]}function Dn(t,e,n){return Rn(t,new Ne({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function Pn(t,e,n){const i=t.pendingWriteTree_,r=t.syncPointTree_.findOnPath(e,((t,n)=>{const i=kn(n,It(t,e));if(i)return i}));return en(i,e,r,n,!0)}function Rn(t,e){return On(e,t.syncPointTree_,null,Qe(t.pendingWriteTree_,mt()))}function On(t,e,n,i){if(Tt(t.path))return Mn(t,e,n,i);{const r=e.get(mt());null==n&&null!=r&&(n=kn(r,mt()));let s=[];const o=yt(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){const t=n?n.getImmediateChild(o):null,e=un(i,o);s=s.concat(On(a,c,t,e))}return r&&(s=s.concat(Sn(r,t,i,n))),s}}function Mn(t,e,n,i){const r=e.get(mt());null==n&&null!=r&&(n=kn(r,mt()));let s=[];return e.children.inorderTraversal(((e,r)=>{const o=n?n.getImmediateChild(e):null,a=un(i,e),c=t.operationForChild(e);c&&(s=s.concat(Mn(c,r,o,a)))})),r&&(s=s.concat(Sn(r,t,i,n))),s}function Ln(t,e){return t.tagToQueryMap.get(e)}function Fn(t){const e=t.indexOf("$");return(0,o.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new gt(t.substr(0,e))}}function jn(t,e,n){const i=t.syncPointTree_.get(e);(0,o.hu)(i,"Missing sync point for query tag that we're tracking");return Sn(i,n,Qe(t.pendingWriteTree_,e),null)}class Vn{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new Vn(e)}node(){return this.node_}}class Un{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=Ct(this.path_,t);return new Un(this.syncTree_,e)}node(){return Pn(this.syncTree_,this.path_)}}const qn=function(t,e,n){return t&&"object"===typeof t?((0,o.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"===typeof t[".sv"]?Bn(t[".sv"],e,n):"object"===typeof t[".sv"]?$n(t[".sv"],e):void(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},Bn=function(t,e,n){if("timestamp"===t)return n.timestamp;(0,o.hu)(!1,"Unexpected server value: "+t)},$n=function(t,e,n){t.hasOwnProperty("increment")||(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const i=t.increment;"number"!==typeof i&&(0,o.hu)(!1,"Unexpected increment value: "+i);const r=e.node();if((0,o.hu)(null!==r&&"undefined"!==typeof r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return i;const s=r.getValue();return"number"!==typeof s?i:s+i},zn=function(t,e,n,i){return Kn(e,new Un(n,t),i)},Hn=function(t,e,n){return Kn(t,new Vn(e),n)};function Kn(t,e,n){const i=t.getPriority().val(),r=qn(i,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const i=t,s=qn(i.getValue(),e,n);return s!==i.getValue()||r!==i.getPriority().val()?new Qt(s,ae(r)):t}{const i=t;return s=i,r!==i.getPriority().val()&&(s=s.updatePriority(new Qt(r))),i.forEachChild(Xt,((t,i)=>{const r=Kn(i,e.getImmediateChild(t),n);r!==i&&(s=s.updateImmediateChild(t,r))})),s}}class Wn{constructor(t="",e=null,n={children:{},childCount:0}){this.name=t,this.parent=e,this.node=n}}function Gn(t,e){let n=e instanceof gt?e:new gt(e),i=t,r=yt(n);for(;null!==r;){const t=(0,o.DV)(i.node.children,r)||{children:{},childCount:0};i=new Wn(r,i,t),n=_t(n),r=yt(n)}return i}function Yn(t){return t.node.value}function Qn(t,e){t.node.value=e,ei(t)}function Xn(t){return t.node.childCount>0}function Jn(t,e){F(t.node.children,((n,i)=>{e(new Wn(n,t,i))}))}function Zn(t,e,n,i){n&&!i&&e(t),Jn(t,(t=>{Zn(t,e,!0,i)})),n&&i&&e(t)}function ti(t){return new gt(null===t.parent?t.name:ti(t.parent)+"/"+t.name)}function ei(t){null!==t.parent&&function(t,e,n){const i=function(t){return void 0===Yn(t)&&!Xn(t)}(n),r=(0,o.r3)(t.node.children,e);i&&r?(delete t.node.children[e],t.node.childCount--,ei(t)):i||r||(t.node.children[e]=n.node,t.node.childCount++,ei(t))}(t.parent,t.name,t)}const ni=/[\[\].#$\/\u0000-\u001F\u007F]/,ii=/[\[\].#$\u0000-\u001F\u007F]/,ri=10485760,si=function(t){return"string"===typeof t&&0!==t.length&&!ni.test(t)},oi=function(t){return"string"===typeof t&&0!==t.length&&!ii.test(t)},ai=function(t,e,n){const i=n instanceof gt?new Nt(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+xt(i));if("function"===typeof e)throw new Error(t+"contains a function "+xt(i)+" with contents = "+e.toString());if(A(e))throw new Error(t+"contains "+e.toString()+" "+xt(i));if("string"===typeof e&&e.length>ri/3&&(0,o.ug)(e)>ri)throw new Error(t+"contains a string greater than "+"10485760 utf8 bytes "+xt(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"===typeof e){let n=!1,r=!1;if(F(e,((e,s)=>{if(".value"===e)n=!0;else if(".priority"!==e&&".sv"!==e&&(r=!0,!si(e)))throw new Error(t+" contains an invalid key ("+e+") "+xt(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,o.ug)(e),At(t)}(i,e),ai(t,s,i),function(t){const e=t.parts_.pop();t.byteLength_-=(0,o.ug)(e),t.parts_.length>0&&(t.byteLength_-=1)}(i)})),n&&r)throw new Error(t+' contains ".value" child '+xt(i)+" in addition to actual children.")}},ci=function(t,e){const n=e.path.toString();if("string"!==typeof e.repoInfo.host||0===e.repoInfo.host.length||!si(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),oi(t)}(n))throw new Error((0,o.gK)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class ui{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function li(t,e){let n=null;for(let i=0;i<e.length;i++){const r=e[i],s=r.getPath();null===n||St(s,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(r)}n&&t.eventLists_.push(n)}function hi(t,e,n){li(t,n),di(t,(t=>kt(t,e)||kt(e,t)))}function di(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){const r=t.eventLists_[i];if(r){e(r.path)?(fi(t.eventLists_[i]),t.eventLists_[i]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function fi(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(null!==n){t.events[e]=null;const i=n.getEventRunner();b&&T("event: "+n.toString()),$(i)}}}const pi="repo_interrupt";class gi{constructor(t,e,n,i){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ui,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=we(),this.transactionQueueTree_=new Wn,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function mi(t,e,n){if(t.stats_=it(t.repoInfo_),t.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new ve(t.repoInfo_,((e,n,i,r)=>{_i(t,e,n,i,r)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((()=>wi(t,!0)),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,o.Pz)(n)}catch(i){throw new Error("Invalid authOverride provided: "+i)}}t.persistentConnection_=new Rt(t.repoInfo_,e,((e,n,i,r)=>{_i(t,e,n,i,r)}),(e=>{wi(t,e)}),(e=>{!function(t,e){F(e,((e,n)=>{bi(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener((e=>{t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((e=>{t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=function(t,e){const n=t.toString();return nt[n]||(nt[n]=e()),nt[n]}(t.repoInfo_,(()=>new Te(t.stats_,t.server_))),t.infoData_=new _e,t.infoSyncTree_=new Nn({startListening:(e,n,i,r)=>{let s=[];const o=t.infoData_.getNode(e._path);return o.isEmpty()||(s=Dn(t.infoSyncTree_,e._path,o),setTimeout((()=>{r("ok")}),0)),s},stopListening:()=>{}}),bi(t,"connected",!1),t.serverSyncTree_=new Nn({startListening:(e,n,i,r)=>(t.server_.listen(e,i,n,((n,i)=>{const s=r(n,i);hi(t.eventQueue_,e._path,s)})),[]),stopListening:(e,n)=>{t.server_.unlisten(e,n)}})}function yi(t){const e=t.infoData_.getNode(new gt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function vi(t){return(e=(e={timestamp:yi(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function _i(t,e,n,i,r){t.dataUpdateCount++;const s=new gt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let a=[];if(r)if(i){const e=(0,o.UI)(n,(t=>ae(t)));a=function(t,e,n,i){const r=Ln(t,i);if(r){const i=Fn(r),s=i.path,o=i.queryId,a=It(s,e),c=je.fromObject(n);return jn(t,s,new Ae(Se(o),a,c))}return[]}(t.serverSyncTree_,s,e,r)}else{const e=ae(n);a=function(t,e,n,i){const r=Ln(t,i);if(null!=r){const i=Fn(r),s=i.path,o=i.queryId,a=It(s,e);return jn(t,s,new Ne(Se(o),a,n))}return[]}(t.serverSyncTree_,s,e,r)}else if(i){const e=(0,o.UI)(n,(t=>ae(t)));a=function(t,e,n){const i=je.fromObject(n);return Rn(t,new Ae({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,s,e)}else{const e=ae(n);a=Dn(t.serverSyncTree_,s,e)}let c=s;a.length>0&&(c=ki(t,s)),hi(t.eventQueue_,c,a)}function wi(t,e){bi(t,"connected",e),!1===e&&function(t){Ti(t,"onDisconnectEvents");const e=vi(t),n=we();Ee(t.onDisconnect_,mt(),((i,r)=>{const s=zn(i,r,t.serverSyncTree_,e);be(n,i,s)}));let i=[];Ee(n,mt(),((e,n)=>{i=i.concat(Dn(t.serverSyncTree_,e,n));const r=Pi(t,e);ki(t,r)})),t.onDisconnect_=we(),hi(t.eventQueue_,mt(),i)}(t)}function bi(t,e,n){const i=new gt("/.info/"+e),r=ae(n);t.infoData_.updateSnapshot(i,r);const s=Dn(t.infoSyncTree_,i,r);hi(t.eventQueue_,i,s)}function Ei(t){return t.nextWriteId_++}function Ci(t){t.persistentConnection_&&t.persistentConnection_.interrupt(pi)}function Ti(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),T(n,...e)}function Ii(t,e,n){return Pn(t.serverSyncTree_,e,n)||se.EMPTY_NODE}function Si(t,e=t.transactionQueueTree_){if(e||Di(t,e),Yn(e)){const n=Ai(t,e);(0,o.hu)(n.length>0,"Sending zero length transaction queue");n.every((t=>0===t.status))&&function(t,e,n){const i=n.map((t=>t.currentWriteId)),r=Ii(t,e,i);let s=r;const a=r.hash();for(let l=0;l<n.length;l++){const t=n[l];(0,o.hu)(0===t.status,"tryToSendTransactionQueue_: items in queue should all be run."),t.status=1,t.retryCount++;const i=It(e,t.path);s=s.updateChild(i,t.currentOutputSnapshotRaw)}const c=s.val(!0),u=e;t.server_.put(u.toString(),c,(i=>{Ti(t,"transaction put response",{path:u.toString(),status:i});let r=[];if("ok"===i){const i=[];for(let e=0;e<n.length;e++)n[e].status=2,r=r.concat(xn(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&i.push((()=>n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved))),n[e].unwatcher();Di(t,Gn(t.transactionQueueTree_,e)),Si(t,t.transactionQueueTree_),hi(t.eventQueue_,e,r);for(let t=0;t<i.length;t++)$(i[t])}else{if("datastale"===i)for(let t=0;t<n.length;t++)3===n[t].status?n[t].status=4:n[t].status=0;else{N("transaction at "+u.toString()+" failed: "+i);for(let t=0;t<n.length;t++)n[t].status=4,n[t].abortReason=i}ki(t,e)}}),a)}(t,ti(e),n)}else Xn(e)&&Jn(e,(e=>{Si(t,e)}))}function ki(t,e){const n=Ni(t,e),i=ti(n);return function(t,e,n){if(0===e.length)return;const i=[];let r=[];const s=e.filter((t=>0===t.status)).map((t=>t.currentWriteId));for(let c=0;c<e.length;c++){const u=e[c],l=It(n,u.path);let h,d=!1;if((0,o.hu)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===u.status)d=!0,h=u.abortReason,r=r.concat(xn(t.serverSyncTree_,u.currentWriteId,!0));else if(0===u.status)if(u.retryCount>=25)d=!0,h="maxretry",r=r.concat(xn(t.serverSyncTree_,u.currentWriteId,!0));else{const n=Ii(t,u.path,s);u.currentInputSnapshot=n;const i=e[c].update(n.val());if(void 0!==i){ai("transaction failed: Data returned ",i,u.path);let e=ae(i);"object"===typeof i&&null!=i&&(0,o.r3)(i,".priority")||(e=e.updatePriority(n.getPriority()));const a=u.currentWriteId,c=vi(t),l=Hn(e,n,c);u.currentOutputSnapshotRaw=e,u.currentOutputSnapshotResolved=l,u.currentWriteId=Ei(t),s.splice(s.indexOf(a),1),r=r.concat(An(t.serverSyncTree_,u.path,l,u.currentWriteId,u.applyLocally)),r=r.concat(xn(t.serverSyncTree_,a,!0))}else d=!0,h="nodata",r=r.concat(xn(t.serverSyncTree_,u.currentWriteId,!0))}hi(t.eventQueue_,n,r),r=[],d&&(e[c].status=2,a=e[c].unwatcher,setTimeout(a,Math.floor(0)),e[c].onComplete&&("nodata"===h?i.push((()=>e[c].onComplete(null,!1,e[c].currentInputSnapshot))):i.push((()=>e[c].onComplete(new Error(h),!1,null)))))}var a;Di(t,t.transactionQueueTree_);for(let o=0;o<i.length;o++)$(i[o]);Si(t,t.transactionQueueTree_)}(t,Ai(t,n),i),i}function Ni(t,e){let n,i=t.transactionQueueTree_;for(n=yt(e);null!==n&&void 0===Yn(i);)i=Gn(i,n),n=yt(e=_t(e));return i}function Ai(t,e){const n=[];return xi(t,e,n),n.sort(((t,e)=>t.order-e.order)),n}function xi(t,e,n){const i=Yn(e);if(i)for(let r=0;r<i.length;r++)n.push(i[r]);Jn(e,(e=>{xi(t,e,n)}))}function Di(t,e){const n=Yn(e);if(n){let t=0;for(let e=0;e<n.length;e++)2!==n[e].status&&(n[t]=n[e],t++);n.length=t,Qn(e,n.length>0?n:void 0)}Jn(e,(e=>{Di(t,e)}))}function Pi(t,e){const n=ti(Ni(t,e)),i=Gn(t.transactionQueueTree_,e);return function(t,e,n){let i=n?t:t.parent;for(;null!==i;){if(e(i))return!0;i=i.parent}}(i,(e=>{Ri(t,e)})),Ri(t,i),Zn(i,(e=>{Ri(t,e)})),n}function Ri(t,e){const n=Yn(e);if(n){const i=[];let r=[],s=-1;for(let e=0;e<n.length;e++)3===n[e].status||(1===n[e].status?((0,o.hu)(s===e-1,"All SENT items should be at beginning of queue."),s=e,n[e].status=3,n[e].abortReason="set"):((0,o.hu)(0===n[e].status,"Unexpected transaction status in abort"),n[e].unwatcher(),r=r.concat(xn(t.serverSyncTree_,n[e].currentWriteId,!0)),n[e].onComplete&&i.push(n[e].onComplete.bind(null,new Error("set"),!1,null))));-1===s?Qn(e,void 0):n.length=s+1,hi(t.eventQueue_,ti(e),r);for(let t=0;t<i.length;t++)$(i[t])}}const Oi=function(t,e){const n=Mi(t),i=n.namespace;"firebase.com"===n.domain&&k(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||k("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&N("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const r="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new J(n.host,n.secure,i,r,e,"",i!==n.subdomain),path:new gt(n.pathString)}},Mi=function(t){let e="",n="",i="",r="",s="",o=!0,a="https",c=443;if("string"===typeof t){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let l=t.indexOf("/");-1===l&&(l=t.length);let h=t.indexOf("?");-1===h&&(h=t.length),e=t.substring(0,Math.min(l,h)),l<h&&(r=function(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let t=n[r];try{t=decodeURIComponent(t.replace(/\+/g," "))}catch(i){}e+="/"+t}return e}(t.substring(l,h)));const d=function(t){const e={};"?"===t.charAt(0)&&(t=t.substring(1));for(const n of t.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):N(`Invalid query segment '${n}' in query '${t}'`)}return e}(t.substring(Math.min(t.length,h)));u=e.indexOf(":"),u>=0?(o="https"===a||"wss"===a,c=parseInt(e.substring(u+1),10)):u=e.length;const f=e.slice(0,u);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{const t=e.indexOf(".");i=e.substring(0,t).toLowerCase(),n=e.substring(t+1),s=i}"ns"in d&&(s=d.ns)}return{host:e,port:c,domain:n,subdomain:i,secure:o,scheme:a,pathString:r,namespace:s}};class Li{constructor(t,e,n,i){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=i}get key(){return Tt(this._path)?null:wt(this._path)}get ref(){return new Fi(this._repo,this._path)}get _queryIdentifier(){const t=ye(this._queryParams),e=M(t);return"{}"===e?"default":e}get _queryObject(){return ye(this._queryParams)}isEqual(t){if(!((t=(0,o.m9)(t))instanceof Li))return!1;const e=this._repo===t._repo,n=St(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return e&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)}}class Fi extends Li{constructor(t,e){super(t,e,new ge,!1)}get parent(){const t=Et(this._path);return null===t?null:new Fi(this._repo,t)}get root(){let t=this;for(;null!==t.parent;)t=t.parent;return t}}!function(t){(0,o.hu)(!Tn,"__referenceConstructor has already been defined"),Tn=t}(Fi),function(t){(0,o.hu)(!In,"__referenceConstructor has already been defined"),In=t}(Fi);const ji={};let Vi=!1;function Ui(t,e,n,i,r){let s=i||t.options.databaseURL;void 0===s&&(t.options.projectId||k("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),T("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o,a,u=Oi(s,r),l=u.repoInfo;"undefined"!==typeof c&&c.env&&(a=c.env.FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,s=`http://${a}?ns=${l.namespace}`,u=Oi(s,r),l=u.repoInfo):o=!u.repoInfo.secure;const h=r&&o?new W(W.OWNER):new K(t.name,t.options,e);ci("Invalid Firebase Database URL",u),Tt(u.path)||k("Database URL must point to the root of a Firebase Database (not including a child path).");const d=function(t,e,n,i){let r=ji[e.name];r||(r={},ji[e.name]=r);let s=r[t.toURLString()];s&&k("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return s=new gi(t,Vi,n,i),r[t.toURLString()]=s,s}(l,t,h,new H(t.name,n));return new qi(d,t)}class qi{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(mi(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Fi(this._repo,mt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(!function(t,e){const n=ji[e];n&&n[t.key]===t||k(`Database ${e}(${t.repoInfo_}) has already been deleted.`),Ci(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){null===this._rootInternal&&k("Cannot call "+t+" on a deleted database.")}}Rt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Rt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Bi;!function(t){h=t}(i.Jn),(0,i.Xd)(new s.wA("database",((t,{instanceIdentifier:e})=>Ui(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),t.getProvider("app-check-internal"),e)),"PUBLIC").setMultipleInstances(!0)),(0,i.KN)(u,l,Bi),(0,i.KN)(u,l,"esm2017");var $i=n(6531);const zi="@firebase/installations",Hi="0.5.10",Ki=1e4,Wi="w:0.5.10",Gi="FIS_v2",Yi=36e5,Qi={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Xi=new o.LL("installations","Installations",Qi);function Ji(t){return t instanceof o.ZR&&t.code.includes("request-failed")}function Zi({projectId:t}){return`https://firebaseinstallations.googleapis.com/v1/projects/${t}/installations`}function tr(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function er(t,e){const n=(await e.json()).error;return Xi.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function nr({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function ir(t,{refreshToken:e}){const n=nr(t);return n.append("Authorization",function(t){return`FIS_v2 ${t}`}(e)),n}async function rr(t){const e=await t();return e.status>=500&&e.status<600?t():e}function sr(t){return new Promise((e=>{setTimeout(e,t)}))}const or=/^[cdef][\w-]{21}$/;function ar(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return or.test(e)?e:""}catch(t){return""}}function cr(t){return`${t.appName}!${t.appId}`}const ur=new Map;function lr(t,e){const n=cr(t);hr(n,e),function(t,e){const n=fr();n&&n.postMessage({key:t,fid:e});pr()}(n,e)}function hr(t,e){const n=ur.get(t);if(n)for(const i of n)i(e)}let dr=null;function fr(){return!dr&&"BroadcastChannel"in self&&(dr=new BroadcastChannel("[Firebase] FID Change"),dr.onmessage=t=>{hr(t.data.key,t.data.fid)}),dr}function pr(){0===ur.size&&dr&&(dr.close(),dr=null)}const gr="firebase-installations-store";let mr=null;function yr(){return mr||(mr=(0,$i.X3)("firebase-installations-database",1,{upgrade:(t,e)=>{if(0===e)t.createObjectStore(gr)}})),mr}async function vr(t,e){const n=cr(t),i=(await yr()).transaction(gr,"readwrite"),r=i.objectStore(gr),s=await r.get(n);return await r.put(e,n),await i.done,s&&s.fid===e.fid||lr(t,e.fid),e}async function _r(t){const e=cr(t),n=(await yr()).transaction(gr,"readwrite");await n.objectStore(gr).delete(e),await n.done}async function wr(t,e){const n=cr(t),i=(await yr()).transaction(gr,"readwrite"),r=i.objectStore(gr),s=await r.get(n),o=e(s);return void 0===o?await r.delete(n):await r.put(o,n),await i.done,!o||s&&s.fid===o.fid||lr(t,o.fid),o}async function br(t){let e;const n=await wr(t.appConfig,(n=>{const i=function(t){return Tr(t||{fid:ar(),registrationStatus:0})}(n),r=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine){return{installationEntry:e,registrationPromise:Promise.reject(Xi.create("app-offline"))}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=Zi(t),r=nr(t),s=e.getImmediate({optional:!0});if(s){const t=await s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={fid:n,authVersion:Gi,appId:t.appId,sdkVersion:Wi},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await rr((()=>fetch(i,a)));if(c.ok){const t=await c.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:tr(t.authToken)}}throw await er("Create Installation",c)}(t,e);return vr(t.appConfig,n)}catch(n){throw Ji(n)&&409===n.customData.serverCode?await _r(t.appConfig):await vr(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Er(t)}:{installationEntry:e}}(t,i);return e=r.registrationPromise,r.installationEntry}));return""===n.fid?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function Er(t){let e=await Cr(t.appConfig);for(;1===e.registrationStatus;)await sr(100),e=await Cr(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await br(t);return n||e}return e}function Cr(t){return wr(t,(t=>{if(!t)throw Xi.create("installation-not-found");return Tr(t)}))}function Tr(t){return 1===(e=t).registrationStatus&&e.registrationTime+Ki<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function Ir({appConfig:t,heartbeatServiceProvider:e},n){const i=function(t,{fid:e}){return`${Zi(t)}/${e}/authTokens:generate`}(t,n),r=ir(t,n),s=e.getImmediate({optional:!0});if(s){const t=await s.getHeartbeatsHeader();t&&r.append("x-firebase-client",t)}const o={installation:{sdkVersion:Wi,appId:t.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await rr((()=>fetch(i,a)));if(c.ok){return tr(await c.json())}throw await er("Generate Auth Token",c)}async function Sr(t,e=!1){let n;const i=await wr(t.appConfig,(i=>{if(!Nr(i))throw Xi.create("not-registered");const r=i.authToken;if(!e&&function(t){return 2===t.requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+Yi}(t)}(r))return i;if(1===r.requestStatus)return n=async function(t,e){let n=await kr(t.appConfig);for(;1===n.authToken.requestStatus;)await sr(100),n=await kr(t.appConfig);const i=n.authToken;return 0===i.requestStatus?Sr(t,e):i}(t,e),i;{if(!navigator.onLine)throw Xi.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(i);return n=async function(t,e){try{const n=await Ir(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await vr(t.appConfig,i),n}catch(n){if(!Ji(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await vr(t.appConfig,n)}else await _r(t.appConfig);throw n}}(t,e),e}}));return n?await n:i.authToken}function kr(t){return wr(t,(t=>{if(!Nr(t))throw Xi.create("not-registered");const e=t.authToken;return 1===(n=e).requestStatus&&n.requestTime+Ki<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var n}))}function Nr(t){return void 0!==t&&2===t.registrationStatus}async function Ar(t,e=!1){const n=t;await async function(t){const{registrationPromise:e}=await br(t);e&&await e}(n);return(await Sr(n,e)).token}function xr(t){return Xi.create("missing-app-config-values",{valueName:t})}const Dr="installations",Pr=t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw xr("App Configuration");if(!t.name)throw xr("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw xr(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:(0,i.qX)(e,"heartbeat"),_delete:()=>Promise.resolve()}},Rr=t=>{const e=t.getProvider("app").getImmediate(),n=(0,i.qX)(e,Dr).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:i}=await br(e);return i?i.catch(console.error):Sr(e).catch(console.error),n.fid}(n),getToken:t=>Ar(n,t)}};(0,i.Xd)(new s.wA(Dr,Pr,"PUBLIC")),(0,i.Xd)(new s.wA("installations-internal",Rr,"PRIVATE")),(0,i.KN)(zi,Hi),(0,i.KN)(zi,Hi,"esm2017");const Or="analytics",Mr="https://www.googletagmanager.com/gtag/js",Lr=new a.Yd("@firebase/analytics");function Fr(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}function jr(t,e,n,i){return async function(r,s,o){try{"event"===r?await async function(t,e,n,i,r){try{let s=[];if(r&&r.send_to){let t=r.send_to;Array.isArray(t)||(t=[t]);const i=await Fr(n);for(const n of t){const t=i.find((t=>t.measurementId===n)),r=t&&e[t.appId];if(!r){s=[];break}s.push(r)}}0===s.length&&(s=Object.values(e)),await Promise.all(s),t("event",i,r||{})}catch(s){Lr.error(s)}}(t,e,n,s,o):"config"===r?await async function(t,e,n,i,r,s){const o=i[r];try{if(o)await e[o];else{const t=(await Fr(n)).find((t=>t.measurementId===r));t&&await e[t.appId]}}catch(a){Lr.error(a)}t("config",r,s)}(t,e,n,i,s,o):t("set",s)}catch(a){Lr.error(a)}}}const Vr={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},Ur=new o.LL("analytics","Analytics",Vr);const qr=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function Br(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function $r(t,e=qr,n){const{appId:i,apiKey:r,measurementId:s}=t.options;if(!i)throw Ur.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw Ur.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new Hr;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),zr({appId:i,apiKey:r,measurementId:s},o,a,e)}async function zr(t,{throttleEndTimeMillis:e,backoffCount:n},i,r=qr){const{appId:s,measurementId:a}=t;try{await function(t,e){return new Promise(((n,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(n,r);t.addEventListener((()=>{clearTimeout(s),i(Ur.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(i,e)}catch(c){if(a)return Lr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c.message}]`),{appId:s,measurementId:a};throw c}try{const e=await async function(t){var e;const{appId:n,apiKey:i}=t,r={method:"GET",headers:Br(i)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,r);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(a){}throw Ur.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return r.deleteThrottleMetadata(s),e}catch(c){if(!function(t){if(!(t instanceof o.ZR)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(c)){if(r.deleteThrottleMetadata(s),a)return Lr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c.message}]`),{appId:s,measurementId:a};throw c}const e=503===Number(c.customData.httpStatus)?(0,o.$s)(n,r.intervalMillis,30):(0,o.$s)(n,r.intervalMillis),u={throttleEndTimeMillis:Date.now()+e,backoffCount:n+1};return r.setThrottleMetadata(s,u),Lr.debug(`Calling attemptFetch again in ${e} millis`),zr(t,u,i,r)}}class Hr{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}async function Kr(t,e,n,i,r,s,a){var c;const u=$r(t);u.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Lr.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>Lr.error(t))),e.push(u);const l=async function(){if(!(0,o.hl)())return Lr.warn(Ur.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,o.eu)()}catch(t){return Lr.warn(Ur.create("indexeddb-unavailable",{errorInfo:t}).message),!1}return!0}().then((t=>t?i.getId():void 0)),[h,d]=await Promise.all([u,l]);(function(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(Mr))return e;return null})()||function(t,e){const n=document.createElement("script");n.src=`${Mr}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}(s,h.measurementId),r("js",new Date);const f=null!==(c=null===a||void 0===a?void 0:a.config)&&void 0!==c?c:{};return f.origin="firebase",f.update=!0,null!=d&&(f.firebase_id=d),r("config",h.measurementId,f),h.measurementId}class Wr{constructor(t){this.app=t}_delete(){return delete Gr[this.app.options.appId],Promise.resolve()}}let Gr={},Yr=[];const Qr={};let Xr,Jr,Zr="dataLayer",ts="gtag",es=!1;function ns(t,e,n){!function(){const t=[];if((0,o.ru)()&&t.push("This is a browser extension environment."),(0,o.zI)()||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=Ur.create("invalid-analytics-context",{errorInfo:e});Lr.warn(n.message)}}();const i=t.options.appId;if(!i)throw Ur.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw Ur.create("no-api-key");Lr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=Gr[i])throw Ur.create("already-exists",{id:i});if(!es){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(Zr);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,r){let s=function(...t){window[i].push(arguments)};return window[r]&&"function"===typeof window[r]&&(s=window[r]),window[r]=jr(s,t,e,n),{gtagCore:s,wrappedGtag:window[r]}}(Gr,Yr,Qr,Zr,ts);Jr=t,Xr=e,es=!0}Gr[i]=Kr(t,Yr,Qr,e,Xr,Zr,n);return new Wr(t)}function is(t=(0,i.Mq)()){t=(0,o.m9)(t);const e=(0,i.qX)(t,Or);return e.isInitialized()?e.getImmediate():function(t,e={}){const n=(0,i.qX)(t,Or);if(n.isInitialized()){const t=n.getImmediate();if((0,o.vZ)(e,n.getOptions()))return t;throw Ur.create("already-initialized")}return n.initialize({options:e})}(t)}function rs(t,e,n,i){t=(0,o.m9)(t),async function(t,e,n,i,r){if(r&&r.global)t("event",n,i);else{const r=await e;t("event",n,Object.assign(Object.assign({},i),{send_to:r}))}}(Jr,Gr[t.app.options.appId],e,n,i).catch((t=>Lr.error(t)))}const ss="@firebase/analytics",os="0.7.10";(0,i.Xd)(new s.wA(Or,((t,{options:e})=>ns(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),(0,i.Xd)(new s.wA("analytics-internal",(function(t){try{const e=t.getProvider(Or).getImmediate();return{logEvent:(t,n,i)=>rs(e,t,n,i)}}catch(e){throw Ur.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),(0,i.KN)(ss,os),(0,i.KN)(ss,os,"esm2017");var as={apiKey:"AIzaSyCcLReDtZr6yFxRnSphTCkgNKFG8NDkYTM",authDomain:"yoga-master-7c01f.firebaseapp.com",projectId:"yoga-master-7c01f",storageBucket:"yoga-master-7c01f.appspot.com",messagingSenderId:"629903896027",appId:"1:629903896027:web:06f9a3bed27464e3198bfe"},cs=(0,i.ZF)(as),us=(0,r.ad)();(async function(){if((0,o.ru)())return!1;if(!(0,o.zI)())return!1;if(!(0,o.hl)())return!1;try{return await(0,o.eu)()}catch(S){return!1}})().then((function(t){return t?is(cs):null}))},1551:function(t,e,n){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s=[],o=!0,a=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(s.push(i.value),!e||s.length!==e);o=!0);}catch(c){a=!0,r=c}finally{try{o||null==n.return||n.return()}finally{if(a)throw r}}return s}}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s,o=(s=n(7294))&&s.__esModule?s:{default:s},a=n(1003),c=n(880),u=n(9246);function l(t,e){if(null==t)return{};var n,i,r=function(t,e){if(null==t)return{};var n,i,r={},s=Object.keys(t);for(i=0;i<s.length;i++)n=s[i],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var h={};function d(t,e,n,i){if(t&&a.isLocalURL(e)){t.prefetch(e,n,i).catch((function(t){0}));var r=i&&"undefined"!==typeof i.locale?i.locale:t&&t.locale;h[e+"%"+n+(r?"%"+r:"")]=!0}}var f=o.default.forwardRef((function(t,e){var n,i=t.legacyBehavior,s=void 0===i?!0!==Boolean(!1):i,f=t.href,p=t.as,g=t.children,m=t.prefetch,y=t.passHref,v=t.replace,_=t.shallow,w=t.scroll,b=t.locale,E=t.onClick,C=t.onMouseEnter,T=l(t,["href","as","children","prefetch","passHref","replace","shallow","scroll","locale","onClick","onMouseEnter"]);n=g,s&&"string"===typeof n&&(n=o.default.createElement("a",null,n));var I,S=!1!==m,k=c.useRouter(),N=o.default.useMemo((function(){var t=r(a.resolveHref(k,f,!0),2),e=t[0],n=t[1];return{href:e,as:p?a.resolveHref(k,p):n||e}}),[k,f,p]),A=N.href,x=N.as,D=o.default.useRef(A),P=o.default.useRef(x);s&&(I=o.default.Children.only(n));var R=s?I&&"object"===typeof I&&I.ref:e,O=r(u.useIntersection({rootMargin:"200px"}),3),M=O[0],L=O[1],F=O[2],j=o.default.useCallback((function(t){P.current===x&&D.current===A||(F(),P.current=x,D.current=A),M(t),R&&("function"===typeof R?R(t):"object"===typeof R&&(R.current=t))}),[x,R,A,F,M]);o.default.useEffect((function(){var t=L&&S&&a.isLocalURL(A),e="undefined"!==typeof b?b:k&&k.locale,n=h[A+"%"+x+(e?"%"+e:"")];t&&!n&&d(k,A,x,{locale:e})}),[x,A,L,b,S,k]);var V={ref:j,onClick:function(t){s||"function"!==typeof E||E(t),s&&I.props&&"function"===typeof I.props.onClick&&I.props.onClick(t),t.defaultPrevented||function(t,e,n,i,r,s,o,c){("A"!==t.currentTarget.nodeName.toUpperCase()||!function(t){var e=t.currentTarget.target;return e&&"_self"!==e||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||t.nativeEvent&&2===t.nativeEvent.which}(t)&&a.isLocalURL(n))&&(t.preventDefault(),e[r?"replace":"push"](n,i,{shallow:s,locale:c,scroll:o}))}(t,k,A,x,v,_,w,b)},onMouseEnter:function(t){s||"function"!==typeof C||C(t),s&&I.props&&"function"===typeof I.props.onMouseEnter&&I.props.onMouseEnter(t),a.isLocalURL(A)&&d(k,A,x,{priority:!0})}};if(!s||y||"a"===I.type&&!("href"in I.props)){var U="undefined"!==typeof b?b:k&&k.locale,q=k&&k.isLocaleDomain&&a.getDomainLocale(x,U,k&&k.locales,k&&k.domainLocales);V.href=q||a.addBasePath(a.addLocale(x,U,k&&k.defaultLocale))}return s?o.default.cloneElement(I,V):o.default.createElement("a",Object.assign({},T,V),n)}));e.default=f,("function"===typeof e.default||"object"===typeof e.default&&null!==e.default)&&(Object.assign(e.default,e),t.exports=e.default)},9246:function(t,e,n){"use strict";function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s=[],o=!0,a=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(s.push(i.value),!e||s.length!==e);o=!0);}catch(c){a=!0,r=c}finally{try{o||null==n.return||n.return()}finally{if(a)throw r}}return s}}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}Object.defineProperty(e,"__esModule",{value:!0}),e.useIntersection=function(t){var e=t.rootRef,n=t.rootMargin,i=t.disabled||!a,l=s.useRef(),h=r(s.useState(!1),2),d=h[0],f=h[1],p=r(s.useState(e?e.current:null),2),g=p[0],m=p[1],y=s.useCallback((function(t){l.current&&(l.current(),l.current=void 0),i||d||t&&t.tagName&&(l.current=function(t,e,n){var i=function(t){var e,n={root:t.root||null,margin:t.rootMargin||""},i=u.find((function(t){return t.root===n.root&&t.margin===n.margin}));i?e=c.get(i):(e=c.get(n),u.push(n));if(e)return e;var r=new Map,s=new IntersectionObserver((function(t){t.forEach((function(t){var e=r.get(t.target),n=t.isIntersecting||t.intersectionRatio>0;e&&n&&e(n)}))}),t);return c.set(n,e={id:n,observer:s,elements:r}),e}(n),r=i.id,s=i.observer,o=i.elements;return o.set(t,e),s.observe(t),function(){if(o.delete(t),s.unobserve(t),0===o.size){s.disconnect(),c.delete(r);var e=u.findIndex((function(t){return t.root===r.root&&t.margin===r.margin}));e>-1&&u.splice(e,1)}}}(t,(function(t){return t&&f(t)}),{root:g,rootMargin:n}))}),[i,g,n,d]),v=s.useCallback((function(){f(!1)}),[]);return s.useEffect((function(){if(!a&&!d){var t=o.requestIdleCallback((function(){return f(!0)}));return function(){return o.cancelIdleCallback(t)}}}),[d]),s.useEffect((function(){e&&m(e.current)}),[e]),[y,d,v]};var s=n(7294),o=n(4686),a="undefined"!==typeof IntersectionObserver;var c=new Map,u=[];("function"===typeof e.default||"object"===typeof e.default&&null!==e.default)&&(Object.assign(e.default,e),t.exports=e.default)},11:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return N}});var i=n(5893),r=n(7294),s=n(1664),o=n.n(s),a=n(5938),c=n.n(a);function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,s=[],o=!0,a=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(s.push(i.value),!e||s.length!==e);o=!0);}catch(t){a=!0,r=t}finally{try{o||null==n.return||n.return()}finally{if(a)throw r}}return s}}(t,e)||function(t,e){if(t){if("string"==typeof t)return d(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var f=function(t){var e=t.children,n=t.selector,i=t.smooth,s=void 0===i||i,o=t.style,a=void 0===o?{}:o,c=t.alignToTop,d=void 0!==c&&c,f=t.className,p=void 0===f?"":f,g=t.onClick,m=t.scrollOptions,y=void 0===m?{}:m,v=function(){var t=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){l(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({behavior:s?"smooth":"instant"},function(t){var e={};return t instanceof Object&&Object.entries(t).forEach((function(t){var n=h(t,2),i=n[0],r=n[1];switch(i){case"behavior":"auto"!==r&&"smooth"!==r||(e[i]=r);case"block":case"inline":"start"!==r&&"center"!==r&&"end"!==r&&"nearest"!==r||(e[i]=r)}})),e}(y));d&&(t.block="start",t.inline="nearest"),document.querySelector(n).scrollIntoView(t)};return r.createElement("div",{style:a,className:p,onClick:function(t){"function"==typeof g?(g(t),setTimeout(v,1e3/60)):v()}},e)},p=n(5321),g=n(3393),m=n(7728),y=n.n(m),v=(n(689),function(){var t,e,n,s,a,u,l=(0,r.useState)(!1),h=l[0],d=l[1],m=(0,r.useState)(""),v=m[0],_=m[1];return(0,r.useEffect)((function(){var t=(0,p.hJ)(g.db,"Top Nav"),e=(0,p.IO)(t);return window.addEventListener("scroll",(function(){d(window.scrollY>400)})),(0,p.cf)(e,(function(t){_(t.docs.map((function(t){return t.data()})))}))}),[]),(0,i.jsx)(c(),{header:(0,i.jsxs)("div",{className:"".concat(y().header_root," ").concat(h?y().header_root_bg:y().header_root_bg_none),children:[(0,i.jsx)("div",{className:y().header_logo,children:(null===(t=v[0])||void 0===t?void 0:t.logo)&&(0,i.jsx)("img",{src:"".concat((null===(e=v[0])||void 0===e?void 0:e.logo)||"#"),alt:"Logo"})}),(0,i.jsx)("div",{children:(0,i.jsxs)("ul",{className:y().header_links,children:[(0,i.jsx)("li",{className:y().header_link,children:(0,i.jsx)(o(),{href:"/",children:"".concat((null===(n=v[0])||void 0===n?void 0:n.Home)||"Home")})}),(0,i.jsx)("li",{className:y().header_link,children:(0,i.jsx)(f,{selector:"#benefits",children:"".concat((null===(s=v[0])||void 0===s?void 0:s.Benefits)||"Benefits")})}),(0,i.jsx)("li",{className:y().header_link,children:(0,i.jsx)(f,{selector:"#our-services",children:"".concat((null===(a=v[0])||void 0===a?void 0:a["Our Services"])||"Our Services")})}),(0,i.jsx)("li",{className:y().header_link,children:(0,i.jsx)(f,{selector:"#contact-us",children:"".concat((null===(u=v[0])||void 0===u?void 0:u["Contact us"])||"Contact us")})})]})})]})})}),_=n(3951),w=n(9134),b=n.n(w),E=n(7246),C=n.n(E),T=function(){var t=(0,r.useState)(""),e=t[0],n=t[1];return(0,r.useEffect)((function(){var t=(0,p.hJ)(g.db,"footer"),e=(0,p.IO)(t);return(0,p.cf)(e,(function(t){n(t.docs.map((function(t){return t.data()})))}))}),[]),(0,i.jsx)("div",{className:C().footer,children:(0,i.jsx)("div",{children:e?null===e||void 0===e?void 0:e.map((function(t){return t.copyright})):""})})},I=function(t){var e=t.children;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(_.Z,{}),(0,i.jsx)(v,{}),(0,i.jsx)("div",{className:b().container,children:(0,i.jsx)("main",{className:b().main,children:e})}),(0,i.jsx)(T,{})]})};n(6774);function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})))),i.forEach((function(e){S(t,e,n[e])}))}return t}var N=function(t){var e=t.Component,n=t.pageProps;return(0,i.jsx)(I,{children:(0,i.jsx)(e,k({},n))})}},7246:function(t){t.exports={footer:"Footer_footer__Tl1eP",social:"Footer_social__r_lug"}},9134:function(t){t.exports={container:"Layout_container__S4aNf",main:"Layout_main__c1pHS"}},7728:function(t){t.exports={header_root:"Nav_header_root__512TN",header_logo:"Nav_header_logo__FtQlR",header_root_bg:"Nav_header_root_bg__0SIfD",header:"Nav_header__ICGJp",header_links:"Nav_header_links__NzI8w"}},689:function(){},6774:function(){},7663:function(t){!function(){var e={162:function(t){var e,n,i=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(t){if(e===setTimeout)return setTimeout(t,0);if((e===r||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(i){try{return e.call(null,t,0)}catch(i){return e.call(this,t,0)}}}!function(){try{e="function"===typeof setTimeout?setTimeout:r}catch(t){e=r}try{n="function"===typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var a,c=[],u=!1,l=-1;function h(){u&&a&&(u=!1,a.length?c=a.concat(c):l=-1,c.length&&d())}function d(){if(!u){var t=o(h);u=!0;for(var e=c.length;e;){for(a=c,c=[];++l<e;)a&&a[l].run();l=-1,e=c.length}a=null,u=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function p(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new f(t,e)),1!==c.length||u||o(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function i(t){var r=n[t];if(void 0!==r)return r.exports;var s=n[t]={exports:{}},o=!0;try{e[t](s,s.exports,i),o=!1}finally{o&&delete n[t]}return s.exports}i.ab="//";var r=i(162);t.exports=r}()},9008:function(t,e,n){t.exports=n(3121)},1664:function(t,e,n){t.exports=n(1551)},1040:function(t){"use strict";function e(t,e,n,i,r){}e.resetWarningCache=function(){0},t.exports=e},7425:function(t,e,n){"use strict";var i=n(1805);t.exports=function(t){return i(t,!1)}},1805:function(t,e,n){"use strict";var i=n(9864),r=n(6086),s=n(414),o=n(8130),a=n(1040);function c(){return null}t.exports=function(t,e){var n="function"===typeof Symbol&&Symbol.iterator;var u="<<anonymous>>",l={array:p("array"),bigint:p("bigint"),bool:p("boolean"),func:p("function"),number:p("number"),object:p("object"),string:p("string"),symbol:p("symbol"),any:f(c),arrayOf:function(t){return f((function(e,n,i,r,o){if("function"!==typeof t)return new d("Property `"+o+"` of component `"+i+"` has invalid PropType notation inside arrayOf.");var a=e[n];if(!Array.isArray(a))return new d("Invalid "+r+" `"+o+"` of type `"+y(a)+"` supplied to `"+i+"`, expected an array.");for(var c=0;c<a.length;c++){var u=t(a,c,i,r,o+"["+c+"]",s);if(u instanceof Error)return u}return null}))},element:f((function(e,n,i,r,s){var o=e[n];return t(o)?null:new d("Invalid "+r+" `"+s+"` of type `"+y(o)+"` supplied to `"+i+"`, expected a single ReactElement.")})),elementType:f((function(t,e,n,r,s){var o=t[e];return i.isValidElementType(o)?null:new d("Invalid "+r+" `"+s+"` of type `"+y(o)+"` supplied to `"+n+"`, expected a single ReactElement type.")})),instanceOf:function(t){return f((function(e,n,i,r,s){if(!(e[n]instanceof t)){var o=t.name||u;return new d("Invalid "+r+" `"+s+"` of type `"+(((a=e[n]).constructor&&a.constructor.name?a.constructor.name:u)+"` supplied to `")+i+"`, expected instance of `"+o+"`.")}var a;return null}))},node:f((function(t,e,n,i,r){return m(t[e])?null:new d("Invalid "+i+" `"+r+"` supplied to `"+n+"`, expected a ReactNode.")})),objectOf:function(t){return f((function(e,n,i,r,a){if("function"!==typeof t)return new d("Property `"+a+"` of component `"+i+"` has invalid PropType notation inside objectOf.");var c=e[n],u=y(c);if("object"!==u)return new d("Invalid "+r+" `"+a+"` of type `"+u+"` supplied to `"+i+"`, expected an object.");for(var l in c)if(o(c,l)){var h=t(c,l,i,r,a+"."+l,s);if(h instanceof Error)return h}return null}))},oneOf:function(t){if(!Array.isArray(t))return c;return f((function(e,n,i,r,s){for(var o=e[n],a=0;a<t.length;a++)if(h(o,t[a]))return null;var c=JSON.stringify(t,(function(t,e){return"symbol"===v(e)?String(e):e}));return new d("Invalid "+r+" `"+s+"` of value `"+String(o)+"` supplied to `"+i+"`, expected one of "+c+".")}))},oneOfType:function(t){if(!Array.isArray(t))return c;for(var e=0;e<t.length;e++){var n=t[e];if("function"!==typeof n)return _(n),c}return f((function(e,n,i,r,a){for(var c=[],u=0;u<t.length;u++){var l=(0,t[u])(e,n,i,r,a,s);if(null==l)return null;l.data&&o(l.data,"expectedType")&&c.push(l.data.expectedType)}return new d("Invalid "+r+" `"+a+"` supplied to `"+i+"`"+(c.length>0?", expected one of type ["+c.join(", ")+"]":"")+".")}))},shape:function(t){return f((function(e,n,i,r,o){var a=e[n],c=y(a);if("object"!==c)return new d("Invalid "+r+" `"+o+"` of type `"+c+"` supplied to `"+i+"`, expected `object`.");for(var u in t){var l=t[u];if("function"!==typeof l)return g(i,r,o,u,v(l));var h=l(a,u,i,r,o+"."+u,s);if(h)return h}return null}))},exact:function(t){return f((function(e,n,i,a,c){var u=e[n],l=y(u);if("object"!==l)return new d("Invalid "+a+" `"+c+"` of type `"+l+"` supplied to `"+i+"`, expected `object`.");var h=r({},e[n],t);for(var f in h){var p=t[f];if(o(t,f)&&"function"!==typeof p)return g(i,a,c,f,v(p));if(!p)return new d("Invalid "+a+" `"+c+"` key `"+f+"` supplied to `"+i+"`.\nBad object: "+JSON.stringify(e[n],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(t),null,"  "));var m=p(u,f,i,a,c+"."+f,s);if(m)return m}return null}))}};function h(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}function d(t,e){this.message=t,this.data=e&&"object"===typeof e?e:{},this.stack=""}function f(t){function n(n,i,r,o,a,c,l){if((o=o||u,c=c||r,l!==s)&&e){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}return null==i[r]?n?null===i[r]?new d("The "+a+" `"+c+"` is marked as required in `"+o+"`, but its value is `null`."):new d("The "+a+" `"+c+"` is marked as required in `"+o+"`, but its value is `undefined`."):null:t(i,r,o,a,c)}var i=n.bind(null,!1);return i.isRequired=n.bind(null,!0),i}function p(t){return f((function(e,n,i,r,s,o){var a=e[n];return y(a)!==t?new d("Invalid "+r+" `"+s+"` of type `"+v(a)+"` supplied to `"+i+"`, expected `"+t+"`.",{expectedType:t}):null}))}function g(t,e,n,i,r){return new d((t||"React class")+": "+e+" type `"+n+"."+i+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+r+"`.")}function m(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(m);if(null===e||t(e))return!0;var i=function(t){var e=t&&(n&&t[n]||t["@@iterator"]);if("function"===typeof e)return e}(e);if(!i)return!1;var r,s=i.call(e);if(i!==e.entries){for(;!(r=s.next()).done;)if(!m(r.value))return!1}else for(;!(r=s.next()).done;){var o=r.value;if(o&&!m(o[1]))return!1}return!0;default:return!1}}function y(t){var e=typeof t;return Array.isArray(t)?"array":t instanceof RegExp?"object":function(t,e){return"symbol"===t||!!e&&("Symbol"===e["@@toStringTag"]||"function"===typeof Symbol&&e instanceof Symbol)}(e,t)?"symbol":e}function v(t){if("undefined"===typeof t||null===t)return""+t;var e=y(t);if("object"===e){if(t instanceof Date)return"date";if(t instanceof RegExp)return"regexp"}return e}function _(t){var e=v(t);switch(e){case"array":case"object":return"an "+e;case"boolean":case"date":case"regexp":return"a "+e;default:return e}}return d.prototype=Error.prototype,l.checkPropTypes=a,l.resetWarningCache=a.resetWarningCache,l.PropTypes=l,l}},414:function(t){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},8130:function(t){t.exports=Function.call.bind(Object.prototype.hasOwnProperty)},9921:function(t,e){"use strict";var n="function"===typeof Symbol&&Symbol.for,i=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,s=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,p=n?Symbol.for("react.suspense_list"):60120,g=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,v=n?Symbol.for("react.fundamental"):60117,_=n?Symbol.for("react.responder"):60118,w=n?Symbol.for("react.scope"):60119;function b(t){if("object"===typeof t&&null!==t){var e=t.$$typeof;switch(e){case i:switch(t=t.type){case l:case h:case s:case a:case o:case f:return t;default:switch(t=t&&t.$$typeof){case u:case d:case m:case g:case c:return t;default:return e}}case r:return e}}}function E(t){return b(t)===h}e.AsyncMode=l,e.ConcurrentMode=h,e.ContextConsumer=u,e.ContextProvider=c,e.Element=i,e.ForwardRef=d,e.Fragment=s,e.Lazy=m,e.Memo=g,e.Portal=r,e.Profiler=a,e.StrictMode=o,e.Suspense=f,e.isAsyncMode=function(t){return E(t)||b(t)===l},e.isConcurrentMode=E,e.isContextConsumer=function(t){return b(t)===u},e.isContextProvider=function(t){return b(t)===c},e.isElement=function(t){return"object"===typeof t&&null!==t&&t.$$typeof===i},e.isForwardRef=function(t){return b(t)===d},e.isFragment=function(t){return b(t)===s},e.isLazy=function(t){return b(t)===m},e.isMemo=function(t){return b(t)===g},e.isPortal=function(t){return b(t)===r},e.isProfiler=function(t){return b(t)===a},e.isStrictMode=function(t){return b(t)===o},e.isSuspense=function(t){return b(t)===f},e.isValidElementType=function(t){return"string"===typeof t||"function"===typeof t||t===s||t===h||t===a||t===o||t===f||t===p||"object"===typeof t&&null!==t&&(t.$$typeof===m||t.$$typeof===g||t.$$typeof===c||t.$$typeof===u||t.$$typeof===d||t.$$typeof===v||t.$$typeof===_||t.$$typeof===w||t.$$typeof===y)},e.typeOf=b},9864:function(t,e,n){"use strict";t.exports=n(9921)},5938:function(t,e,n){"use strict";function i(t){return t&&"object"===typeof t&&"default"in t?t.default:t}var r,s,o=i(n(5105)),a=i(n(9663)),c=i(n(2600)),u=i(n(9135)),l=i(n(3196)),h=n(5539),d=i(h);function f(t,e){return window.addEventListener(t,e,!1),function(){return window.removeEventListener(t,e,!1)}}var p=function(){},g=(s=r=function(t){function e(){var t,n,i;a(this,e);for(var r=arguments.length,s=Array(r),c=0;c<r;c++)s[c]=arguments[c];return n=i=u(this,(t=e.__proto__||o(e)).call.apply(t,[this].concat(s))),i._detatch=p,i._rafExecuting=!1,i.state={isSticky:i.props.headerOnly},i.calculateStickyState=function(){i._rafExecuting||(i._rafExecuting=!0,requestAnimationFrame((function(){var t=i._fixed.offsetHeight,e=i._root.offsetHeight,n=i._root.getBoundingClientRect(),r=i.props.stickyOffset,s=e+n.top-t<=(r||0);s&&!i.state.isSticky?(i.setState({isSticky:!0}),i.props.onSticky(!0)):!s&&i.state.isSticky&&(i.setState({isSticky:!1}),i.props.onSticky(!1)),i._rafExecuting=!1})))},i.onResize=function(){i.setState({}),i.calculateStickyState()},u(i,n)}return l(e,t),c(e,[{key:"componentDidMount",value:function(){this.initialise(),this.setState({})}},{key:"componentWillUnmount",value:function(){this._detatch()}},{key:"componentWillReceiveProps",value:function(t){t.headerOnly!==this.props.headerOnly&&this.calculateStickyState()}},{key:"initialise",value:function(){var t=this;if(!this._initialised){var e=f("scroll",this.calculateStickyState),n=f("resize",this.onResize);this._detatch=function(){[e,n].forEach((function(t){return t()})),t._initialised=!1},this.calculateStickyState(),this._initialised=!0}}},{key:"render",value:function(){var t=this,e=this.props.backgroundImage&&"url('"+this.props.backgroundImage+"')",n="ReactStickyHeader_root"+(this.props.className?" "+this.props.className:"")+(this.state.isSticky?" is-sticky":""),i=this._root&&this._root.offsetHeight,r=this._fixed&&this._fixed.offsetHeight;return d.createElement("header",{className:n,ref:function(e){return t._root=e}},d.createElement("div",{className:"ReactStickyHeader_fixed",ref:function(e){return t._fixed=e}},this.props.header),d.createElement("div",{className:"ReactStickyHeader_midground",style:{height:i||r,top:r,backgroundImage:e,backgroundColor:this.props.backgroundColor}}),this.props.headerOnly&&d.createElement("div",{style:{height:r}}),this.props.headerOnly||d.createElement("div",{className:"ReactStickyHeader_background-bg",style:{backgroundImage:e,backgroundColor:this.props.backgroundColor}}),this.props.headerOnly||d.createElement("div",{className:"ReactStickyHeader_foreground",style:{opacity:this.state.isSticky?0:1,backgroundImage:e,backgroundColor:this.props.backgroundColor}}),this.props.headerOnly||this.props.children)}}]),e}(h.Component),r.defaultProps={onSticky:p,headerOnly:!1},s);t.exports=g},6359:function(t){"use strict";var e={escape:function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,(function(t){return e[t]}))},unescape:function(t){var e={"=0":"=","=2":":"};return(""+("."===t[0]&&"$"===t[1]?t.substring(2):t.substring(1))).replace(/(=0|=2)/g,(function(t){return e[t]}))}};t.exports=e},6112:function(t,e,n){"use strict";var i=n(4763),r=(n(3759),function(t){var e=this;if(e.instancePool.length){var n=e.instancePool.pop();return e.call(n,t),n}return new e(t)}),s=function(t){var e=this;t instanceof e||i("25"),t.destructor(),e.instancePool.length<e.poolSize&&e.instancePool.push(t)},o=r,a={addPoolingTo:function(t,e){var n=t;return n.instancePool=[],n.getPooled=e||o,n.poolSize||(n.poolSize=10),n.release=s,n},oneArgumentPooler:r,twoArgumentPooler:function(t,e){var n=this;if(n.instancePool.length){var i=n.instancePool.pop();return n.call(i,t,e),i}return new n(t,e)},threeArgumentPooler:function(t,e,n){var i=this;if(i.instancePool.length){var r=i.instancePool.pop();return i.call(r,t,e,n),r}return new i(t,e,n)},fourArgumentPooler:function(t,e,n,i){var r=this;if(r.instancePool.length){var s=r.instancePool.pop();return r.call(s,t,e,n,i),s}return new r(t,e,n,i)}};t.exports=a},8027:function(t,e,n){"use strict";var i=n(6086),r=n(888),s=n(5664),o=n(8739),a=n(6140),c=n(6859),u=n(3330),l=n(5261),h=n(6626),d=a.createElement,f=a.createFactory,p=a.cloneElement,g=i,m={Children:{map:s.map,forEach:s.forEach,count:s.count,toArray:s.toArray,only:h},Component:r.Component,PureComponent:r.PureComponent,createElement:d,cloneElement:p,isValidElement:a.isValidElement,PropTypes:c,createClass:l,createFactory:f,createMixin:function(t){return t},DOM:o,version:u,__spread:g};t.exports=m},888:function(t,e,n){"use strict";var i=n(4763),r=n(6086),s=n(5016),o=(n(4932),n(3677));n(3759),n(8736);function a(t,e,n){this.props=t,this.context=e,this.refs=o,this.updater=n||s}function c(t,e,n){this.props=t,this.context=e,this.refs=o,this.updater=n||s}function u(){}a.prototype.isReactComponent={},a.prototype.setState=function(t,e){"object"!==typeof t&&"function"!==typeof t&&null!=t&&i("85"),this.updater.enqueueSetState(this,t),e&&this.updater.enqueueCallback(this,e,"setState")},a.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this),t&&this.updater.enqueueCallback(this,t,"forceUpdate")},u.prototype=a.prototype,c.prototype=new u,c.prototype.constructor=c,r(c.prototype,a.prototype),c.prototype.isPureReactComponent=!0,t.exports={Component:a,PureComponent:c}},5664:function(t,e,n){"use strict";var i=n(6112),r=n(6140),s=n(2498),o=n(5668),a=i.twoArgumentPooler,c=i.fourArgumentPooler,u=/\/+/g;function l(t){return(""+t).replace(u,"$&/")}function h(t,e){this.func=t,this.context=e,this.count=0}function d(t,e,n){var i=t.func,r=t.context;i.call(r,e,t.count++)}function f(t,e,n,i){this.result=t,this.keyPrefix=e,this.func=n,this.context=i,this.count=0}function p(t,e,n){var i=t.result,o=t.keyPrefix,a=t.func,c=t.context,u=a.call(c,e,t.count++);Array.isArray(u)?g(u,i,n,s.thatReturnsArgument):null!=u&&(r.isValidElement(u)&&(u=r.cloneAndReplaceKey(u,o+(!u.key||e&&e.key===u.key?"":l(u.key)+"/")+n)),i.push(u))}function g(t,e,n,i,r){var s="";null!=n&&(s=l(n)+"/");var a=f.getPooled(e,s,i,r);o(t,p,a),f.release(a)}function m(t,e,n){return null}h.prototype.destructor=function(){this.func=null,this.context=null,this.count=0},i.addPoolingTo(h,a),f.prototype.destructor=function(){this.result=null,this.keyPrefix=null,this.func=null,this.context=null,this.count=0},i.addPoolingTo(f,c);var y={forEach:function(t,e,n){if(null==t)return t;var i=h.getPooled(e,n);o(t,d,i),h.release(i)},map:function(t,e,n){if(null==t)return t;var i=[];return g(t,i,null,e,n),i},mapIntoWithKeyPrefixInternal:g,count:function(t,e){return o(t,m,null)},toArray:function(t){var e=[];return g(t,e,null,s.thatReturnsArgument),e}};t.exports=y},5130:function(t){"use strict";t.exports={current:null}},8739:function(t,e,n){"use strict";var i=n(6140).createFactory,r={a:i("a"),abbr:i("abbr"),address:i("address"),area:i("area"),article:i("article"),aside:i("aside"),audio:i("audio"),b:i("b"),base:i("base"),bdi:i("bdi"),bdo:i("bdo"),big:i("big"),blockquote:i("blockquote"),body:i("body"),br:i("br"),button:i("button"),canvas:i("canvas"),caption:i("caption"),cite:i("cite"),code:i("code"),col:i("col"),colgroup:i("colgroup"),data:i("data"),datalist:i("datalist"),dd:i("dd"),del:i("del"),details:i("details"),dfn:i("dfn"),dialog:i("dialog"),div:i("div"),dl:i("dl"),dt:i("dt"),em:i("em"),embed:i("embed"),fieldset:i("fieldset"),figcaption:i("figcaption"),figure:i("figure"),footer:i("footer"),form:i("form"),h1:i("h1"),h2:i("h2"),h3:i("h3"),h4:i("h4"),h5:i("h5"),h6:i("h6"),head:i("head"),header:i("header"),hgroup:i("hgroup"),hr:i("hr"),html:i("html"),i:i("i"),iframe:i("iframe"),img:i("img"),input:i("input"),ins:i("ins"),kbd:i("kbd"),keygen:i("keygen"),label:i("label"),legend:i("legend"),li:i("li"),link:i("link"),main:i("main"),map:i("map"),mark:i("mark"),menu:i("menu"),menuitem:i("menuitem"),meta:i("meta"),meter:i("meter"),nav:i("nav"),noscript:i("noscript"),object:i("object"),ol:i("ol"),optgroup:i("optgroup"),option:i("option"),output:i("output"),p:i("p"),param:i("param"),picture:i("picture"),pre:i("pre"),progress:i("progress"),q:i("q"),rp:i("rp"),rt:i("rt"),ruby:i("ruby"),s:i("s"),samp:i("samp"),script:i("script"),section:i("section"),select:i("select"),small:i("small"),source:i("source"),span:i("span"),strong:i("strong"),style:i("style"),sub:i("sub"),summary:i("summary"),sup:i("sup"),table:i("table"),tbody:i("tbody"),td:i("td"),textarea:i("textarea"),tfoot:i("tfoot"),th:i("th"),thead:i("thead"),time:i("time"),title:i("title"),tr:i("tr"),track:i("track"),u:i("u"),ul:i("ul"),var:i("var"),video:i("video"),wbr:i("wbr"),circle:i("circle"),clipPath:i("clipPath"),defs:i("defs"),ellipse:i("ellipse"),g:i("g"),image:i("image"),line:i("line"),linearGradient:i("linearGradient"),mask:i("mask"),path:i("path"),pattern:i("pattern"),polygon:i("polygon"),polyline:i("polyline"),radialGradient:i("radialGradient"),rect:i("rect"),stop:i("stop"),svg:i("svg"),text:i("text"),tspan:i("tspan")};t.exports=r},6140:function(t,e,n){"use strict";var i=n(6086),r=n(5130),s=(n(3620),n(4932),Object.prototype.hasOwnProperty),o=n(5236),a={key:!0,ref:!0,__self:!0,__source:!0};function c(t){return void 0!==t.ref}function u(t){return void 0!==t.key}var l=function(t,e,n,i,r,s,a){return{$$typeof:o,type:t,key:e,ref:n,props:a,_owner:s}};l.createElement=function(t,e,n){var i,o={},h=null,d=null;if(null!=e)for(i in c(e)&&(d=e.ref),u(e)&&(h=""+e.key),void 0===e.__self?null:e.__self,void 0===e.__source?null:e.__source,e)s.call(e,i)&&!a.hasOwnProperty(i)&&(o[i]=e[i]);var f=arguments.length-2;if(1===f)o.children=n;else if(f>1){for(var p=Array(f),g=0;g<f;g++)p[g]=arguments[g+2];0,o.children=p}if(t&&t.defaultProps){var m=t.defaultProps;for(i in m)void 0===o[i]&&(o[i]=m[i])}return l(t,h,d,0,0,r.current,o)},l.createFactory=function(t){var e=l.createElement.bind(null,t);return e.type=t,e},l.cloneAndReplaceKey=function(t,e){return l(t.type,e,t.ref,t._self,t._source,t._owner,t.props)},l.cloneElement=function(t,e,n){var o,h,d=i({},t.props),f=t.key,p=t.ref,g=(t._self,t._source,t._owner);if(null!=e)for(o in c(e)&&(p=e.ref,g=r.current),u(e)&&(f=""+e.key),t.type&&t.type.defaultProps&&(h=t.type.defaultProps),e)s.call(e,o)&&!a.hasOwnProperty(o)&&(void 0===e[o]&&void 0!==h?d[o]=h[o]:d[o]=e[o]);var m=arguments.length-2;if(1===m)d.children=n;else if(m>1){for(var y=Array(m),v=0;v<m;v++)y[v]=arguments[v+2];d.children=y}return l(t.type,f,p,0,0,g,d)},l.isValidElement=function(t){return"object"===typeof t&&null!==t&&t.$$typeof===o},t.exports=l},5236:function(t){"use strict";var e="function"===typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;t.exports=e},5016:function(t,e,n){"use strict";n(3620);var i={isMounted:function(t){return!1},enqueueCallback:function(t,e){},enqueueForceUpdate:function(t){},enqueueReplaceState:function(t,e){},enqueueSetState:function(t,e){}};t.exports=i},6859:function(t,e,n){"use strict";var i=n(6140).isValidElement,r=n(7425);t.exports=r(i)},3330:function(t){"use strict";t.exports="15.7.0"},4932:function(t){"use strict";t.exports=!1},5261:function(t,e,n){"use strict";var i=n(888).Component,r=n(6140).isValidElement,s=n(5016),o=n(6511);t.exports=o(i,r,s)},5110:function(t){"use strict";var e="function"===typeof Symbol&&Symbol.iterator;t.exports=function(t){var n=t&&(e&&t[e]||t["@@iterator"]);if("function"===typeof n)return n}},8736:function(t){"use strict";t.exports=function(){}},6626:function(t,e,n){"use strict";var i=n(4763),r=n(6140);n(3759);t.exports=function(t){return r.isValidElement(t)||i("143"),t}},4763:function(t){"use strict";t.exports=function(t){for(var e=arguments.length-1,n="Minified React error #"+t+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+t,i=0;i<e;i++)n+="&args[]="+encodeURIComponent(arguments[i+1]);n+=" for the full message or use the non-minified dev environment for full errors and additional helpful warnings.";var r=new Error(n);throw r.name="Invariant Violation",r.framesToPop=1,r}},5668:function(t,e,n){"use strict";var i=n(4763),r=(n(5130),n(5236)),s=n(5110),o=(n(3759),n(6359));n(3620);function a(t,e){return t&&"object"===typeof t&&null!=t.key?o.escape(t.key):e.toString(36)}function c(t,e,n,u){var l,h=typeof t;if("undefined"!==h&&"boolean"!==h||(t=null),null===t||"string"===h||"number"===h||"object"===h&&t.$$typeof===r)return n(u,t,""===e?"."+a(t,0):e),1;var d=0,f=""===e?".":e+":";if(Array.isArray(t))for(var p=0;p<t.length;p++)d+=c(l=t[p],f+a(l,p),n,u);else{var g=s(t);if(g){var m,y=g.call(t);if(g!==t.entries)for(var v=0;!(m=y.next()).done;)d+=c(l=m.value,f+a(l,v++),n,u);else for(;!(m=y.next()).done;){var _=m.value;_&&(d+=c(l=_[1],f+o.escape(_[0])+":"+a(l,0),n,u))}}else if("object"===h){var w=String(t);i("31","[object Object]"===w?"object with keys {"+Object.keys(t).join(", ")+"}":w,"")}}return d}t.exports=function(t,e,n){return null==t?0:c(t,"",e,n)}},5539:function(t,e,n){"use strict";t.exports=n(8027)},2238:function(t,e,n){"use strict";n.d(e,{Jn:function(){return b},KN:function(){return T},Mq:function(){return C},Xd:function(){return m},ZF:function(){return E},qX:function(){return y}});var i=n(8463),r=n(3333),s=n(4444),o=n(6531);class a{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null===e||void 0===e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const c="@firebase/app",u="0.7.26",l=new r.Yd("@firebase/app"),h="[DEFAULT]",d={[c]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},f=new Map,p=new Map;function g(t,e){try{t.container.addComponent(e)}catch(n){l.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function m(t){const e=t.name;if(p.has(e))return l.debug(`There were multiple attempts to register component ${e}.`),!1;p.set(e,t);for(const n of f.values())g(n,t);return!0}function y(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}const v={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},_=new s.LL("app","Firebase",v);class w{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new i.wA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw _.create("app-deleted",{appName:this._name})}}const b="9.8.3";function E(t,e={}){if("object"!==typeof e){e={name:e}}const n=Object.assign({name:h,automaticDataCollectionEnabled:!1},e),r=n.name;if("string"!==typeof r||!r)throw _.create("bad-app-name",{appName:String(r)});const o=f.get(r);if(o){if((0,s.vZ)(t,o.options)&&(0,s.vZ)(n,o.config))return o;throw _.create("duplicate-app",{appName:r})}const a=new i.H0(r);for(const i of p.values())a.addComponent(i);const c=new w(t,n,a);return f.set(r,c),c}function C(t="[DEFAULT]"){const e=f.get(t);if(!e)throw _.create("no-app",{appName:t});return e}function T(t,e,n){var r;let s=null!==(r=d[t])&&void 0!==r?r:t;n&&(s+=`-${n}`);const o=s.match(/\s|\//),a=e.match(/\s|\//);if(o||a){const t=[`Unable to register library "${s}" with version "${e}":`];return o&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&t.push("and"),a&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void l.warn(t.join(" "))}m(new i.wA(`${s}-version`,(()=>({library:s,version:e})),"VERSION"))}const I="firebase-heartbeat-store";let S=null;function k(){return S||(S=(0,o.X3)("firebase-heartbeat-database",1,{upgrade:(t,e)=>{if(0===e)t.createObjectStore(I)}}).catch((t=>{throw _.create("storage-open",{originalErrorMessage:t.message})}))),S}async function N(t,e){var n;try{const n=(await k()).transaction(I,"readwrite"),i=n.objectStore(I);return await i.put(e,A(t)),n.done}catch(i){throw _.create("storage-set",{originalErrorMessage:null===(n=i)||void 0===n?void 0:n.message})}}function A(t){return`${t.name}!${t.options.appId}`}class x{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new P(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),e=D();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==e&&!this._heartbeatsCache.heartbeats.some((t=>t.date===e)))return this._heartbeatsCache.heartbeats.push({date:e,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const t=D(),{heartbeatsToSend:e,unsentEntries:n}=function(t,e=1024){const n=[];let i=t.slice();for(const r of t){const t=n.find((t=>t.agent===r.agent));if(t){if(t.dates.push(r.date),R(n)>e){t.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),R(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=(0,s.L)(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function D(){return(new Date).toISOString().substring(0,10)}class P{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,s.hl)()&&(0,s.eu)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){return await async function(t){var e;try{return(await k()).transaction(I).objectStore(I).get(A(t))}catch(n){throw _.create("storage-get",{originalErrorMessage:null===(e=n)||void 0===e?void 0:e.message})}}(this.app)||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return N(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return N(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function R(t){return(0,s.L)(JSON.stringify({version:2,heartbeats:t})).length}var O;O="",m(new i.wA("platform-logger",(t=>new a(t)),"PRIVATE")),m(new i.wA("heartbeat",(t=>new x(t)),"PRIVATE")),T(c,u,O),T(c,u,"esm2017"),T("fire-js","")},8463:function(t,e,n){"use strict";n.d(e,{H0:function(){return a},wA:function(){return r}});var i=n(4444);class r{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const s="[DEFAULT]";class o{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new i.BH;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(n){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null===t||void 0===t?void 0:t.identifier),i=null!==(e=null===t||void 0===t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(r){if(i)return null;throw r}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:s})}catch(e){}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:i});n.resolve(t)}catch(e){}}}}clearInstance(t="[DEFAULT]"){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t="[DEFAULT]"){return this.instances.has(t)}getOptions(t="[DEFAULT]"){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[r,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(r)&&s.resolve(i)}return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),r=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;r.add(t),this.onInitCallbacks.set(i,r);const s=this.instances.get(i);return s&&t(s,i),()=>{r.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const r of n)try{r(t,e)}catch(i){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===s?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(r){}var i;return n||null}normalizeInstanceIdentifier(t="[DEFAULT]"){return this.component?this.component.multipleInstances?t:s:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new o(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}},3333:function(t,e,n){"use strict";n.d(e,{Yd:function(){return u},in:function(){return r}});const i=[];var r;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(r||(r={}));const s={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,a={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},c=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),r=a[e];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[r](`[${i}]  ${t.name}:`,...n)};class u{constructor(t){this.name=t,this._logLevel=o,this._logHandler=c,this._userLogHandler=null,i.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in r))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"===typeof t?s[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...t),this._logHandler(this,r.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...t),this._logHandler(this,r.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,r.INFO,...t),this._logHandler(this,r.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,r.WARN,...t),this._logHandler(this,r.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...t),this._logHandler(this,r.ERROR,...t)}}},6531:function(t,e,n){"use strict";n.d(e,{X3:function(){return g}});let i,r;const s=new WeakMap,o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap;let l={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return o.get(t);if("objectStoreNames"===e)return t.objectStoreNames||a.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return f(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function h(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(p(this),e),f(s.get(this))}:function(...e){return f(t.apply(p(this),e))}:function(e,...n){const i=t.call(p(this),e,...n);return a.set(i,e.sort?e.sort():[e]),f(i)}}function d(t){return"function"===typeof t?h(t):(t instanceof IDBTransaction&&function(t){if(o.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",r),t.removeEventListener("error",s),t.removeEventListener("abort",s)},r=()=>{e(),i()},s=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",r),t.addEventListener("error",s),t.addEventListener("abort",s)}));o.set(t,e)}(t),e=t,(i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((t=>e instanceof t))?new Proxy(t,l):t);var e}function f(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",r),t.removeEventListener("error",s)},r=()=>{e(f(t.result)),i()},s=()=>{n(t.error),i()};t.addEventListener("success",r),t.addEventListener("error",s)}));return e.then((e=>{e instanceof IDBCursor&&s.set(e,t)})).catch((()=>{})),u.set(e,t),e}(t);if(c.has(t))return c.get(t);const e=d(t);return e!==t&&(c.set(t,e),u.set(e,t)),e}const p=t=>u.get(t);function g(t,e,{blocked:n,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(t,e),a=f(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(f(o.result),t.oldVersion,t.newVersion,f(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((t=>{s&&t.addEventListener("close",(()=>s())),r&&t.addEventListener("versionchange",(()=>r()))})).catch((()=>{})),a}const m=["get","getKey","getAll","getAllKeys","count"],y=["put","add","delete","clear"],v=new Map;function _(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!==typeof e)return;if(v.get(e))return v.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,r=y.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!r&&!m.includes(n))return;const s=async function(t,...e){const s=this.transaction(t,r?"readwrite":"readonly");let o=s.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),r&&s.done]))[0]};return v.set(e,s),s}l=(t=>({...t,get:(e,n,i)=>_(e,n)||t.get(e,n,i),has:(e,n)=>!!_(e,n)||t.has(e,n)}))(l)}},function(t){var e=function(e){return t(t.s=e)};t.O(0,[774,179],(function(){return e(1118),e(880)}));var n=t.O();_N_E=n}]);